<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Louis OLIVE">

<title>Logistic regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="Logistic_Regression_files/libs/clipboard/clipboard.min.js"></script>
<script src="Logistic_Regression_files/libs/quarto-html/quarto.js"></script>
<script src="Logistic_Regression_files/libs/quarto-html/popper.min.js"></script>
<script src="Logistic_Regression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Logistic_Regression_files/libs/quarto-html/anchor.min.js"></script>
<link href="Logistic_Regression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Logistic_Regression_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Logistic_Regression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Logistic_Regression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Logistic_Regression_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<link href="Logistic_Regression_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="Logistic_Regression_files/libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-logistic-regression-model" id="toc-the-logistic-regression-model" class="nav-link active" data-scroll-target="#the-logistic-regression-model"><span class="header-section-number">1</span> The Logistic Regression model</a>
  <ul class="collapse">
  <li><a href="#informal-introductory-example" id="toc-informal-introductory-example" class="nav-link" data-scroll-target="#informal-introductory-example"><span class="header-section-number">1.1</span> Informal introductory example</a></li>
  <li><a href="#a-more-formal-definition" id="toc-a-more-formal-definition" class="nav-link" data-scroll-target="#a-more-formal-definition"><span class="header-section-number">1.2</span> A more formal definition</a></li>
  <li><a href="#estimation" id="toc-estimation" class="nav-link" data-scroll-target="#estimation"><span class="header-section-number">1.3</span> Estimation</a>
  <ul class="collapse">
  <li><a href="#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation" class="nav-link" data-scroll-target="#maximum-likelihood-estimation"><span class="header-section-number">1.3.1</span> Maximum Likelihood Estimation</a></li>
  <li><a href="#numerical-methods" id="toc-numerical-methods" class="nav-link" data-scroll-target="#numerical-methods"><span class="header-section-number">1.3.2</span> Numerical methods</a></li>
  <li><a href="#logistic-regression-as-a-machine-learning-approach" id="toc-logistic-regression-as-a-machine-learning-approach" class="nav-link" data-scroll-target="#logistic-regression-as-a-machine-learning-approach"><span class="header-section-number">1.3.3</span> Logistic Regression as a machine learning approach</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation"><span class="header-section-number">2</span> Interpretation</a>
  <ul class="collapse">
  <li><a href="#coefficients" id="toc-coefficients" class="nav-link" data-scroll-target="#coefficients"><span class="header-section-number">2.1</span> Coefficients</a></li>
  <li><a href="#odds" id="toc-odds" class="nav-link" data-scroll-target="#odds"><span class="header-section-number">2.2</span> Odds</a></li>
  <li><a href="#odds-ratio" id="toc-odds-ratio" class="nav-link" data-scroll-target="#odds-ratio"><span class="header-section-number">2.3</span> Odds ratio</a></li>
  </ul></li>
  <li><a href="#inference" id="toc-inference" class="nav-link" data-scroll-target="#inference"><span class="header-section-number">3</span> Inference</a>
  <ul class="collapse">
  <li><a href="#asymptotic-properties-of-mle" id="toc-asymptotic-properties-of-mle" class="nav-link" data-scroll-target="#asymptotic-properties-of-mle"><span class="header-section-number">3.1</span> Asymptotic properties of MLE</a></li>
  <li><a href="#wald-statistics" id="toc-wald-statistics" class="nav-link" data-scroll-target="#wald-statistics"><span class="header-section-number">3.2</span> Wald statistics</a>
  <ul class="collapse">
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">3.2.1</span> Confidence intervals</a></li>
  <li><a href="#tests-on-model-coefficients" id="toc-tests-on-model-coefficients" class="nav-link" data-scroll-target="#tests-on-model-coefficients"><span class="header-section-number">3.2.2</span> Tests on model coefficients</a></li>
  </ul></li>
  <li><a href="#likelihood-ratio-tests" id="toc-likelihood-ratio-tests" class="nav-link" data-scroll-target="#likelihood-ratio-tests"><span class="header-section-number">3.3</span> Likelihood ratio tests</a></li>
  </ul></li>
  <li><a href="#variable-selection-model-assessment" id="toc-variable-selection-model-assessment" class="nav-link" data-scroll-target="#variable-selection-model-assessment"><span class="header-section-number">4</span> Variable selection, model assessment</a>
  <ul class="collapse">
  <li><a href="#best-subset" id="toc-best-subset" class="nav-link" data-scroll-target="#best-subset"><span class="header-section-number">4.1</span> Best subset</a></li>
  <li><a href="#stepwise-logistic-regression" id="toc-stepwise-logistic-regression" class="nav-link" data-scroll-target="#stepwise-logistic-regression"><span class="header-section-number">4.2</span> Stepwise Logistic Regression</a></li>
  <li><a href="#introducing-penalized-logistic-regressions" id="toc-introducing-penalized-logistic-regressions" class="nav-link" data-scroll-target="#introducing-penalized-logistic-regressions"><span class="header-section-number">4.3</span> Introducing penalized logistic regressions</a></li>
  <li><a href="#model-assessment" id="toc-model-assessment" class="nav-link" data-scroll-target="#model-assessment"><span class="header-section-number">4.4</span> Model assessment</a>
  <ul class="collapse">
  <li><a href="#hold-out-approach" id="toc-hold-out-approach" class="nav-link" data-scroll-target="#hold-out-approach"><span class="header-section-number">4.4.1</span> Hold-out approach</a></li>
  <li><a href="#k-fold-cross-validation-approach" id="toc-k-fold-cross-validation-approach" class="nav-link" data-scroll-target="#k-fold-cross-validation-approach"><span class="header-section-number">4.4.2</span> K-fold Cross-Validation approach</a></li>
  </ul></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise"><span class="header-section-number">4.5</span> Exercise</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">5</span> References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Logistic regression</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Louis OLIVE </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="the-logistic-regression-model" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> The Logistic Regression model</h1>
<section id="informal-introductory-example" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="informal-introductory-example"><span class="header-section-number">1.1</span> Informal introductory example</h2>
<p>We provide here some intuitions leading to the Logistic Regression model using a simulated data set from <span class="citation" data-cites="islr2021">James et al. (<a href="#ref-islr2021" role="doc-biblioref">2021</a>)</span> (the <strong>Default</strong> data set).</p>
<p>This is a toy data set used for teaching purposes containing information on ten thousand customers.</p>
<p>The aim here is to assess which customers will <strong><em>default</em></strong> on their credit card debt (the target or response variable) based on the current credit card <strong><em>balance</em></strong> and other individual characteristics (the predictors or feature vector).</p>
<p>This is a binary classification problem as the <strong><em>default</em></strong> variable takes value in a discrete set (here binary). In the following we will denote <span class="math inline">\(Y\)</span> the output or response variable and <span class="math inline">\(X = (X_0,X_1,\cdots,X_{p-1})^{T}\)</span> the feature vector or inputs.</p>
<p>The approach we follow is similar to <span class="citation" data-cites="hosmer2013">(<a href="#ref-hosmer2013" role="doc-biblioref">Hosmer, Lemeshow, and Sturdivant 2013</a>)</span> or <span class="citation" data-cites="cornillon2019">(<a href="#ref-cornillon2019" role="doc-biblioref">Cornillon and Matzner-Løber 2019</a>)</span>. Both books use a similar example: the presence or absence of a Coronary Heart Disease (CHD) is explained with the age of an individual (the data set <em>chdage</em> is available in companion package <em>aplore3</em>).</p>
<p>We can start to explore the Default data with a scatterplot (<a href="#fig-default_balance-scatterplot">Figure&nbsp;1</a>) of the target variable (<strong><em>default</em></strong>) with respect to a predictor (<strong><em>balance</em></strong>):</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/fig-default_balance-scatterplot_9bce284d3fb6ed658d21a63841a13412">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Default data set (simulated) from ESLII/ISLR</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>default_data <span class="ot">&lt;-</span> ISLR2<span class="sc">::</span>Default <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as_tibble</span>()</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(default_data, <span class="fu">aes</span>(<span class="at">x=</span>balance, <span class="at">y=</span>default)) <span class="sc">+</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-default_balance-scatterplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Logistic_Regression_files/figure-html/fig-default_balance-scatterplot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Scatterplot of variable <strong><em>default</em></strong> with respect to credit card <strong><em>balance</em></strong> for 10000 customers</figcaption>
</figure>
</div>
</div>
</div>
<p>In this scatterplot, all points fall on one of two parallel lines representing the absence (No) or occurrence (Yes) of <strong><em>default</em></strong>. We “jitter” the data vertically to avoid overplotting. The plot below shows that the response variable is imbalanced towards the absence of default:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-3_d9a279e11cb9478ce87aed71f7daa986">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(default_data, <span class="fu">aes</span>(<span class="at">x=</span>balance, <span class="at">y=</span>default)) <span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">height=</span><span class="fl">0.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We also show the boxplots of credit cards <strong><em>balance</em></strong> with respect to <strong><em>default</em></strong> status:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/fig-balance_default-boxplot_9f7732cfe8344bb1f9714c8f169af302">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(default_data,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x=</span>default, <span class="at">y=</span>balance)) <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-balance_default-boxplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Logistic_Regression_files/figure-html/fig-balance_default-boxplot-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Variable <strong><em>balance</em></strong> with respect to <strong><em>default</em></strong> status</figcaption>
</figure>
</div>
</div>
</div>
<p>We can see from <a href="#fig-default_balance-scatterplot">Figure&nbsp;1</a> and <a href="#fig-balance_default-boxplot">Figure&nbsp;2</a> that default tends to be more prevalent for accounts with a high balance. However it is difficult to guess a simple relationship between default and balance.</p>
<p>To investigate further we discretise the balance variables by classes of width <span class="math inline">\(300\$\)</span> and compute the mean of response variable (<strong><em>default</em></strong> is Yes) within each balance class:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-5_41c64eaba9c1b7fad70b1ba4fdf0e89d">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>class_width <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>(default_data_binned <span class="ot">&lt;-</span> default_data <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">balance_bins =</span> <span class="fu">cut</span>(balance, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">3000</span>, class_width),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">right =</span> <span class="cn">FALSE</span>, <span class="at">dig.lab =</span> <span class="dv">4</span>),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">floor</span>(balance <span class="sc">/</span> class_width) <span class="sc">*</span> class_width,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">if_else</span>(balance <span class="sc">==</span> <span class="dv">0</span> , <span class="dv">1</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># customers with 0$ balance should be long to [0, width) class</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># or be excluded</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ceiling</span>(balance <span class="sc">/</span> class_width))  <span class="sc">*</span> class_width) <span class="sc">%&gt;%</span> </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(balance_bins, min, max, default) <span class="sc">%&gt;%</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> default, <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">Yes =</span> <span class="dv">0</span>, <span class="at">No =</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Mean(default)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(Yes <span class="sc">/</span> (Yes <span class="sc">+</span> No), <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["balance_bins"],"name":[1],"type":["fct"],"align":["left"]},{"label":["min"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["No"],"name":[4],"type":["int"],"align":["right"]},{"label":["Yes"],"name":[5],"type":["int"],"align":["right"]},{"label":["Mean(default)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"[0,300)","2":"0","3":"300","4":"1497","5":"0","6":"0.0000"},{"1":"[300,600)","2":"300","3":"600","4":"1784","5":"0","6":"0.0000"},{"1":"[600,900)","2":"600","3":"900","4":"2305","5":"3","6":"0.0013"},{"1":"[900,1200)","2":"900","3":"1200","4":"2098","5":"19","6":"0.0090"},{"1":"[1200,1500)","2":"1200","3":"1500","4":"1330","5":"53","6":"0.0383"},{"1":"[1500,1800)","2":"1500","3":"1800","4":"527","5":"96","6":"0.1541"},{"1":"[1800,2100)","2":"1800","3":"2100","4":"115","5":"114","6":"0.4978"},{"1":"[2100,2400)","2":"2100","3":"2400","4":"11","5":"41","6":"0.7885"},{"1":"[2400,2700)","2":"2400","3":"2700","4":"0","5":"7","6":"1.0000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In the following we map, by convention and for better readability, the response variable <span class="math inline">\(Y \in\{Yes, No\}\)</span> to <span class="math inline">\(\{0, 1\}\)</span>:</p>
<p><span class="math display">\[
Y = \left\{ \begin{array}{ll}
    1&amp;  \mbox{if customer defaulted on its credit card (ie default=Yes)}\cr
    0&amp;  \mbox{otherwise}.
    \end{array} \right.
\]</span></p>
<p>Then we plot the mean of default (in red) within each balance class (of width <span class="math inline">\(300\$\)</span>):</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/fig-balance_default-scatterplot-occurrence_05f502392a2678d0ca23af4e761bd2ea">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(default_occurrence <span class="ot">&lt;-</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(default_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">default =</span> <span class="fu">if_else</span>(default <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)), <span class="fu">aes</span>(<span class="at">x=</span>balance, <span class="at">y=</span>default)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_segment</span>(<span class="at">data =</span> default_data_binned,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">xend =</span> max, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean(default)</span><span class="st">`</span>, <span class="at">yend =</span> <span class="st">`</span><span class="at">Mean(default)</span><span class="st">`</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">'coral'</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth=</span><span class="fl">1.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-balance_default-scatterplot-occurrence" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Logistic_Regression_files/figure-html/fig-balance_default-scatterplot-occurrence-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Mean occurrence of <strong><em>default</em></strong> within <strong><em>balance</em></strong> classes</figcaption>
</figure>
</div>
</div>
</div>
<p>The relationship between the mean occurrence of <strong><em>default</em></strong> and <strong><em>balance</em></strong> is easier to read.</p>
<p><a href="#fig-balance_default-scatterplot-occurrence">Figure&nbsp;3</a> clearly shows that as balance increases, the proportion of customers defaulting on their credit card increases.</p>
<p>We also notice that the mean default occurrence with respect to balance classes follows a kind of “S”-shaped curve or <strong>sigmoid</strong> function. Note that the shape depends on classes width and might change.</p>
<p>Going further and informally, considering that the mean of default occurrence is an estimate of <span class="math inline">\(\mathbf{E}[Y|X=x]\)</span> for each balance classes an idea would be to model:</p>
<p><span class="math display">\[
\mathbb{E}[Y|X=x] = \mu_\beta(x)
\]</span></p>
<p>where <span class="math inline">\(\mu_\beta\)</span> is a <strong>sigmoid</strong> function in <span class="math inline">\([0,1]\)</span>.</p>
<p>The Logistic Regression model uses the <strong>sigmoid</strong> function <span class="math inline">\(\sigma: x \to\sigma(x)=\frac{e^{x}} { 1 + e^{x} }\)</span> also known as logistic function.</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-7_7e2277baecf28a56bb1b57d346b8b23f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(default_occurrence <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"binomial"</span>), </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">col =</span> <span class="st">"dodgerblue"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_segment</span>(<span class="at">data =</span> default_data_binned,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">xend =</span> max, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean(default)</span><span class="st">`</span>, <span class="at">yend =</span> <span class="st">`</span><span class="at">Mean(default)</span><span class="st">`</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">'coral'</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth=</span><span class="fl">1.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Another approach would have been to treat <span class="math inline">\(Y\)</span> as a quantitative response variable and fit a simple linear model:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-8_6eb66e2d628e53678188a6acd5d5afd1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>linear <span class="ot">&lt;-</span> <span class="fu">lm</span>(default <span class="sc">~</span> balance, <span class="at">data =</span> default_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">default =</span> <span class="fu">if_else</span>(default <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(linear)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>coeff_lm <span class="ot">&lt;-</span> linear<span class="sc">$</span>coefficients</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> coeff_lm[<span class="st">"(Intercept)"</span>]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> coeff_lm[<span class="st">"balance"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/fig-balance_default-scatterplot-lmfit_65b57a48c45f5778849ec3f2a590b41e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">ggplot</span>(default_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">default =</span> <span class="fu">if_else</span>(default <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)), <span class="fu">aes</span>(<span class="at">x=</span>balance, <span class="at">y=</span>default)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_segment</span>(<span class="at">data =</span> default_data_binned,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">xend =</span> max, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean(default)</span><span class="st">`</span>, <span class="at">yend =</span> <span class="st">`</span><span class="at">Mean(default)</span><span class="st">`</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">'coral'</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">size=</span><span class="fl">1.25</span>)<span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3000</span>, <span class="dv">300</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>               <span class="fu">mutate</span>(<span class="at">y =</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> x),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">'darkolivegreen'</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="st">'dotted'</span>))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a> <span class="co"># Alternatively we could have used the geom_smooth command</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_smooth(method = "lm", </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a> <span class="co">#             formula = y ~ x,</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a> <span class="co">#             se = FALSE,</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a> <span class="co">#             col = "darkolivegreen",</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a> <span class="co">#             linetype = "dotted")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-balance_default-scatterplot-lmfit" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Logistic_Regression_files/figure-html/fig-balance_default-scatterplot-lmfit-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Fitting a linear model, <strong><em>default</em></strong> is treated as a quantitative response variable</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-balance_default-scatterplot-lmfit">Figure&nbsp;4</a> shows that a linear model fails to fit the data. In particular, for low credit card balances the linear model shows a “negative probability of default”. This is quite prominent here as response variable is imbalanced towards the No default category. For the same reasons, the least square method fails to correctly fit the category of interest (less than 0.25 probability).</p>
<p>Usually in such presentation (for example <span class="citation" data-cites="hosmer2013">Hosmer, Lemeshow, and Sturdivant (<a href="#ref-hosmer2013" role="doc-biblioref">2013</a>)</span>) data is more balanced and a linear model approximately fits the two classes. However in any case a linear model cannot confine the predicted value to <span class="math inline">\([0, 1]\)</span> for all observations of predictors.</p>
</section>
<section id="a-more-formal-definition" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="a-more-formal-definition"><span class="header-section-number">1.2</span> A more formal definition</h2>
<p>We use the concepts we have defined in the first part of this lesson. The problem we are facing trying to predict the output default (<span class="math inline">\(Y \in(0,1)\)</span>) using a training set of inputs or featur vector <span class="math inline">\(X\)</span> is a binary classification problem.</p>
<p>We remind that to estimate an optimal classifier for output <span class="math inline">\(Y \in \{0,1\}\)</span> using input <span class="math inline">\(X = (X_1,\cdots,X_p)\)</span> one approach was to:</p>
<ul>
<li><p>model the joint distribution (or generative distribution) between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>,</p></li>
<li><p>estimate <span class="math inline">\(\eta(x)\)</span> with:</p></li>
</ul>
<p><span class="math display">\[
\eta(x)=\mathbb{P}[Y=1|X=x)] = \mathbb{E}[Y=1|X=x)]
\]</span></p>
<ul>
<li><p><span class="math inline">\(\eta(x)\)</span> can be used as a Scoring function (ROC curve, choice of cutoff <span class="math inline">\(s\)</span>)</p></li>
<li><p>and we can use the classifier (usually <span class="math inline">\(s=\frac{1}{2}\)</span>) to predict output <span class="math inline">\(Y\)</span>:</p></li>
</ul>
<p><span class="math display">\[
f_s(x)=\left\{ \begin{array}{ll}
    1 &amp;  \mbox{if } \eta(x)\geq s\cr
    0 &amp;  \mbox{otherwise}\cr
\end{array} \right.
\]</span></p>
<p>In the case of <strong>Logistic Regression</strong> classifier, we model:</p>
<p><span class="math display">\[
Y|X=x~ \sim B(\eta(x))
\]</span></p>
<p>with</p>
<p><span class="math display">\[
\eta(x)=\sigma(x^T\beta) =\frac{exp(x^T\beta)}{1+exp(x^T\beta)}
\]</span></p>
<p>for some parameter <span class="math inline">\(\beta=(\beta_1,\cdots,\beta_p)\in \mathbb R^p\)</span>, usually <span class="math inline">\(x_1=1\)</span> and <span class="math inline">\(\beta_1\)</span> is an intercept. <span class="math inline">\(\sigma\)</span> is the sigmoid logistic function we have seen before.</p>
<p>In the literature is usual to denote <span class="math inline">\(\eta(X)=p_{\beta}(X)\)</span> or <span class="math inline">\(\eta(X)=\pi_{\beta}(X)\)</span>.</p>
<p>From now, we will use the notation <span class="math inline">\(p_{\beta}(X)\)</span>.</p>
<p>Defining <span class="math inline">\(\mathrm{logit}: x \to \log\bigg( \frac{x}{1-x}\bigg)\)</span> we have:</p>
<p><span class="math display">\[
\mathrm{logit}(p_{\beta}(X))=X^T\beta
\]</span></p>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The <strong>Logistic Regression</strong> model:
</div>
</div>
<div class="callout-body-container callout-body">
<p>We are given <span class="math inline">\((x_i, y_i) \in \mathbb R^p \times \{0,1\}\)</span>, <span class="math inline">\(i=1,\cdots,n\)</span></p>
<p>The Logistic Regression model assumes that outputs <span class="math inline">\(y_i\)</span> are independent Bernoulli with parameter <span class="math inline">\(p_{\beta}(x_i)\)</span> depending on <span class="math inline">\(x_i\)</span>:</p>
<p><span class="math display">\[
\mathrm{logit}(p_{\beta}(x_i))=x_i^T\beta
\]</span></p>
</div>
</div>
<p>The Logistic Regression model defined above is a special case of more general family of models, the so-called Generalized Linear Models (GLM).</p>
<p>The family of GLM extends the applicability of linear-model ideas to data where responses are binary (e.g.&nbsp;Logistic Regression) or counts (e.g.&nbsp;Poisson Regression), among further possibilities. The concept emerged with Nelder and Wedderburn and has been studied extensively (see <span class="citation" data-cites="nelder1972">Nelder and Wedderburn (<a href="#ref-nelder1972" role="doc-biblioref">1972</a>)</span> or <span class="citation" data-cites="cornillon2019">Cornillon and Matzner-Løber (<a href="#ref-cornillon2019" role="doc-biblioref">2019</a>)</span>) .</p>
<p>The syntax to fit the Logistic model in R using <code>glm()</code> is:</p>
<p><span class="math display">\[
\mathtt{glm(} \mathrm{y} \sim \mathrm{~x,~}\mathtt{data=}~\mathrm{dataframe,~}\mathtt{family~=~binomial(link~=~"logit")}
\]</span></p>
<p>The formula <span class="math inline">\(\mathrm{y} \sim \mathrm{x}\)</span> depicts the model (i.e.&nbsp;inputs are <span class="math inline">\(X\)</span>, output is <span class="math inline">\(Y\)</span>) and the <code>data=</code> argument points to the training set contained in a R dataframe (or tibble). This is quite similar to the <code>lm()</code> function.</p>
<p>We also need to specify the distribution for the conditional <span class="math inline">\(Y\)</span> values (binomial) and the link function (logit) via the <code>family=</code> argument.</p>
<p>For our example:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-10_55d656589882c70a2ef8020d1a04e620">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>glm_default <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> student <span class="sc">+</span> balance <span class="sc">+</span> income,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> default_data,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>glm_default <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> .,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> default_data,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="st">"binomial"</span>) <span class="co"># by default: link = "logit"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The command <code>summary</code> produces result summaries of the fitted model:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-11_82599a1734a35bf944d37997d202f76e">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_default)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ ., family = "binomial", data = default_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4691  -0.1418  -0.0557  -0.0203   3.7383  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.087e+01  4.923e-01 -22.080  &lt; 2e-16 ***
studentYes  -6.468e-01  2.363e-01  -2.738  0.00619 ** 
balance      5.737e-03  2.319e-04  24.738  &lt; 2e-16 ***
income       3.033e-06  8.203e-06   0.370  0.71152    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1571.5  on 9996  degrees of freedom
AIC: 1579.5

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>We will see later how to interpret or understand what is printed</p>
<p>A coefficient-wise output of the model can be obtained as a <code>tibble</code> using <code>tidy()</code> from package <code>broom</code>:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-12_cea663b2fe5fc403002cca4e31dc64b9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(glm_default)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-1.086905e+01","3":"4.922555e-01","4":"-22.080088","5":"4.911280e-108"},{"1":"studentYes","2":"-6.467758e-01","3":"2.362525e-01","4":"-2.737646","5":"6.188063e-03"},{"1":"balance","2":"5.736505e-03","3":"2.318945e-04","4":"24.737563","5":"4.219578e-135"},{"1":"income","2":"3.033450e-06","3":"8.202615e-06","4":"0.369815","5":"7.115203e-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Based on this output, the fitted model is (we have re-scaled balance and income for better readability):</p>
<p><span class="math display">\[
\log \bigg( \frac{p_{\beta}(x_i)}{1 - p_{\beta}(x_i)}\bigg) = -1.08 - 0.65(\mathbb{1}_{\mathrm{student}_i=\mathrm{Yes}}) + 5.74(\frac{\mathrm{balance}_i}{1000})+ 0.03(\frac{\mathrm{income}_i}{10000})
\]</span></p>
</section>
<section id="estimation" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="estimation"><span class="header-section-number">1.3</span> Estimation</h2>
<section id="maximum-likelihood-estimation" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="maximum-likelihood-estimation"><span class="header-section-number">1.3.1</span> Maximum Likelihood Estimation</h3>
<p>We are given <span class="math inline">\((x_i, y_i) \in \mathbb R^p \times \{0,1\}\)</span>, <span class="math inline">\(i=1,\cdots,n\)</span> where outputs <span class="math inline">\(y_i\)</span> are independent Bernoulli with parameter <span class="math inline">\(p_{\beta}(x_i)\)</span> depending on <span class="math inline">\(x_i\)</span>:</p>
<p><span class="math display">\[
\mathrm{logit}(p_{\beta}(x_i))=x_i^T\beta
\]</span></p>
<p>The parameters <span class="math inline">\(\beta\)</span> of the Logistic Regression model are usually determined using Maximum Likelihood Estimation (MLE). It consists on finding <span class="math inline">\(\beta\)</span> for which the joint probability of the observed data is greatest.</p>
<p>As <span class="math inline">\(y_i\)</span> are independent the likelihood function (joint probability) is the product of the probability mass functions:</p>
<p><span class="math display">\[
L(Y,\beta) = \prod_{i=1}^n p_{\beta}(x_i)^{y_i}(1-p_{\beta}(x_i))^{1-y_i}
\]</span></p>
<p>with <span class="math inline">\(Y=(y_1,\cdots,y_n)\)</span> and <span class="math inline">\(\beta=(\beta_1,\cdots,\beta_p)\)</span>.</p>
<p>We seek to maximize the likelihood function over <span class="math inline">\(\beta\)</span>, it is equivalent but easier to maximize the log-likelihood:</p>
<p><span class="math display">\[
\begin{align}
\ell(Y,\beta)=\log L(Y,\beta) &amp;=\sum_{i=1}^n \left(y_i \log(p_{\beta}(x_i))+(1-y_i) \log(1- p_{\beta}(x_i))\right) \\
                              &amp;=\sum_{i=1}^{n} \left(y_i \log(\frac{p_{\beta}(x_i)}{1-p_{\beta}(x_i)})+\log(1- p_{\beta}(x_i))\right)\\
                              &amp;=\sum_{i=1}^{n} \left(y_i x_i^T\beta -\log(1 + \exp(x_i^T\beta)\right)
\end{align}
\]</span></p>
<p>If the MLE <span class="math inline">\(\hat\beta\)</span> exists, the gradient of log-likelihood satisfies (first order necessary condition):</p>
<p><span class="math display">\[
\nabla\ell(Y,\beta)=\left(\frac{\partial \ell(Y,\beta)}{\partial \beta_1}, \cdots,\frac{\partial \ell(Y,\beta)}{\partial \beta_p}\right)=\mathbf 0
\]</span></p>
<p>We have for <span class="math inline">\(j=1,\cdots,p\)</span>:</p>
<p><span class="math display">\[
\frac{\partial \ell(Y,\beta)}{\partial \beta_j}=\sum_{i=1}^{n} \left(y_i x_{ij} -x_{ij}\frac{\exp(x_i^T\beta)}{1+\exp(x_i^T\beta)}\right)=\sum_{i=1}^{n} x_{ij} \left(y_i- p_{\beta}(x_i)\right)
\]</span></p>
<p>In vector form:</p>
<p><span class="math display">\[
\nabla\ell(Y,\beta)=\sum_{i=1}^{n} x_{i} \left(y_i- p_{\beta}(x_i)\right)=X^T(Y-P_{\beta})
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
\begin{align}
X = \begin{pmatrix}
x_{11} &amp; \cdots &amp; x_{1p} \\
x_{21} &amp; \cdots &amp; x_{2p} \\
\vdots  &amp; \vdots  &amp; \vdots   \\
x_{n1} &amp; \cdots &amp; x_{np}
\end{pmatrix} =
\begin{pmatrix}
x_1^T\\
x_2^T\\
\vdots \\
x_n^T
\end{pmatrix}\in \mathbb{R}^{n\times (p)}, \quad
Y = \begin{pmatrix}
y_{1} \\
y_{2}\\
\vdots \\
y_{n}  
\end{pmatrix} \quad and \quad
P_{\beta} = \begin{pmatrix}
p_{\beta}(x_1) \\
p_{\beta}(x_2)\\
\vdots \\
p_{\beta}(x_n)  
\end{pmatrix}
\end{align}
\]</span></p>
<p>In the literature <span class="math inline">\(\nabla\ell(Y,\beta)\)</span> is denoted as the Fisher’s score function <span class="math inline">\(S(\beta)\)</span>, if the MLE <span class="math inline">\(\hat\beta\)</span> exists, we have:</p>
<p><span class="math display">\[
S(\hat\beta)=\nabla\ell(Y,\hat\beta)=X^T(Y-P_{\hat\beta})=0
\]</span></p>
<p>Solving this equation involves solving <span class="math inline">\(p\)</span> non-linear equations in <span class="math inline">\(\beta\)</span>:</p>
<p><span class="math display">\[
y_1 x_{1j} + \cdots + y_n x_{nj} = x_{1j}\frac{\exp(x_1^T\beta)}{1+\exp(x_1^T\beta)}+ \cdots + x_{nj}\frac{\exp(x_n^T\beta)}{1+\exp(x_n^T\beta)},\quad j=1,\cdots,p
\]</span></p>
</section>
<section id="numerical-methods" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="numerical-methods"><span class="header-section-number">1.3.2</span> Numerical methods</h3>
<p>In practice we use numerical methods to solve these non-linear equations as no closed-form solution exist.</p>
<p>If we assume that <span class="math inline">\(rank(X)=p\)</span>, we will have that <span class="math inline">\(S(\beta)\)</span> is concave in <span class="math inline">\(\beta\)</span> hence if we find a local maximum it is a global maximum.</p>
<p>We have for <span class="math inline">\((k,l) \in (1,\cdots,p)^2\)</span>:</p>
<p><span class="math display">\[
\begin{align}
\frac{\partial\mathcal \ell}{\partial\beta_k\partial\beta_l}(\beta)= &amp; \frac{\partial}{\partial\beta_k}
\sum_{i=1}^nx_{il}(y_i-\frac{\exp(x_i^T\beta)}{1+\exp(x_i^T\beta)}) \\
=&amp; -\sum_{i=1}^nx_{il}x_{ik}\frac{\exp(x_i^T\beta)}{(1+\exp(x_i^T\beta))^2} \\
=&amp; -\sum_{i=1}^nx_{ik}p_\beta(x_i)(1-p_\beta(x_i))x_{il}
\end{align}
\]</span></p>
<p>We obtain that in matrix form:</p>
<p><span class="math display">\[
H(\beta)=\nabla^2\ell(Y,\beta)=-X^T W_\beta X
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
\begin{align}
W_\beta = \begin{pmatrix}
p_\beta(x_1)(1-p_\beta(x_1)) &amp; \cdots &amp; \cdots\\
\vdots  &amp; \ddots &amp; \vdots \\
\cdots  &amp; \cdots &amp; p_\beta(x_n)(1-p_\beta(x_n))
\end{pmatrix}
\end{align}
\]</span></p>
<p>We have <span class="math inline">\(p_\beta(x_i)(1-p_\beta(x_i))\geq0\)</span> hence <span class="math inline">\(W(\beta)\)</span> is semi-definite negative and since <span class="math inline">\(rank(X)=p\)</span>, <span class="math inline">\(H(\beta)\)</span> is concave.</p>
<p>It is shown in <span class="citation" data-cites="albert1984a">(<a href="#ref-albert1984a" role="doc-biblioref">A. and A. 1984</a>)</span> that if additionally there is no complete separation in the training set: <img src="images/unique_mle.png" class="img-fluid" data-fig-align="center"></p>
<p>then the MLE exists and is unique.</p>
<section id="the-newton-raphson-ie-fisher-scoring-method" class="level4" data-number="1.3.2.1">
<h4 data-number="1.3.2.1" class="anchored" data-anchor-id="the-newton-raphson-ie-fisher-scoring-method"><span class="header-section-number">1.3.2.1</span> The Newton-Raphson (ie Fisher Scoring) method</h4>
<p>In practice the Newton-Raphson method is used to solve the equation:</p>
<p><span class="math display">\[
S(\beta)=\nabla\ell(Y,\beta)=X^T(Y-P_{\beta})=0
\]</span></p>
<p>Using Taylor expansion of Score <span class="math inline">\(S(\beta)\)</span>:</p>
<p><span class="math display">\[
S(\hat\beta) \approx S(\beta^{(k)})+H(\beta^{(k)})(\hat\beta-\beta^{(k)})
\]</span> and starting from an initial guess of <span class="math inline">\(\beta=\beta_0\)</span>, the Newton-Raphson update formula is:</p>
<p><span class="math display">\[
\beta^{(k+1)} = \beta^{(k)} - H^{-1}(\beta^{(k)})S(\beta^{(k)})
\]</span></p>
<p>We show below a naive implementation of Newton-Raphson method to estimate <span class="math inline">\(\beta\)</span> (also known as Fisher Scoring algorithm in the context of Logistic Regression)</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-13_a16e8eccc0fd019f978e7b711b733d1a">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We put the data frame in matrix form</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># also adding an intercept</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">nrow</span>(default_data)),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">as.matrix</span>(default_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(balance, income))) </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X) <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"(Intercept)"</span>, <span class="st">"balance"</span>, <span class="st">"income"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We extract the output as vector</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> default_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">default =</span> <span class="fu">if_else</span>(default<span class="sc">==</span><span class="st">'Yes'</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(default)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="co"># We set an initial guess for beta and criterion for stopping</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>nb_iter <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>tol <span class="ot">&lt;-</span> <span class="fl">1e-4</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>lr_solve <span class="ot">&lt;-</span> <span class="cf">function</span>(X, Y, beta, nb_iter, tol){</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nb_iter){</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        <span class="co"># first compute p_beta(X)</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        p_beta <span class="ot">&lt;-</span> <span class="fu">exp</span>(X <span class="sc">%*%</span> beta) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(X <span class="sc">%*%</span> beta))</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        <span class="co"># then the Score</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>        Score_beta <span class="ot">&lt;-</span> <span class="fu">t</span>(X) <span class="sc">%*%</span> (Y<span class="sc">-</span>p_beta)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>        <span class="co"># and the Hessian</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>        W_beta <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, n, n)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>        <span class="fu">diag</span>(W_beta) <span class="ot">&lt;-</span> p_beta<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_beta)</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>        Hessian_beta <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">t</span>(X) <span class="sc">%*%</span> W_beta <span class="sc">%*%</span> X</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>        <span class="co"># we update beta</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>        new_beta <span class="ot">&lt;-</span> beta <span class="sc">-</span> <span class="fu">solve</span>(Hessian_beta) <span class="sc">%*%</span> Score_beta</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># we check for convergence</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(<span class="fu">t</span>(beta<span class="sc">-</span>new_beta) <span class="sc">%*%</span> (beta<span class="sc">-</span>new_beta) <span class="sc">&lt;</span> tol){</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>            <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">beta =</span> beta, <span class="at">hessian =</span> Hessian_beta, <span class="at">nb_iter =</span> i)) </span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>        beta <span class="ot">&lt;-</span> new_beta</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">beta =</span> beta, <span class="at">hessian =</span> Hessian_beta, <span class="at">nb_iter =</span> i)) </span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>sol <span class="ot">&lt;-</span> <span class="fu">lr_solve</span>(X, Y, beta, nb_iter, tol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We verify that R <code>glm()</code> and our algorithm give the same coefficients:</p>
<ul>
<li>Newton-Raphson:</li>
</ul>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-14_c9c04e8ec421d3aa945c497a30b8aba4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sol<span class="sc">$</span>beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     [,1]
(Intercept) -1.153792e+01
balance      5.645755e-03
income       2.080353e-05</code></pre>
</div>
</div>
<ul>
<li>R <code>glm()</code>:</li>
</ul>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-15_e5675ebebd7715e60f8d764c145e7c50">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>glm_bal_inc <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> balance <span class="sc">+</span> income,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> default_data,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">coef</span>(glm_bal_inc ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  (Intercept)       balance        income 
-1.154047e+01  5.647103e-03  2.080898e-05 </code></pre>
</div>
</div>
<p>In the next sections (Interpretation, Confidence intervals, Tests) we will try to understand the outputs of the <code>glm()</code> function from a statistical viewpoint.</p>
</section>
<section id="the-iterative-reweighted-least-square-irls-method" class="level4" data-number="1.3.2.2">
<h4 data-number="1.3.2.2" class="anchored" data-anchor-id="the-iterative-reweighted-least-square-irls-method"><span class="header-section-number">1.3.2.2</span> The Iterative Reweighted Least Square (IRLS) method</h4>
<p>There is an equivalent approach to the the Newton-Raphson described in the literature as Iterative Reweighted Least Square (IRLS).</p>
<p>The Newton-Raphson update formula rewrites:</p>
<p><span class="math display">\[
\begin{align}
\beta^{(k+1)} &amp;= \beta^{(k)} - H^{-1}(\beta^{(k)})S(\beta^{(k)}) \\
&amp;=\beta^{(k)} + (X^TW_{\beta^{(k)}}X)^{-1}X^T(Y-P_{\beta^{(k)}}) \\
&amp;= (X^TW_{\beta^{(k)}}X)^{-1}(X^TW_{\beta^{(k)}}X)\beta^{(k)} + (X^TW_{\beta^{(k)}}X)^{-1}X^T(Y-P_{\beta^{(k)}}) \\
&amp;= (X^TW_{\beta^{(k)}}X)^{-1}X^TW_{\beta^{(k)}}\left(X\beta^{(k)}+W_{\beta^{(k)}}^{-1}(Y-P_{\beta^{(k)}}) \right) \\
&amp;= (X^TW_{\beta^{(k)}}X)^{-1}X^TW_{\beta^{(k)}}Z_{\beta^{(k)}} \\
\end{align}
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
Z_{\beta^{(k)}}= X\beta^{(k)}+W_{\beta^{(k)}}^{-1}(Y-P_{\beta^{(k)}})
\]</span></p>
<p><span class="math inline">\(\beta^{(k+1)} = (X^TW_{\beta^{(k)}}X)^{-1}X^TW_{\beta^{(k)}}Z_{\beta{(k)}}\)</span> corresponds to the solution of a weighted (<span class="math inline">\(W_{\beta^{(k)}}\)</span>) linear regression of <span class="math inline">\(Z_{\beta^{(k)}}\)</span> by <span class="math inline">\(X\)</span>. As an exercise you can implement this algorithm.</p>
</section>
<section id="example-where-mle-is-not-finite" class="level4" data-number="1.3.2.3">
<h4 data-number="1.3.2.3" class="anchored" data-anchor-id="example-where-mle-is-not-finite"><span class="header-section-number">1.3.2.3</span> Example where MLE is not finite</h4>
<p>To conclude on the numerical aspects, we signal a special and extreme case where the iterative algorithm won’t converge. The theoretical aspect is covered in <span class="citation" data-cites="albert1984a">(<a href="#ref-albert1984a" role="doc-biblioref">A. and A. 1984</a>)</span>.</p>
<p>We simulate a perfectly separated data set. Here <span class="math inline">\(X\in \mathbb [-1,1]\)</span> and <span class="math inline">\(Y\in\{0,1\}\)</span>:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-16_0a8fa62e322c00ea4c21105e88a3bc64">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1987</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">0</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">50</span>))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>tbl_separated <span class="ot">&lt;-</span> <span class="fu">tibble</span>(X,Y)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tbl_separated) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(X, Y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this setting the iterative algorithm fails to converge and coefficient “saturates” to a high/low value (while it should go to infinite):</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-17_05cee1de3a15d297513d5be9bc2bb105">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>glm_separated <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> X,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> tbl_separated,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>glm_separated<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           X 
  -5.763399 4227.385776 </code></pre>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-18_8eb24b14aadce9a51ce30658ad913d5d">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>separated_fit <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">augment</span>(glm_separated, <span class="at">type.predict =</span> <span class="st">"response"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(separated_fit) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(X, Y)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(X,.fitted))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we slightly modify the data set, changing a <span class="math inline">\(y\)</span> observation with <span class="math inline">\(x\in[-1,0]\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(1\)</span>.</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-19_950def127d97c71186f625d5e292a19f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> Y</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>Y1[<span class="dv">25</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>tbl_overlap <span class="ot">&lt;-</span> <span class="fu">tibble</span>(X,Y1)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tbl_overlap) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(X, Y1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The iterative algorithm converges again and the impact on the Scoring function (i.e.&nbsp;<span class="math inline">\(\mathbb{P}[Y=1|X=x)\)</span>) and the decision rule (shifting left below <span class="math inline">\(X=O\)</span>) is not negligible for a one point change:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-20_24031d130273df227865da06bf225dbf">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>glm_overlap <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y1 <span class="sc">~</span> X,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> tbl_separated,</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>overlap_fit <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">augment</span>(glm_overlap, <span class="at">type.predict =</span> <span class="st">"response"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(overlap_fit) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(X, Y1)) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(X,.fitted))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Nonetheless the case we described is very unlikely to happen in a real life setting, and a good data set exploration should avoid such trap. More details can be found in the document <code>Separation and Convergence Issues in Logistic Regression.pdf</code></p>
</section>
</section>
<section id="logistic-regression-as-a-machine-learning-approach" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="logistic-regression-as-a-machine-learning-approach"><span class="header-section-number">1.3.3</span> Logistic Regression as a machine learning approach</h3>
<p>We have another look at the log-likelihood equation stated before, we have:</p>
<p><span class="math display">\[
\begin{align}
\ell(Y,\beta)=\log L(Y,\beta) &amp;=\sum_{i=1}^n \left(y_i \log(p_{\beta}(x_i))+(1-y_i) \log(1- p_{\beta}(x_i))\right) \\
                              &amp;=-\sum_{i=1}^{n} \ell_{logistic} \left(p_{\beta}(x_i),y_i\right) \\
                              &amp;= -n\hat{\mathrm R}(p_\beta)
\end{align}
\]</span></p>
<p>where <span class="math inline">\(\ell_{logistic}: \{0,1\}\times \{0,1\} \to \mathbb R^+\)</span>:</p>
<p><span class="math display">\[
\ell_{logistic}(y,z) = -y\log(z)-(1-y)\log(1-z)=\left\{ \begin{array}{ll}
    -\log(z) &amp;  \mbox{if } y = 1\cr
    -\log(1-z) &amp;  \mbox{if } y = 0\cr
\end{array} \right.
\]</span></p>
<p>and <span class="math inline">\(\hat{\mathrm{R}}(p_\beta)\)</span> is the empirical risk on the training set.</p>
<p>Estimating <span class="math inline">\(\beta\)</span> by maximizing the log-likelihood is equivalent to minimizing with respect to <span class="math inline">\(\beta\)</span> the empirical risk of <span class="math inline">\(p_\beta\)</span> for the logistic loss. Note that usually in the context of machine learning and logistic loss, the output <span class="math inline">\(Y\)</span> is relabeled to <span class="math inline">\(\{-1,1\}\)</span></p>
</section>
</section>
</section>
<section id="interpretation" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Interpretation</h1>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-21_a34b3ee6713b03c1a904b828159b8600">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_default)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ ., family = "binomial", data = default_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4691  -0.1418  -0.0557  -0.0203   3.7383  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.087e+01  4.923e-01 -22.080  &lt; 2e-16 ***
studentYes  -6.468e-01  2.363e-01  -2.738  0.00619 ** 
balance      5.737e-03  2.319e-04  24.738  &lt; 2e-16 ***
income       3.033e-06  8.203e-06   0.370  0.71152    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1571.5  on 9996  degrees of freedom
AIC: 1579.5

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Based on this output, the fitted model is (we have re-scaled balance and income for better readability):</p>
<p><span class="math display">\[
\log \bigg( \frac{p_{\beta}(x_i)}{1 - p_{\beta}(x_i)}\bigg) = -1.08 - 0.65(\mathbb{1}_{\mathrm{student}_i=\mathrm{Yes}}) + 5.74(\frac{\mathrm{balance}_i}{1000})+ 0.03(\frac{\mathrm{income}_i}{10000})
\]</span></p>
<section id="coefficients" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="coefficients"><span class="header-section-number">2.1</span> Coefficients</h2>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>We cannot interpret the coefficients in the same manner as we interpret coefficients from a linear model, as the outcome is now expressed in “logits”:</p>
<ul>
<li>The predicted logit (or as we will see later log-odds) of defaulting for non-students with zero balance and income are <span class="math inline">\(-1.08\)</span>.</li>
<li>Each one-unit difference in <span class="math inline">\(\frac{\mathrm{balance}}{1000}\)</span> is associated with a difference of 5.74 in the predicted logit of defaulting.</li>
<li>Each one-unit difference in <span class="math inline">\(\frac{\mathrm{income}}{10000}\)</span> is associated with a difference of 0.03 in the predicted logit of defaulting.</li>
</ul>
</div>
</div>
</section>
<section id="odds" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="odds"><span class="header-section-number">2.2</span> Odds</h2>
<p>We remind the following relationship:</p>
<p><span class="math display">\[
\mathrm{logit}(p_{\beta}(x))=\log(\frac{p_{\beta}(x)}{1-p_{\beta}(x)})=x^T\beta
\]</span></p>
<p>The ratio on which we take the logarithm is called odds:</p>
<p><span class="math display">\[
odd_\beta(x) = \frac{p_{\beta}(x)}{1-p_{\beta}(x)}=exp(x^T\beta)
\]</span></p>
<p>It represents the chance an event occurs (<span class="math inline">\(p_{\beta}(x)\)</span>) versus the chance that same event does not occur (<span class="math inline">\(1-p_{\beta}(x)\)</span>).</p>
<p>Odds are an alternative scale to probability for representing chance.</p>
<p>They arose as a way to express the payoffs for bets. An even bet means that the winner gets paid an equal amount to that staked.</p>
<p>A 3–1 against bet would pay <span class="math inline">\(\$3\)</span> for every <span class="math inline">\(\$1\)</span> bet, while a 3–1 on bet would pay only <span class="math inline">\(\$1\)</span> for every <span class="math inline">\(\$3\)</span> bet.</p>
<p>For an event <span class="math inline">\(A\)</span> we have <span class="math inline">\(odds(A) \in [0,+\infty[\)</span>, and <span class="math inline">\(odds(A) &gt; 1\)</span> if <span class="math inline">\(\mathbf P(A) &gt; 0.5\)</span>.</p>
<p>Example: <span class="math inline">\(P(A)= \frac{3}{5}\)</span> is equivalent to <span class="math inline">\(Odds(A) = 1.5\)</span>. It means <span class="math inline">\(A\)</span> happens 1.5 more often than its complement Not <span class="math inline">\(A\)</span>.</p>
<p>We can also rewrite:</p>
<p><span class="math display">\[
p_\beta(x) = \frac{odds_{\beta}(x)}{1+odds_{\beta}(x)}
\]</span> To set these ideas, for a variable <span class="math inline">\(x\)</span> in <span class="math inline">\([-5,5]\)</span>, we plot the logistic curve (i.e.&nbsp;the probabilities) together with the odds and the logits (ie log(odds)):</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-22_aefd2e602e14a6a2da60dc3dc5e5157f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create w values and transformed values</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>data_logistic <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">mutate</span>(<span class="at">probs =</span> <span class="fu">exp</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(x)), <span class="co"># logistic curve</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">odds =</span> probs <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> probs),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">logits =</span> <span class="fu">log</span>(odds))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic curve / sigmoid (probabilities)</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data =</span> data_logistic , <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> probs)) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probabilities"</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponential curve (odds)</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data =</span> data_logistic , <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> odds)) <span class="sc">+</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Odds"</span>)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Linear curve (log-odds)</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span>  <span class="fu">ggplot</span>(<span class="at">data =</span> data_logistic, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> logits)) <span class="sc">+</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Logits=log(Odds)"</span>)</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Interpret the coefficients in terms of odds:</p>
<ul>
<li>The coefficient of balance is 0.005737. Hence an increase of balance by 1000 points increases odds for default by a factor of 310.</li>
<li>The coefficient of income is 3^{-6}. Hence an increase of income by 10000 points increases odds for default by a factor of 1.03.</li>
<li>The coefficient of “being a student” is -0.647. Hence being a student decreases odds for default by a factor of 0.52.</li>
</ul>
</div>
</div>
</section>
<section id="odds-ratio" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="odds-ratio"><span class="header-section-number">2.3</span> Odds ratio</h2>
<p>For two observations <span class="math inline">\(x\)</span> and <span class="math inline">\(\tilde{x}\)</span> we define odds ratio as:</p>
<p><span class="math display">\[
OR(x,\tilde{x})=\frac{odds(x)}{odds(\tilde{x})}
\]</span> Odds ratio are used to compare probabilities between two observations:</p>
<ul>
<li><span class="math inline">\(OR(x,\tilde{x}) = 1 \Leftrightarrow p(x)=p(\tilde{x})\)</span></li>
<li><span class="math inline">\(OR &gt; 1 \Leftrightarrow p(x)&gt;p(\tilde{x})\)</span></li>
<li><span class="math inline">\(OR &lt; 1 \Leftrightarrow p(x)&lt;p(\tilde{x})\)</span></li>
</ul>
<p>They are also used to measure the impact of a predictor:</p>
<p><span class="math display">\[
OR(x,\tilde{x})=\exp(\beta_1(x_1-\tilde{x_1}))\cdots exp(\beta_p(x_p-\tilde{x_p}))
\]</span> Choosing <span class="math inline">\((x,\tilde{x})\)</span> differing by only one predictor <span class="math inline">\(x_j\)</span>:</p>
<p><span class="math display">\[
OR(x,\tilde{x})=\exp(\beta_j(x_j-\tilde{x_j}))
\]</span></p>
<p>In other words, <span class="math inline">\(exp(\beta_j)\)</span> is the odds ratio associated with a one-unit increase in the <span class="math inline">\(x_j\)</span>.</p>
<p>More on odds ratio interpretation can be found <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-how-do-i-interpret-odds-ratios-in-logistic-regression/">here</a>.</p>
</section>
</section>
<section id="inference" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Inference</h1>
<section id="asymptotic-properties-of-mle" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="asymptotic-properties-of-mle"><span class="header-section-number">3.1</span> Asymptotic properties of MLE</h2>
<p>It can be proven that under certain assumptions (see for example <span class="citation" data-cites="gourieroux1981">Gourieroux (<a href="#ref-gourieroux1981" role="doc-biblioref">1981</a>)</span> or <span class="citation" data-cites="fahrmeir1986">Fahrmeir (<a href="#ref-fahrmeir1986" role="doc-biblioref">1986</a>)</span>), the Maximum Likelihood Estimator has the following asymptotic properties:</p>
<p><span class="math display">\[
\hat\beta \xrightarrow[] {p} \beta \textrm{, as n} \to \infty
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\sqrt n(\hat\beta-\beta) \xrightarrow[]{\mathcal L} \mathcal N(0,\mathcal I(\beta)^{-1})\textrm{, as n} \to \infty
\]</span> where:</p>
<p><span class="math display">\[
\mathcal I(\beta) = -\mathbb{E}[\nabla^2\ell(Y,\beta)]=-\frac{1}{n}\nabla^2\ell(Y,\beta)=\frac{1}{n}X^T W_\beta X
\]</span></p>
<p>where <span class="math inline">\(\mathcal I(\beta)\)</span> is the Fisher information matrix. In the case of Logistic Regression, Fisher information matrix equals the Observed information matrix.</p>
<p>The asymptotic property rewrites:</p>
<p><span class="math display">\[
(\hat\beta-\beta)^Tn\mathcal I(\beta)(\hat\beta-\beta) \xrightarrow[]{\mathcal L} \chi_p^2
\]</span></p>
<p>As <span class="math inline">\(\mathcal I(\beta)\)</span> is unknown we use instead <span class="math inline">\(\mathcal I(\hat\beta)=\frac{1}{n}X^T W_\hat\beta X\)</span>. Since <span class="math inline">\(\hat\beta \xrightarrow[] {p} \beta\)</span> and <span class="math inline">\(p_\beta\)</span> continuous in <span class="math inline">\(\beta\)</span> it can be shown (Slutsky) that:</p>
<p><span class="math display">\[
(\hat\beta-\beta)^TX^T W_{\hat\beta} X(\hat\beta-\beta) \xrightarrow[]{\mathcal L} \chi_p^2
\]</span></p>
<p>Or equivalently:</p>
<p><span class="math display">\[
\hat\beta -\beta \xrightarrow[]{\mathcal L} \mathcal N(0,\mathcal ( X^T W_{\hat\beta} X )^{-1})
\]</span></p>
</section>
<section id="wald-statistics" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="wald-statistics"><span class="header-section-number">3.2</span> Wald statistics</h2>
<section id="confidence-intervals" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="confidence-intervals"><span class="header-section-number">3.2.1</span> Confidence intervals</h3>
<p>Using the preceding asymptotic properties we can derive confidence interval and tests for the coefficients <span class="math inline">\(\beta_j\)</span>, <span class="math inline">\(j =1,\cdots,p\)</span> of the model:</p>
<p><span class="math display">\[
\frac{\hat\beta_j-\beta_j}{\hat \sigma_j} \xrightarrow[]{\mathcal L} \mathcal N(0,1)
\]</span> where <span class="math inline">\(\hat \sigma_j^2= s.e.(\hat\beta_j)^2\)</span> denotes the <span class="math inline">\(j-th\)</span> term of <span class="math inline">\(( X^T W_{\hat\beta} X )^{-1}\)</span> diagonal.</p>
<p>The typical formula for a <span class="math inline">\(1-\alpha\)</span> confidence interval is:</p>
<p><span class="math display">\[
\hat\beta_j \pm z_{1-\alpha/2} \hat \sigma_j
\]</span> where <span class="math inline">\(z_{1-\alpha/2}\)</span> is the <span class="math inline">\((1-\alpha/2)\)</span> quantile of the standard normal distribution.</p>
<p>Going further, the asymptotic properties of MLE also allow to test the “statistical significance” of each coefficient in the model, the Wald test.</p>
<p>Denoting: <span class="math inline">\(\textrm{H}_0\textrm{: } \beta_j=0\)</span> and <span class="math inline">\(\textrm{H}_1\textrm{: } \beta_j \neq 0\)</span> we have under <span class="math inline">\(\textrm{H}_0\)</span>:</p>
<p><span class="math display">\[
\frac{\hat\beta_j}{\hat \sigma_j} \xrightarrow[]{\mathcal L} \mathcal N(0,1)
\]</span> We will reject <span class="math inline">\(\textrm{H}_0\)</span> at level <span class="math inline">\(\alpha\)</span> if the absolute of the observed value <span class="math inline">\(\frac{\hat\beta_j}{\hat \sigma_j}\)</span> (denoted in <code>glm</code> output as <code>z value</code>) is above the <span class="math inline">\((1-\alpha/2)\)</span> quantile of the standard normal distribution.</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-23_26d32858d82d4fd542374c01aef575ca">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>glm_bal_inc <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> balance <span class="sc">+</span> income,</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> default_data,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_bal_inc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ balance + income, family = "binomial", 
    data = default_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4725  -0.1444  -0.0574  -0.0211   3.7245  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.154e+01  4.348e-01 -26.545  &lt; 2e-16 ***
balance      5.647e-03  2.274e-04  24.836  &lt; 2e-16 ***
income       2.081e-05  4.985e-06   4.174 2.99e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1579.0  on 9997  degrees of freedom
AIC: 1585

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Said differently, we reject <span class="math inline">\(\textrm{H}_0\)</span> at level <span class="math inline">\(\alpha\)</span> when <span class="math inline">\(p = \mathbf P(|z|&gt;|\frac{\hat\beta_j}{\hat \sigma_j}|)&lt;\alpha\)</span>.</p>
<p><span class="math inline">\(p\)</span> is called the p-value.</p>
<p>The output of <code>glm</code> in <code>R</code> shows:</p>
<ul>
<li><p><span class="math inline">\(\hat\beta_j\)</span> as <code>Estimate</code>,</p></li>
<li><p><span class="math inline">\(\hat \sigma_j\)</span> as <code>Std. Error</code>,</p></li>
<li><p>the absolute of the observed test statistic <span class="math inline">\(\frac{\hat\beta_j}{\hat \sigma_j}\)</span> as <code>z value</code>,</p></li>
<li><p>and the p-value as <code>Pr(&gt;|z|)</code></p></li>
</ul>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-24_fa57358c2ea862b87ec3768404802967">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fl">4.174</span>))<span class="sc">*</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.992978e-05</code></pre>
</div>
</div>
<p>Using the hessian matrix obtained before as a side product of the Newton-Raphson algorithm, we retrieve the same values as <code>glm</code> for <span class="math inline">\(\hat \sigma_j\)</span>:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-25_ef4f0b53de1209f37cb667bc6eee9b4a">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>std_errors <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">solve</span>(<span class="sc">-</span><span class="fu">as.matrix</span>(sol<span class="sc">$</span>hessian))))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>std_errors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)      balance       income 
4.346349e-01 2.273110e-04 4.984579e-06 </code></pre>
</div>
</div>
<p>The <code>R</code> command to get confidence interval of estimators based on Wald statistic is the following (by default <span class="math inline">\(\alpha=5\%\)</span>)</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-26_669acd8691203af32b47ffdf3b4f3781">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint.default</span>(glm_bal_inc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    2.5 %        97.5 %
(Intercept) -1.239258e+01 -1.068836e+01
balance      5.201460e-03  6.092746e-03
income       1.103823e-05  3.057972e-05</code></pre>
</div>
</div>
<p>We can retrieve it manually using coefficient estimate and standard deviation:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-27_aa9ea09ac12257374770005821834cba">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>output_bal_inc <span class="ot">=</span> <span class="fu">summary</span>(glm_bal_inc)<span class="sc">$</span>coefficients</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>bal_std_estimate <span class="ot">&lt;-</span> output_bal_inc[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>bal_std_error <span class="ot">&lt;-</span> output_bal_inc[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co"># upper bound for beta(balance) at 5%</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> bal_std_estimate <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> bal_std_error</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="co"># lower bound for beta(balance) at 5%</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> bal_std_estimate <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> bal_std_error</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>(bal_confint <span class="ot">&lt;-</span> <span class="fu">c</span>(lower, upper))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.005201452 0.006092754</code></pre>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-28_f1ee7abae3528055107bbfc1fc31ff12">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(glm_bal_inc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                    2.5 %        97.5 %
(Intercept) -1.241910e+01 -1.071361e+01
balance      5.214030e-03  6.105971e-03
income       1.105359e-05  3.060844e-05</code></pre>
</div>
</div>
<p>https://stats.stackexchange.com/questions/5304/why-is-there-a-difference-between-manually-calculating-a-logistic-regression-95</p>
</section>
<section id="tests-on-model-coefficients" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="tests-on-model-coefficients"><span class="header-section-number">3.2.2</span> Tests on model coefficients</h3>
<p>Based on the same idea, it is possible to test for the nullity of a subset of the model coefficients.</p>
<p>Denoting: <span class="math inline">\(\textrm{H}_0\textrm{: } \beta_1=\cdots=\beta_q=0\)</span>, <span class="math inline">\(\textrm{H}_1\textrm{: } \exists j \in \{1,\cdots,q \} \textrm{ }|\textrm{ }\beta_j \neq 0\)</span>, <span class="math inline">\(\hat\beta=(\hat\beta_1,\cdots,\hat\beta_p)\)</span> the MLE and <span class="math inline">\(\hat\beta_{1:q}=(\hat\beta_1,\cdots,\hat\beta_q)\)</span> the vector of first <span class="math inline">\(q\)</span> parameters.</p>
<p>We have under <span class="math inline">\(\textrm{H}_0\)</span>:</p>
<p><span class="math display">\[
\hat\beta_{1:q}^T( X^T W_{\hat\beta} X )^{-1}_{1:q}\hat\beta_{1:q} \xrightarrow[]{\mathcal L} \chi_q^2
\]</span> where <span class="math inline">\((X^T W_{\hat\beta} X )^{-1}_{1:q}\)</span> is the <span class="math inline">\(q \times q\)</span> upper left block matrix extracted from the inverse of hessian.</p>
<p>We will reject <span class="math inline">\(\textrm{H}_0\)</span> at level <span class="math inline">\(\alpha\)</span> if the observed value <span class="math inline">\(\hat\beta_{1:q}^T( X^T W_{\hat\beta} X )^{-1}_{1:q}\hat\beta_{1:q}\)</span> is above the <span class="math inline">\(1-\alpha\)</span> quantile of the <span class="math inline">\(\chi_q^2\)</span> distribution.</p>
<p>We show below the Wald tests for each coefficient in the model using <code>summary</code>:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-29_de32fb227e3ec73e2f3e77b3b6ca6fc6">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_default)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = default ~ ., family = "binomial", data = default_data)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.4691  -0.1418  -0.0557  -0.0203   3.7383  

Coefficients:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -1.087e+01  4.923e-01 -22.080  &lt; 2e-16 ***
studentYes  -6.468e-01  2.363e-01  -2.738  0.00619 ** 
balance      5.737e-03  2.319e-04  24.738  &lt; 2e-16 ***
income       3.033e-06  8.203e-06   0.370  0.71152    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2920.6  on 9999  degrees of freedom
Residual deviance: 1571.5  on 9996  degrees of freedom
AIC: 1579.5

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>These tests can be also performed in <code>R</code> using <code>car::Anova</code> or <code>aod::wald.test</code> routines. In particular when categorical variables have more than two levels these functions allow to test each variables as a whole (vs coefficient by coefficient when using <code>summary</code>)</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-30_4404c6dbd2151badfb6e3258014ec3e0">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(glm_default, <span class="at">type=</span><span class="dv">3</span>, <span class="at">test.statistic=</span> <span class="st">"Wald"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Chisq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"487.5302944","3":"4.911280e-108","_rn_":"(Intercept)"},{"1":"1","2":"7.4947060","3":"6.188063e-03","_rn_":"student"},{"1":"1","2":"611.9470216","3":"4.219578e-135","_rn_":"balance"},{"1":"1","2":"0.1367631","3":"7.115203e-01","_rn_":"income"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can retrieve these outputs manually:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-31_8c6f8b786ac036caf1dfd0d244203711">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sum_default <span class="ot">&lt;-</span> <span class="fu">summary</span>(glm_default)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>beta_income <span class="ot">&lt;-</span> sum_default<span class="sc">$</span>coefficients[<span class="dv">4</span>,<span class="dv">1</span>]</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>stdev_income <span class="ot">&lt;-</span> sum_default<span class="sc">$</span>coefficients[<span class="dv">4</span>,<span class="dv">2</span>]</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>wald <span class="ot">&lt;-</span> beta_income <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> stdev_income <span class="sc">^</span> <span class="dv">2</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pchisq</span>(wald, <span class="at">df =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7115203</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>z_val <span class="ot">&lt;-</span> sum_default<span class="sc">$</span>coefficients[<span class="dv">4</span>,<span class="dv">3</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(z_val))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7115203</code></pre>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-32_a46ef00cae365f788c864d21fbe2350c">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing the income coefficient (Terms = 4)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>aod<span class="sc">::</span><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(glm_default), <span class="at">Sigma =</span> <span class="fu">vcov</span>(glm_default), <span class="at">Terms =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 0.14, df = 1, P(&gt; X2) = 0.71</code></pre>
</div>
</div>
<p>With all routines, the p-value for the income coefficient is <span class="math inline">\(0.71\)</span> validating the null hypothesis.</p>
<p>Using <code>Terms</code> or <code>L</code> parameters in <code>aod::wald.test</code> it is also feasible to test the null hypothesis for a subsets of parameters:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-33_62790316b30824d0cd663d5b0cdbf8a1">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing the income coefficient (Terms = 4)</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>aod<span class="sc">::</span><span class="fu">wald.test</span>(<span class="at">b =</span> <span class="fu">coef</span>(glm_default), <span class="at">Sigma =</span> <span class="fu">vcov</span>(glm_default), <span class="at">Terms =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Wald test:
----------

Chi-squared test:
X2 = 698.3, df = 3, P(&gt; X2) = 0.0</code></pre>
</div>
</div>
<p>The null hypothesis is rejected for the model with balance and student.</p>
<p>There are known issues with the Wald test:</p>
<ul>
<li><p>It is not invariant to re-reparametrisation. In the case of logistic regression we have a nonlinear model where the individual parameters are not of foremost interest, but rather odds ratios for instance, which are nonlinear transforms of the parameters.</p></li>
<li><p>Hauck and Donner (1977) have shown that the Wald test has undesirable properties for logistic regression. In particular when <span class="math inline">\(\hat \beta_j \to \infty\)</span> (e.g.&nbsp;in case of separation or quasi separation), it is likely that <span class="math inline">\(\hat\sigma_j\to \infty\)</span>. The result can be that the Wald statistic tends to zero as the distance between the parameter estimate and the null value increases (null hypothesis gets more and more wrong).</p></li>
</ul>
<p>So in the context of Logistic Regression (and GLM), while Wald statistics are usually reported by statistical routines, the likelihood ratio or deviance-based tests are often favored.</p>
</section>
</section>
<section id="likelihood-ratio-tests" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="likelihood-ratio-tests"><span class="header-section-number">3.3</span> Likelihood ratio tests</h2>
<p>It is possible to test for the nullity of a subset of the model coefficients using Likelihood Ratio statistics.</p>
<p>Denoting: <span class="math inline">\(\textrm{H}_0\textrm{: } \beta_1=\cdots=\beta_q=0\)</span>, <span class="math inline">\(\textrm{H}_1\textrm{: } \exists j \in \{1,\cdots,q \} \textrm{ }|\textrm{ }\beta_j \neq 0\)</span>, and <span class="math inline">\(\hat\beta=(\hat\beta_1,\cdots,\hat\beta_p)\)</span> the MLE, we have under <span class="math inline">\(\textrm{H}_0\)</span>:</p>
<p><span class="math display">\[
-2\left(\ell_{\textrm{H}_0}(Y,\hat\beta_{\textrm{H}_0})-\ell(Y,\hat\beta)\right)\xrightarrow[]{\mathcal L} \chi_q^2
\]</span> where <span class="math inline">\(\ell_{\textrm{H}_0}(Y,\hat\beta_{\textrm{H}_0})\)</span> is the log-likelihood of:</p>
<p><span class="math display">\[
\mathrm{logit}(p_{\beta}(X))=x_{q+1}\beta_{q+1}+\cdots+x_{n}\beta_{n}
\]</span></p>
<p>Consider two models, a larger model with <span class="math inline">\(l\)</span> parameters and likelihood <span class="math inline">\(L_L\)</span> and a smaller model with <span class="math inline">\(s\)</span> parameters and likelihood <span class="math inline">\(L_S\)</span>, where the smaller model represents a subset of the larger model. Typically the smaller model is equivalent to the large model where we have imposed:</p>
<p><span class="math display">\[
\textrm{H}_0\textrm{: } \ \beta_j = \ldots  = \beta_{j+r}  = 0
\]</span> Likelihood Ratio tests on variables may be performed in <code>R</code> using <code>car::Anova</code>:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-34_6916d004d07babe3c9aec7afab53a81f">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(glm_default, <span class="at">type=</span><span class="dv">3</span>, <span class="at">test.statistic=</span> <span class="st">"LR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["LR Chisq"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chisq)"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"7.4214426","2":"1","3":"6.445112e-03","_rn_":"student"},{"1":"1335.9509861","2":"1","3":"1.740402e-292","_rn_":"balance"},{"1":"0.1367695","2":"1","3":"7.115139e-01","_rn_":"income"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Using base <code>R</code> <code>anova</code> it is also possible to test subsets of variables and in particular individual variables within the “full” model:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-35_44fe379c953e0e9c1450c84485fca837">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>glm_wo_student <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> balance <span class="sc">+</span> income,</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> default_data,</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>glm_wo_balance <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> student <span class="sc">+</span> income,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> default_data,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>glm_wo_income <span class="ot">&lt;-</span> <span class="fu">glm</span>(default <span class="sc">~</span> student <span class="sc">+</span> balance,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> default_data,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">family =</span> <span class="st">"binomial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-36_d580c06d6ce848a65cdfe89426ca0724">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(glm_wo_student, glm_default, <span class="at">test =</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"9997","2":"1578.966","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"9996","2":"1571.545","3":"1","4":"7.421443","5":"0.006445112","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>We can retrieve this result manually:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-37_5c7876d24e20e0cd36083c54f0cb4498">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>LRT <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="fu">logLik</span>(glm_default)<span class="sc">-</span><span class="fu">logLik</span>(glm_wo_student))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pchisq</span>(LRT, <span class="at">df =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'log Lik.' 0.006445112 (df=4)</code></pre>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-38_52250f9151cf987fdc357fae289f34dc">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(glm_wo_balance, glm_default, <span class="at">test =</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"9997","2":"2907.496","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"9996","2":"1571.545","3":"1","4":"1335.951","5":"1.740402e-292","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-39_fa0e92d4542bc22997a554502850df8b">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(glm_wo_income, glm_default, <span class="at">test =</span> <span class="st">"LRT"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Resid. Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Resid. Dev"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Df"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"9997","2":"1571.682","3":"NA","4":"NA","5":"NA","_rn_":"1"},{"1":"9996","2":"1571.545","3":"1","4":"0.1367695","5":"0.7115139","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>The deviance defined as <span class="math inline">\(D=-2 \ell\)</span> is often reported by statistical software in place of log-likelihood. A large likelihood corresponding to a small deviance.</p>
<p>A better coverage of tests in the context of Logistic Regression can be found <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faqhow-are-the-likelihood-ratio-wald-and-lagrange-multiplier-score-tests-different-andor-similar/">here</a> or in <span class="citation" data-cites="hosmer2013">(<a href="#ref-hosmer2013" role="doc-biblioref">Hosmer, Lemeshow, and Sturdivant 2013</a>)</span>. See also <a href="https://stats.oarc.ucla.edu/r/dae/logit-regression/">here</a> for a data analysis using <code>R</code> and <a href="https://stats.stackexchange.com/questions/86351/interpretation-of-rs-output-for-binomial-regression">here</a> for a detailed description of the outputs of <code>glm()</code>.</p>
</section>
</section>
<section id="variable-selection-model-assessment" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Variable selection, model assessment</h1>
<p>We have seen in the last section how to compare two or more nested Logistic regression models (typically a reduced model with less variables than a reference or full model).</p>
<p>Real life data sets usually contain a large number of predictors or inputs. As their number grow, the analyst will have to analyse a growing number of possible models or variable combinations (typically <span class="math inline">\(2^p\)</span> where <span class="math inline">\(p\)</span> denotes the number of predictors). Furthermore as the number of predictors grow the models might overfit the training set, causing a deterioration of prediction error.</p>
<p>Variable selection is a critical aspect of building Logistic Regression models and prediction models in general. This process seeks to strike a delicate balance between the bias-variance trade-off, aiming to find models that are both parsimonious and predictive. Parsimony, in this context, implies the selection of a minimal set of predictor variables that still provides an accurate representation of the data, avoiding overfitting while enhancing model generalization.</p>
<p>This is a complex subject that we will not cover in depth in this course.</p>
<p>For a better coverage, chapter 7 <code>Model Assessment and Selection</code> of <span class="citation" data-cites="hastie2009">Hastie, Tibshirani, and Friedman (<a href="#ref-hastie2009" role="doc-biblioref">2009</a>)</span> discusses in depth the interplay between bias, variance and model complexity. Chapter 6 <code>Linear Model Selection and Regularization</code> of <span class="citation" data-cites="islr2021">James et al. (<a href="#ref-islr2021" role="doc-biblioref">2021</a>)</span> discusses methods to automatically perform variable selection in the context of linear models.</p>
<p>Various methods and criteria are employed for variable selection. In this section we consider some methods for selecting subsets of predictors: this include best subset, stepwise model selection procedures and penalization or shrinkage. We use the Agriculture Farm Lending data set as an example.</p>
<section id="best-subset" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="best-subset"><span class="header-section-number">4.1</span> Best subset</h2>
<p>One common approach is the “best subset” method, which evaluates all possible combinations of predictor variables, resulting in <span class="math inline">\(2^p-1\)</span> models for p predictors, and selects the one that optimizes a specified criterion, such as the Akaike Information Criterion (AIC) or Bayesian Information Criterion (BIC). It is computationally intensive and usually restricted to low dimension data sets.</p>
<hr>
<p><strong>Algorithm</strong>: Best subset selection</p>
<hr>
<ol type="1">
<li>For <span class="math inline">\(k=1,\cdots,p\)</span>:
<ol type="a">
<li>Fit all <span class="math inline">\({p\choose k}\)</span> models that contain exactly <span class="math inline">\(k\)</span> predictors.</li>
<li>Pick the best among these <span class="math inline">\({p\choose k}\)</span> models, and call it <span class="math inline">\(\mathcal M_k\)</span>. In the case of Logistic Regression, best usually means largest log-likelihood or min deviance.</li>
</ol></li>
<li>Select a single best model from among <span class="math inline">\(\mathcal M_1,\cdots,\mathcal M_p\)</span> using a criterion. Usually the prediction error on a validation set, AIC, BIC… ******</li>
</ol>
<p>Given <span class="math inline">\(|\mathcal M|\)</span> we define the two following criteria which represent two way of penalizing the maximised log-likelihood <span class="math inline">\(\ell(Y,\hat\beta)\)</span>:</p>
<p><span class="math display">\[
\textrm{AIC}(\mathcal M)=-2\ell(Y,\hat\beta)+2|\mathcal M|
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\textrm{BIC}(\mathcal M)=-2\ell(Y,\hat\beta)+|\mathcal M|\log(n)
\]</span> The package <code>bestglm</code> allows best subset selection up to <span class="math inline">\(15\)</span> variables, by default it uses BIC. We use the Default data set to illustrate because Agriculture Farm Lending has around <span class="math inline">\(30\)</span> variables:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-40_ed15ce0a246c942b39f8dd10d7d9b36c">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bestglm)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>default_best <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(default_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y=</span><span class="fu">if_else</span>(default<span class="sc">==</span><span class="st">'Yes'</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>default))</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># p must be &lt; 15 for GLM</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Error in bestglm(as.data.frame(don_desbois_quanti), family = binomial) :</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="co"># p = 22. must be &lt;= 15 for GLM.</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>mod_sel <span class="ot">&lt;-</span> <span class="fu">bestglm</span>(default_best, <span class="at">family =</span> binomial)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>mod_sel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>BIC
BICq equivalent for q in (0.000417890560226675, 0.989405669357288)
Best Model:
                 Estimate  Std. Error    z value      Pr(&gt;|z|)
(Intercept) -10.749495878 0.369191361 -29.116326 2.230782e-186
studentYes   -0.714877620 0.147519010  -4.846003  1.259734e-06
balance       0.005738104 0.000231847  24.749526 3.136911e-135</code></pre>
</div>
</div>
</section>
<section id="stepwise-logistic-regression" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="stepwise-logistic-regression"><span class="header-section-number">4.2</span> Stepwise Logistic Regression</h2>
<p>Alternatively, stepwise methods, including forward and backward selection, iteratively add or remove variables based on the chosen criterion. These approaches, while useful, can be also computationally intensive, especially for high-dimensional datasets.</p>
<hr>
<p><strong>Algorithm</strong>: Forward stepwise selection</p>
<hr>
<ol type="1">
<li>For <span class="math inline">\(k=1,\cdots,p\)</span>:
<ol type="a">
<li>Consider all <span class="math inline">\(p+1-k\)</span> models that augment the predictors in <span class="math inline">\(\mathcal M_k\)</span> with one additional predictor.</li>
<li>Pick the best among these <span class="math inline">\(p+1-k\)</span> models, and call it <span class="math inline">\(\mathcal M_{k+1}\)</span>. In the case of Logistic Regression, best usually means largest log-likelihood or min deviance.</li>
</ol></li>
<li>Select a single best model from among <span class="math inline">\(\mathcal M_1,\cdots,\mathcal M_p\)</span> using a criterion. Usually the prediction error on a validation set, AIC, BIC…</li>
</ol>
<hr>
<p>or</p>
<hr>
<p><strong>Algorithm</strong>: Backward stepwise selection</p>
<hr>
<ol type="1">
<li>Let <span class="math inline">\(\mathcal M_p\)</span> denote the full model, which contains all <span class="math inline">\(p\)</span> predictors.</li>
<li>For <span class="math inline">\(k=p,\cdots,1\)</span>:
<ol type="a">
<li>Consider all <span class="math inline">\(k\)</span> models that contain all but one of the predictors in <span class="math inline">\(\mathcal M_k\)</span>, for a total of <span class="math inline">\(k-1\)</span> predictors.</li>
<li>Pick the best among these <span class="math inline">\(k\)</span> models, and call it <span class="math inline">\(\mathcal M_{k-1}\)</span>. In the case of Logistic Regression, best usually means largest log-likelihood or min deviance.</li>
</ol></li>
<li>Select a single best model from among <span class="math inline">\(\mathcal M_1,\cdots,\mathcal M_p\)</span> using a criterion. Usually the prediction error on a validation set, AIC, BIC…</li>
</ol>
<hr>
<p>Below we use forward stepwise selection based on the AIC criterion to select variables in the Agriculture Farm Lending data set:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-41_7c271855d5734f56ca4e52712996050f">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># package used to import spss file</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>don_desbois <span class="ot">&lt;-</span> <span class="fu">read.spss</span>(<span class="st">"../data/Agriculture Farm Lending/desbois.sav"</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">to.data.frame =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>don_desbois <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">as.factor</span>(<span class="fu">if_else</span>(DIFF<span class="sc">==</span><span class="st">'healthy'</span>, <span class="dv">0</span>, <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>DIFF)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Due to outliers some predictions "saturate"  to 0 or 1</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Warning: glm.fit: fitted probabilities numerically 0 or 1 occurredWarning: glm.fit: fitted probabilities numerically 0 or 1 occurred</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co"># winsorizing financial ratios removes the issue</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>don_desbois_winsorized <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(r1<span class="sc">:</span>r37, <span class="sc">~</span> DescTools<span class="sc">::</span><span class="fu">Winsorize</span>(.x , <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))))</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"># data_afl &lt;- don_desbois_winsorized</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>data_afl <span class="ot">&lt;-</span> don_desbois</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co">#define intercept-only model</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>intercept_only <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>data_afl, <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="co">#define model with all predictors</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a><span class="co"># In Desbois only financial ratios are used</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>data_afl <span class="sc">%&gt;%</span> <span class="fu">select</span>(Y, <span class="fu">starts_with</span>(<span class="st">'r'</span>)), <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a><span class="co"># We use all variables</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a><span class="co"># all &lt;- glm(Y ~ ., data=data_afl , family="binomial")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-42_fbbec82a565595c61c7ecb01fa8e372c">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform forward stepwise regression</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>forward_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all), <span class="at">k=</span><span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r21 + r14 + r17 + r24 + r11 + r28 + r36 + 
    r3 + r8 + r32, family = "binomial", data = data_afl)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.3973  -0.3720  -0.0830   0.2497   3.1342  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -11.1573     1.3883  -8.036 9.25e-16 ***
r1           10.3995     1.1853   8.773  &lt; 2e-16 ***
r21           3.9664     1.5931   2.490 0.012787 *  
r14           2.4414     0.6955   3.510 0.000448 ***
r17          36.0464     7.2134   4.997 5.82e-07 ***
r24          -4.1232     2.8366  -1.454 0.146058    
r11           1.4347     0.5289   2.713 0.006677 ** 
r28         -18.1295     6.1484  -2.949 0.003191 ** 
r36           1.5231     0.3888   3.917 8.95e-05 ***
r3            5.4959     1.2741   4.313 1.61e-05 ***
r8           -3.3793     0.9457  -3.573 0.000353 ***
r32          16.5696     6.9327   2.390 0.016846 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  666.58  on 1248  degrees of freedom
AIC: 690.58

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>We perform manually a likelihood-ratio-test-based forward selection (as described in Desbois) using only financial ratios as predictors.</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-43_6e899004a2baaca0349da3b576870355">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>data_afl <span class="sc">%&gt;%</span> <span class="fu">select</span>(Y, <span class="fu">starts_with</span>(<span class="st">'r'</span>)), <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>first_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(intercept_only, <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>first_step <span class="ot">&lt;-</span> first_step <span class="sc">%&gt;%</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(first_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>first_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"957.1207","3":"961.1207","4":"787.930453","5":"2.271029e-173","6":"r1"},{"1":"1","2":"979.8111","3":"983.8111","4":"765.240084","5":"1.948510e-168","6":"r14"},{"1":"1","2":"996.7790","3":"1000.7790","4":"748.272179","5":"9.529992e-165","6":"r21"},{"1":"1","2":"1094.0080","3":"1098.0080","4":"651.043122","5":"1.325113e-143","6":"r4"},{"1":"1","2":"1099.0846","3":"1103.0846","4":"645.966552","5":"1.683879e-142","6":"r8"},{"1":"1","2":"1122.7900","3":"1126.7900","4":"622.261169","5":"2.409697e-137","6":"r18"},{"1":"1","2":"1143.0811","3":"1147.0811","4":"601.970103","5":"6.241473e-133","6":"r2"},{"1":"1","2":"1157.5879","3":"1161.5879","4":"587.463287","5":"8.926507e-130","6":"r6"},{"1":"1","2":"1176.6167","3":"1180.6167","4":"568.434438","5":"1.229899e-125","6":"r22"},{"1":"1","2":"1185.1868","3":"1189.1868","4":"559.864405","5":"8.997366e-124","6":"r30"},{"1":"1","2":"1227.0902","3":"1231.0902","4":"517.960998","5":"1.175318e-114","6":"r12"},{"1":"1","2":"1236.4510","3":"1240.4510","4":"508.600165","5":"1.278732e-112","6":"r32"},{"1":"1","2":"1246.9621","3":"1250.9621","4":"498.089044","5":"2.476038e-110","6":"r11"},{"1":"1","2":"1333.1735","3":"1337.1735","4":"411.877702","5":"1.430215e-91","6":"r19"},{"1":"1","2":"1456.0679","3":"1460.0679","4":"288.983300","5":"8.281089e-65","6":"r5"},{"1":"1","2":"1527.5665","3":"1531.5665","4":"217.484620","5":"3.199383e-49","6":"r7"},{"1":"1","2":"1537.6651","3":"1541.6651","4":"207.386057","5":"5.107058e-47","6":"r28"},{"1":"1","2":"1601.0416","3":"1605.0416","4":"144.009517","5":"3.535983e-33","6":"r17"},{"1":"1","2":"1649.0260","3":"1653.0260","4":"96.025159","5":"1.134328e-22","6":"r3"},{"1":"1","2":"1687.0062","3":"1691.0062","4":"58.044990","5":"2.561911e-14","6":"r24"},{"1":"1","2":"1732.8183","3":"1736.8183","4":"12.232807","5":"4.695650e-04","6":"r36"},{"1":"1","2":"1741.5564","3":"1745.5564","4":"3.494776","5":"6.156273e-02","6":"r37"},{"1":"NA","2":"1745.0512","3":"1747.0512","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r1</code> is the most significant variable in the first step</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-44_24fa73596bc322ad23e52a7a3ae56703">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>second_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>second_step <span class="ot">&lt;-</span> second_step <span class="sc">%&gt;%</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(second_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>second_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"804.2745","3":"810.2745","4":"152.84620341","5":"4.138901e-35","6":"r21"},{"1":"1","2":"808.7077","3":"814.7077","4":"148.41297717","5":"3.853515e-34","6":"r14"},{"1":"1","2":"827.4681","3":"833.4681","4":"129.65259808","5":"4.881554e-30","6":"r32"},{"1":"1","2":"849.7753","3":"855.7753","4":"107.34537171","5":"3.739741e-25","6":"r30"},{"1":"1","2":"859.5723","3":"865.5723","4":"97.54842247","5":"5.255521e-23","6":"r8"},{"1":"1","2":"865.1162","3":"871.1162","4":"92.00450830","5":"8.647924e-22","6":"r22"},{"1":"1","2":"867.9351","3":"873.9351","4":"89.18563643","5":"3.594493e-21","6":"r18"},{"1":"1","2":"872.8613","3":"878.8613","4":"84.25936934","5":"4.339421e-20","6":"r24"},{"1":"1","2":"879.5250","3":"885.5250","4":"77.59569985","5":"1.264451e-18","6":"r12"},{"1":"1","2":"881.8596","3":"887.8596","4":"75.26106459","5":"4.124127e-18","6":"r28"},{"1":"1","2":"887.3773","3":"893.3773","4":"69.74343381","5":"6.754232e-17","6":"r3"},{"1":"1","2":"888.1494","3":"894.1494","4":"68.97128628","5":"9.990749e-17","6":"r5"},{"1":"1","2":"890.2218","3":"896.2218","4":"66.89894831","5":"2.857873e-16","6":"r2"},{"1":"1","2":"890.6350","3":"896.6350","4":"66.48571485","5":"3.524385e-16","6":"r4"},{"1":"1","2":"892.1319","3":"898.1319","4":"64.98884361","5":"7.532331e-16","6":"r11"},{"1":"1","2":"892.7739","3":"898.7739","4":"64.34684801","5":"1.043352e-15","6":"r17"},{"1":"1","2":"898.5168","3":"904.5168","4":"58.60387026","5":"1.928368e-14","6":"r36"},{"1":"1","2":"921.8019","3":"927.8019","4":"35.31877846","5":"2.799201e-09","6":"r19"},{"1":"1","2":"930.5805","3":"936.5805","4":"26.54018586","5":"2.581126e-07","6":"r6"},{"1":"1","2":"932.1199","3":"938.1199","4":"25.00084555","5":"5.730518e-07","6":"r37"},{"1":"1","2":"957.1058","3":"963.1058","4":"0.01487442","5":"9.029301e-01","6":"r7"},{"1":"NA","2":"957.1207","3":"961.1207","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r21</code> is the most significant variable in the second step (it differs from the article where r32 is selected (p70, the r32 in R is the same as in article (129.65) but r21 and r14 have higher LRT)).</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-45_f225c8d4279f131b6fe7e71050f3d6bf">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>third_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r21), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>third_step <span class="ot">&lt;-</span> third_step <span class="sc">%&gt;%</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(third_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>third_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"714.0901","3":"722.0901","4":"90.1843989","5":"2.169662e-21","6":"r14"},{"1":"1","2":"741.2546","3":"749.2546","4":"63.0199166","5":"2.046270e-15","6":"r5"},{"1":"1","2":"743.7322","3":"751.7322","4":"60.5423015","5":"7.201418e-15","6":"r2"},{"1":"1","2":"744.8597","3":"752.8597","4":"59.4147504","5":"1.277083e-14","6":"r4"},{"1":"1","2":"745.9831","3":"753.9831","4":"58.2913673","5":"2.260338e-14","6":"r3"},{"1":"1","2":"760.8121","3":"768.8121","4":"43.4623736","5":"4.321901e-11","6":"r12"},{"1":"1","2":"764.1126","3":"772.1126","4":"40.1619300","5":"2.337596e-10","6":"r11"},{"1":"1","2":"772.9759","3":"780.9759","4":"31.2986265","5":"2.212361e-08","6":"r8"},{"1":"1","2":"776.5893","3":"784.5893","4":"27.6851525","5":"1.427542e-07","6":"r7"},{"1":"1","2":"792.7920","3":"800.7920","4":"11.4825457","5":"7.025284e-04","6":"r32"},{"1":"1","2":"794.2690","3":"802.2690","4":"10.0055452","5":"1.560696e-03","6":"r28"},{"1":"1","2":"800.5379","3":"808.5379","4":"3.7365549","5":"5.323410e-02","6":"r6"},{"1":"1","2":"801.0543","3":"809.0543","4":"3.2202347","5":"7.273320e-02","6":"r19"},{"1":"1","2":"801.4406","3":"809.4406","4":"2.8339474","5":"9.229126e-02","6":"r17"},{"1":"1","2":"801.5276","3":"809.5276","4":"2.7469463","5":"9.744037e-02","6":"r30"},{"1":"1","2":"802.0295","3":"810.0295","4":"2.2450215","5":"1.340450e-01","6":"r24"},{"1":"1","2":"802.1217","3":"810.1217","4":"2.1528372","5":"1.423067e-01","6":"r36"},{"1":"1","2":"802.6540","3":"810.6540","4":"1.6205439","5":"2.030160e-01","6":"r18"},{"1":"1","2":"803.4456","3":"811.4456","4":"0.8289127","5":"3.625871e-01","6":"r37"},{"1":"1","2":"803.8445","3":"811.8445","4":"0.4299580","5":"5.120095e-01","6":"r22"},{"1":"NA","2":"804.2745","3":"810.2745","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r14</code> is the most significant variable in the third step.</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-46_c9b7b0e0de7e80079d9506af2617cddb">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>fourth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r21 <span class="sc">+</span> r14), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>fourth_step <span class="ot">&lt;-</span> fourth_step <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(fourth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>fourth_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"710.8419","3":"720.8419","4":"3.24820880","5":"0.07150156","6":"r17"},{"1":"1","2":"710.8819","3":"720.8819","4":"3.20817230","5":"0.07327129","6":"r2"},{"1":"1","2":"711.1145","3":"721.1145","4":"2.97555922","5":"0.08453091","6":"r11"},{"1":"1","2":"711.3343","3":"721.3343","4":"2.75583636","5":"0.09690013","6":"r32"},{"1":"1","2":"711.7203","3":"721.7203","4":"2.36982464","5":"0.12370095","6":"r5"},{"1":"1","2":"711.8104","3":"721.8104","4":"2.27968069","5":"0.13107886","6":"r28"},{"1":"1","2":"711.9805","3":"721.9805","4":"2.10960972","5":"0.14637664","6":"r12"},{"1":"1","2":"712.2434","3":"722.2434","4":"1.84666740","5":"0.17417149","6":"r3"},{"1":"1","2":"712.5374","3":"722.5374","4":"1.55273599","5":"0.21273199","6":"r24"},{"1":"1","2":"712.9444","3":"722.9444","4":"1.14565551","5":"0.28446045","6":"r4"},{"1":"1","2":"713.1870","3":"723.1870","4":"0.90308253","5":"0.34195651","6":"r19"},{"1":"1","2":"713.4303","3":"723.4303","4":"0.65975466","5":"0.41664657","6":"r8"},{"1":"1","2":"713.4831","3":"723.4831","4":"0.60704949","5":"0.43590090","6":"r6"},{"1":"1","2":"713.6375","3":"723.6375","4":"0.45257824","5":"0.50111312","6":"r30"},{"1":"1","2":"713.7205","3":"723.7205","4":"0.36955138","5":"0.54324890","6":"r36"},{"1":"1","2":"713.9419","3":"723.9419","4":"0.14818752","5":"0.70027348","6":"r22"},{"1":"1","2":"713.9450","3":"723.9450","4":"0.14506328","5":"0.70329842","6":"r7"},{"1":"1","2":"714.0279","3":"724.0279","4":"0.06216243","5":"0.80311021","6":"r37"},{"1":"1","2":"714.0641","3":"724.0641","4":"0.02600399","5":"0.87189057","6":"r18"},{"1":"NA","2":"714.0901","3":"722.0901","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r17</code> is the most significant variable in the fourth step.</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-47_a5d40790400fee69e91e31ec142f6994">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>fifth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r21 <span class="sc">+</span> r14 <span class="sc">+</span> r17), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>fifth_step <span class="ot">&lt;-</span> fifth_step <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(fifth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>fifth_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"702.5625","3":"714.5625","4":"8.279384396","5":"0.004009772","6":"r24"},{"1":"1","2":"704.1237","3":"716.1237","4":"6.718214279","5":"0.009543313","6":"r28"},{"1":"1","2":"704.1749","3":"716.1749","4":"6.667028444","5":"0.009821281","6":"r32"},{"1":"1","2":"705.1234","3":"717.1234","4":"5.718477444","5":"0.016787282","6":"r11"},{"1":"1","2":"707.4856","3":"719.4856","4":"3.356289226","5":"0.066948768","6":"r12"},{"1":"1","2":"707.5662","3":"719.5662","4":"3.275662109","5":"0.070314549","6":"r2"},{"1":"1","2":"708.5711","3":"720.5711","4":"2.270769104","5":"0.131834463","6":"r5"},{"1":"1","2":"708.7847","3":"720.7847","4":"2.057231060","5":"0.151485222","6":"r3"},{"1":"1","2":"708.9966","3":"720.9966","4":"1.845290732","5":"0.174332105","6":"r18"},{"1":"1","2":"709.0183","3":"721.0183","4":"1.823570233","5":"0.176888889","6":"r19"},{"1":"1","2":"709.2089","3":"721.2089","4":"1.632942619","5":"0.201296526","6":"r30"},{"1":"1","2":"709.3243","3":"721.3243","4":"1.517564052","5":"0.217988497","6":"r36"},{"1":"1","2":"709.7053","3":"721.7053","4":"1.136637440","5":"0.286363976","6":"r4"},{"1":"1","2":"710.0560","3":"722.0560","4":"0.785939981","5":"0.375330616","6":"r37"},{"1":"1","2":"710.7491","3":"722.7491","4":"0.092746778","5":"0.760713814","6":"r7"},{"1":"1","2":"710.7974","3":"722.7974","4":"0.044461550","5":"0.832997238","6":"r8"},{"1":"1","2":"710.8378","3":"722.8378","4":"0.004126971","5":"0.948777930","6":"r6"},{"1":"1","2":"710.8380","3":"722.8380","4":"0.003887266","5":"0.950285747","6":"r22"},{"1":"NA","2":"710.8419","3":"720.8419","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r24</code> is the most significant variable in the fifth step.</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-48_2937e32982d30825059500eaf5e5b8b1">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>sixth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r21 <span class="sc">+</span> r14 <span class="sc">+</span> r17 <span class="sc">+</span> r24), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>sixth_step <span class="ot">&lt;-</span> sixth_step <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(sixth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>sixth_step</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"698.0220","3":"712.0220","4":"4.54052660","5":"0.03310141","6":"r11"},{"1":"1","2":"698.2276","3":"712.2276","4":"4.33495071","5":"0.03733750","6":"r2"},{"1":"1","2":"698.3866","3":"712.3866","4":"4.17586606","5":"0.04100360","6":"r3"},{"1":"1","2":"698.8480","3":"712.8480","4":"3.71455654","5":"0.05393995","6":"r28"},{"1":"1","2":"699.5084","3":"713.5084","4":"3.05410138","5":"0.08053353","6":"r18"},{"1":"1","2":"699.5341","3":"713.5341","4":"3.02835803","5":"0.08182078","6":"r32"},{"1":"1","2":"699.6100","3":"713.6100","4":"2.95253676","5":"0.08574287","6":"r19"},{"1":"1","2":"699.7094","3":"713.7094","4":"2.85313738","5":"0.09119581","6":"r5"},{"1":"1","2":"699.7180","3":"713.7180","4":"2.84445839","5":"0.09168949","6":"r12"},{"1":"1","2":"700.9907","3":"714.9907","4":"1.57185081","5":"0.20993843","6":"r4"},{"1":"1","2":"701.2166","3":"715.2166","4":"1.34592638","5":"0.24599154","6":"r6"},{"1":"1","2":"701.4726","3":"715.4726","4":"1.08986400","5":"0.29650134","6":"r37"},{"1":"1","2":"701.6492","3":"715.6492","4":"0.91327013","5":"0.33924824","6":"r8"},{"1":"1","2":"702.1099","3":"716.1099","4":"0.45263900","5":"0.50108439","6":"r7"},{"1":"1","2":"702.4698","3":"716.4698","4":"0.09274024","5":"0.76072199","6":"r30"},{"1":"1","2":"702.5287","3":"716.5287","4":"0.03381936","5":"0.85409158","6":"r22"},{"1":"1","2":"702.5301","3":"716.5301","4":"0.03240437","5":"0.85714304","6":"r36"},{"1":"NA","2":"702.5625","3":"714.5625","4":"NA","5":"NA","6":"<none>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r11</code> is the most significant variable in the sixth step.</p>
<p>Equivalently the <code>step</code> routine produces the same results:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-49_4e92663828b2537b8597104e99bea1b8">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># perform forward stepwise regression</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>forward_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all), <span class="at">k=</span><span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r21 + r14 + r17 + r24 + r11 + r28 + r36 + 
    r3 + r8 + r32, family = "binomial", data = data_afl)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.3973  -0.3720  -0.0830   0.2497   3.1342  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -11.1573     1.3883  -8.036 9.25e-16 ***
r1           10.3995     1.1853   8.773  &lt; 2e-16 ***
r21           3.9664     1.5931   2.490 0.012787 *  
r14           2.4414     0.6955   3.510 0.000448 ***
r17          36.0464     7.2134   4.997 5.82e-07 ***
r24          -4.1232     2.8366  -1.454 0.146058    
r11           1.4347     0.5289   2.713 0.006677 ** 
r28         -18.1295     6.1484  -2.949 0.003191 ** 
r36           1.5231     0.3888   3.917 8.95e-05 ***
r3            5.4959     1.2741   4.313 1.61e-05 ***
r8           -3.3793     0.9457  -3.573 0.000353 ***
r32          16.5696     6.9327   2.390 0.016846 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  666.58  on 1248  degrees of freedom
AIC: 690.58

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>We now perform manual likelihood-ratio-test-based forward selection with override to converge with Desbois article (i.e.&nbsp;selecting the same variables as in Desbois if R diverge).</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-50_20963f43497159b445cba55b583fd627">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>first_step_article <span class="ot">&lt;-</span> <span class="fu">add1</span>(intercept_only, <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>first_step_article <span class="ot">&lt;-</span> first_step_article <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(first_step_article)) <span class="sc">%&gt;%</span> </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(first_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"957.1207","3":"961.1207","4":"787.9305","5":"2.271029e-173","6":"r1"},{"1":"1","2":"979.8111","3":"983.8111","4":"765.2401","5":"1.948510e-168","6":"r14"},{"1":"1","2":"996.7790","3":"1000.7790","4":"748.2722","5":"9.529992e-165","6":"r21"},{"1":"1","2":"1094.0080","3":"1098.0080","4":"651.0431","5":"1.325113e-143","6":"r4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>r1</code> is the most significant variable in the first step</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-51_5b82c63e74ef39e0179443af5ca252aa">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>second_step_article <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>second_step_article <span class="ot">&lt;-</span> second_step_article <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(second_step_article)) <span class="sc">%&gt;%</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(second_step,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"804.2745","3":"810.2745","4":"152.8462","5":"4.138901e-35","6":"r21"},{"1":"1","2":"808.7077","3":"814.7077","4":"148.4130","5":"3.853515e-34","6":"r14"},{"1":"1","2":"827.4681","3":"833.4681","4":"129.6526","5":"4.881554e-30","6":"r32"},{"1":"1","2":"849.7753","3":"855.7753","4":"107.3454","5":"3.739741e-25","6":"r30"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In the article <code>r32</code> is the most significant variable in the second step: we choose <code>r32</code>instead of <code>r21</code>. We have exactly the same LRT as in the article</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-52_1c2f211158811e32420544157524ec74">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>third_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>third_step <span class="ot">&lt;-</span> third_step <span class="sc">%&gt;%</span> </span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(third_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(third_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"740.8469","3":"748.8469","4":"86.62116","5":"1.314334e-20","6":"r14"},{"1":"1","2":"788.7621","3":"796.7621","4":"38.70599","5":"4.926955e-10","6":"r17"},{"1":"1","2":"789.5328","3":"797.5328","4":"37.93534","5":"7.312855e-10","6":"r8"},{"1":"1","2":"790.3277","3":"798.3277","4":"37.14042","5":"1.099217e-09","6":"r18"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Like in the article <code>r14</code> is the most significant variable in the third step (with same LRT).</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-53_45a7aa9820d4adbf173865a169518ec5">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>fourth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32 <span class="sc">+</span> r14), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>fourth_step <span class="ot">&lt;-</span> fourth_step <span class="sc">%&gt;%</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(fourth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fourth_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"711.0605","3":"721.0605","4":"29.78641","5":"4.823619e-08","6":"r18"},{"1":"1","2":"711.3343","3":"721.3343","4":"29.51268","5":"5.555203e-08","6":"r21"},{"1":"1","2":"711.6341","3":"721.6341","4":"29.21284","5":"6.484792e-08","6":"r17"},{"1":"1","2":"715.2414","3":"725.2414","4":"25.60558","5":"4.188254e-07","6":"r28"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>In the article <code>r17</code> is the most significant variable in the fourth step: : we choose <code>r17</code>instead of <code>r18</code>.</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-54_82c88ef39934775c3a38ea00ac0396f6">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>fifth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32 <span class="sc">+</span> r14 <span class="sc">+</span> r17), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>fifth_step <span class="ot">&lt;-</span> fifth_step <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(fifth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(fifth_step,<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"697.9413","3":"709.9413","4":"13.69282","5":"0.0002152764","6":"r36"},{"1":"1","2":"698.7633","3":"710.7633","4":"12.87077","5":"0.0003337548","6":"r37"},{"1":"1","2":"699.6883","3":"711.6883","4":"11.94582","5":"0.0005477014","6":"r12"},{"1":"1","2":"700.5403","3":"712.5403","4":"11.09382","5":"0.0008661601","6":"r11"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Like in the article <code>r36</code> is the most significant variable in the fifth step (with same LRT)</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-55_ff33d5591ed64398392a76867fb3e0c7">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>sixth_step <span class="ot">&lt;-</span> <span class="fu">add1</span>(<span class="fu">update</span>(intercept_only, <span class="sc">~</span>. <span class="sc">+</span> r1 <span class="sc">+</span> r32 <span class="sc">+</span> r14 <span class="sc">+</span> r17 <span class="sc">+</span> r36), <span class="at">scope =</span> <span class="fu">formula</span>(all), <span class="at">test =</span> <span class="st">"LRT"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>sixth_step <span class="ot">&lt;-</span> sixth_step <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_column</span>(<span class="at">variable=</span><span class="fu">row.names</span>(sixth_step)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="fu">desc</span>(LRT))</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sixth_step, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Deviance"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["AIC"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["LRT"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>Chi)"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["variable"],"name":[6],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"688.8581","3":"702.8581","4":"9.083198","5":"0.002579686","6":"r12"},{"1":"1","2":"689.4065","3":"703.4065","4":"8.534763","5":"0.003484267","6":"r3"},{"1":"1","2":"689.5363","3":"703.5363","4":"8.405035","5":"0.003741833","6":"r11"},{"1":"1","2":"690.5826","3":"704.5826","4":"7.358675","5":"0.006673994","6":"r2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Like in the article <code>r12</code> is the most significant variable in the sixth step (with same LRT). The routine (<code>SPSS</code>) in the article stops with this six variables.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/desbois_forward_stepwise.png" class="img-fluid figure-img" width="350"></p>
</figure>
</div>
<p>R performs automated AIC/BIC based variable selections using (step)</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-56_7b856c31eba09247e9d81ab8d11864f0">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>forward_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all), <span class="at">k=</span><span class="fu">log</span>(<span class="fu">nrow</span>(don_desbois)), <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r21 + r14, family = "binomial", data = data_afl)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-5.0448  -0.4193  -0.1592   0.2440   2.9142  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -5.3243     0.3196 -16.657  &lt; 2e-16 ***
r1            3.9493     0.5754   6.864 6.70e-12 ***
r21           7.3123     0.8965   8.157 3.44e-16 ***
r14           2.5822     0.3113   8.294  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  714.09  on 1256  degrees of freedom
AIC: 722.09

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-57_1f17614238326b37926a5869450523ce">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>backward_aic <span class="ot">&lt;-</span> <span class="fu">step</span>(all, <span class="at">direction=</span><span class="st">'backward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all), <span class="at">k=</span><span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(backward_aic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r3 + r8 + r12 + r14 + r17 + r22 + r28 + 
    r30 + r36 + r37, family = "binomial", data = data_afl %&gt;% 
    select(Y, starts_with("r")))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.4436  -0.3714  -0.0908   0.2350   2.9973  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -9.9854     1.5001  -6.657 2.80e-11 ***
r1           10.2464     1.0700   9.576  &lt; 2e-16 ***
r3            5.3125     1.2413   4.280 1.87e-05 ***
r8           -3.2304     0.9246  -3.494 0.000476 ***
r12           0.9784     0.3746   2.612 0.009001 ** 
r14           2.5304     0.7107   3.560 0.000371 ***
r17          34.7873     5.3459   6.507 7.65e-11 ***
r22           1.8935     0.8032   2.357 0.018404 *  
r28         -12.0852     2.4397  -4.954 7.28e-07 ***
r30           8.0662     3.1521   2.559 0.010497 *  
r36           1.4516     0.3629   4.000 6.34e-05 ***
r37          -1.4783     0.9176  -1.611 0.107190    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  663.66  on 1248  degrees of freedom
AIC: 687.66

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-58_5fd59360c9a7c2203931b52e28d93790">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>backward_bic <span class="ot">&lt;-</span> <span class="fu">step</span>(all, <span class="at">direction=</span><span class="st">'backward'</span>, <span class="at">test =</span> <span class="st">'LRT'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all), <span class="at">k=</span><span class="fu">log</span>(<span class="fu">nrow</span>(don_desbois)), <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(backward_bic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r3 + r8 + r12 + r14 + r17 + r28 + r36, 
    family = "binomial", data = data_afl %&gt;% select(Y, starts_with("r")))

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-4.2778  -0.3745  -0.0943   0.2531   3.1861  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  -9.3068     1.0442  -8.913  &lt; 2e-16 ***
r1            9.1338     0.9539   9.575  &lt; 2e-16 ***
r3            4.0983     1.1739   3.491 0.000481 ***
r8           -2.2337     0.8121  -2.751 0.005949 ** 
r12           1.0991     0.3639   3.020 0.002528 ** 
r14           2.5999     0.7224   3.599 0.000319 ***
r17          31.9448     4.4733   7.141 9.26e-13 ***
r28          -7.8125     1.2101  -6.456 1.08e-10 ***
r36           1.5837     0.2917   5.430 5.65e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.05  on 1259  degrees of freedom
Residual deviance:  673.16  on 1251  degrees of freedom
AIC: 691.16

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-59_094e617c9f3aef1263cc861f026b3214">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#define intercept-only model</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>intercept_only_w <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data=</span>don_desbois_winsorized, <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co">#define model with all predictors</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>all_w <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>don_desbois_winsorized, <span class="at">family=</span><span class="st">"binomial"</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co">#perform forward stepwise regression AIC</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>forward_aic_w <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only_w, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all_w), <span class="at">k=</span><span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="co">#perform forward stepwise regression BIC</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>forward_bic_w <span class="ot">&lt;-</span> <span class="fu">step</span>(intercept_only_w, <span class="at">direction=</span><span class="st">'forward'</span>, <span class="at">scope=</span><span class="fu">formula</span>(all_w), <span class="at">k=</span><span class="fu">log</span>(<span class="fu">nrow</span>(don_desbois_winsorized)), <span class="at">trace =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-60_ce1129ecb4eb6d38c002ede81914b60e">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_aic_w)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Y ~ r1 + r21 + r14 + HECTARE + CNTY + r5 + STATUS + 
    r7 + r6 + AGE + r37 + OWNLAND + r17 + r18 + ToF + r3, family = "binomial", 
    data = don_desbois_winsorized)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.2518  -0.2709  -0.0237   0.1323   3.5926  

Coefficients:
                                          Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                              -4.479203   1.673417  -2.677 0.007436
r1                                       19.699710   3.477155   5.665 1.47e-08
r21                                       7.091515   1.674065   4.236 2.27e-05
r14                                       2.039834   0.565470   3.607 0.000309
HECTARE                                  -0.035654   0.004401  -8.102 5.40e-16
CNTYNord                                 -2.706287   0.435148  -6.219 5.00e-10
CNTYOrne                                 -2.520852   0.493223  -5.111 3.20e-07
CNTYSeine-Maritime                       -0.075642   0.384078  -0.197 0.843872
r5                                      -14.636807   4.246808  -3.447 0.000568
STATUSEntreprise individuelle            -1.287226   0.379712  -3.390 0.000699
r7                                        9.504055   2.028865   4.684 2.81e-06
r6                                       -5.094662   1.698924  -2.999 0.002711
AGE                                       0.047111   0.016565   2.844 0.004455
r37                                      -5.358372   1.632771  -3.282 0.001032
OWNLANDyes                               -0.729304   0.305731  -2.385 0.017059
r17                                      46.935358  12.204133   3.846 0.000120
r18                                     -35.548694  11.641241  -3.054 0.002260
ToFgeneral cropping                      -1.128581   0.381741  -2.956 0.003112
ToFdairy farm                            -0.258623   0.323345  -0.800 0.423805
ToFmixed livestock                       -0.990716   0.626063  -1.582 0.113546
ToFvarious crops and livestock combined  -0.266008   0.768993  -0.346 0.729405
ToFsoilless breeding                      0.973365   1.203540   0.809 0.418658
r3                                        2.998904   1.735381   1.728 0.083971
                                           
(Intercept)                             ** 
r1                                      ***
r21                                     ***
r14                                     ***
HECTARE                                 ***
CNTYNord                                ***
CNTYOrne                                ***
CNTYSeine-Maritime                         
r5                                      ***
STATUSEntreprise individuelle           ***
r7                                      ***
r6                                      ** 
AGE                                     ** 
r37                                     ** 
OWNLANDyes                              *  
r17                                     ***
r18                                     ** 
ToFgeneral cropping                     ** 
ToFdairy farm                              
ToFmixed livestock                         
ToFvarious crops and livestock combined    
ToFsoilless breeding                       
r3                                      .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1745.1  on 1259  degrees of freedom
Residual deviance:  508.9  on 1237  degrees of freedom
AIC: 554.9

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
</section>
<section id="introducing-penalized-logistic-regressions" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="introducing-penalized-logistic-regressions"><span class="header-section-number">4.3</span> Introducing penalized logistic regressions</h2>
<p>As an alternative, penalized regression techniques like the Lasso (Least Absolute Shrinkage and Selection Operator) or to a lesser extent Ridge offer an efficient means of variable selection by introducing a penalty term in the Logistic Regression estimation algorithm. In particular Lasso promotes the sparsity of coefficients and automatically selects relevant predictors while shrinking others to zero.</p>
<p>We remind that to estimate Logistic Regression parameters, we maximized in <span class="math inline">\(\beta\)</span> the log-likelihood:</p>
<p><span class="math display">\[
\ell(Y,\beta)=\log L(Y,\beta) =\sum_{i=1}^n \left(y_i \log(p_{\beta}(x_i))+(1-y_i) \log(1- p_{\beta}(x_i))\right)
\]</span> In the context of penalized Logistic Regression the idea is to minimize in <span class="math inline">\(\beta\)</span>:</p>
<p><span class="math display">\[
-\ell(Y,\beta)+\lambda_2\lVert\beta\rVert_2 + \lambda_1\lVert\beta\rVert_1
\]</span> where <span class="math inline">\(\lambda_1, \lambda_2\)</span> are two constants.</p>
<p>The undelying idea is to constraint or shrink the size of the coefficients estimates.</p>
<p>When <span class="math inline">\(\lambda_1&gt;0, \lambda_2=0\)</span> we are using a Lasso penalty.</p>
<p>When <span class="math inline">\(\lambda_1=0, \lambda_2&gt;0\)</span> we are using a Ridge penalty.</p>
<p>When <span class="math inline">\(\lambda_1&gt;0, \lambda_2&gt;0\)</span> we are using an Elastic Net penalty.</p>
<p>Without entering to much details in this section, Ridge regression does a proportional shrinkage while Lasso truncates the coefficients at zero.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/lasso_classic_graph.png" class="img-fluid figure-img" width="350"></p>
</figure>
</div>
<p>Lasso Ridge using Mixture</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-61_8cddee0f6b39bd1cdf4739d7b4da3ec3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>data_mixture_example <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../1_Scoring_and_Logistic_Regression/data_mixture_example.rds"</span>)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">as.numeric</span>(data_mixture_example<span class="sc">$</span>Y)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">as.matrix</span>(data_mixture_example <span class="sc">%&gt;%</span> <span class="fu">select</span>(x1,x2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Some intuition behind Ridge shrinkage:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-62_36b927dae420cafd849da40a195522d3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, .<span class="dv">05</span>), <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, .<span class="dv">05</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction function used to classify areas on the grid and imply the decision boundary</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>LL  <span class="ot">&lt;-</span> <span class="cf">function</span>(b0, b1, b2){</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span>  <span class="fu">c</span>(b1, b2)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">sum</span>(<span class="sc">-</span>y<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>(b0<span class="sc">+</span>X<span class="sc">%*%</span>beta))) <span class="sc">-</span> </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(b0<span class="sc">+</span>X<span class="sc">%*%</span>beta))))</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>LL_V <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(LL)</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> grid <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">x0=</span> <span class="dv">1</span>, <span class="at">LL =</span> <span class="fu">LL_V</span>(x0, x1, x2))</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>xc <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>yc <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grid) <span class="sc">+</span> </span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> LL, <span class="at">colour =</span> <span class="fu">after_stat</span>(level)), <span class="at">binwidth =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>(<span class="at">option=</span><span class="st">"H"</span>) <span class="sc">+</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"path"</span>,</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">x=</span>xc<span class="sc">+</span>r<span class="sc">*</span><span class="fu">cos</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length.out=</span><span class="dv">100</span>)),</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>             <span class="at">y=</span>yc<span class="sc">+</span>r<span class="sc">*</span><span class="fu">sin</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length.out=</span><span class="dv">100</span>))) <span class="sc">+</span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Some intuition behind Lasso shrinkage:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-63_428f3b5ad242c981774a210bdab1864d">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x1 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, .<span class="dv">05</span>), <span class="at">x2 =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, .<span class="dv">05</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction function used to classify areas on the grid and imply the decision boundary</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>grid <span class="ot">&lt;-</span> grid <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">x0=</span> <span class="dv">1</span>, <span class="at">LL =</span> <span class="fu">LL_V</span>(x0, x1, x2))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(grid) <span class="sc">+</span> </span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_contour</span>(<span class="fu">aes</span>(<span class="at">x =</span> x1, <span class="at">y =</span> x2, <span class="at">z =</span> LL, <span class="at">colour =</span> <span class="fu">after_stat</span>(level)), <span class="at">binwidth =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_viridis_c</span>(<span class="at">option=</span><span class="st">"H"</span>) <span class="sc">+</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x=</span><span class="sc">-</span>h, <span class="at">xend=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">yend=</span>h, <span class="at">col =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x=</span><span class="dv">0</span>, <span class="at">xend=</span>h, <span class="at">y=</span>h, <span class="at">yend=</span><span class="dv">0</span>, <span class="at">col =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x=</span>h, <span class="at">xend=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">yend=</span><span class="sc">-</span>h, <span class="at">col =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">annotate</span>(<span class="st">"segment"</span>, <span class="at">x=</span><span class="dv">0</span>, <span class="at">xend=</span><span class="sc">-</span>h, <span class="at">y=</span><span class="sc">-</span>h, <span class="at">yend=</span><span class="dv">0</span>, <span class="at">col =</span> <span class="st">'black'</span>) <span class="sc">+</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_fixed</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In R the package <code>glmnet</code> implements the Lasso, Ridge and Elastic Net penalties in particular for Logistic Regression:</p>
<p>For example below the lasso “path” of coefficients when increasing <span class="math inline">\(\lambda\)</span> (from right to left).</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-64_5c22b7fbfeea470d7a0e755e17f6dd95">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnetUtils)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span> <span class="fu">pull</span>(Y)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>desbois_lasso <span class="ot">&lt;-</span> glmnetUtils<span class="sc">::</span><span class="fu">glmnet</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>don_desbois, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">alpha=</span><span class="dv">1</span>)</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(desbois_lasso)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># X &lt;- glmnet::makeX(train = don_desbois %&gt;% dplyr::select(-Y), sparse = TRUE)</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="co"># desbois_lasso &lt;- glmnet::cv.glmnet(X, Y, data=don_desbois, family="binomial", alpha=1, type.measure = "auc")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note that the penalized regression solutions are sensitive to the scaling of the inputs, and so one normally standardizes the inputs before solving.</p>
<p>We can visualise for each <span class="math inline">\(\lambda\)</span> the value of coefficients:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-65_36c33233439581aff2442527ca47a823">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>lasso_result <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">as.matrix</span>(<span class="fu">cbind</span>(desbois_lasso<span class="sc">$</span>lambda, <span class="fu">t</span>(desbois_lasso<span class="sc">$</span>beta))))</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lasso_result) <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"lambda"</span>, <span class="fu">row.names</span>(desbois_lasso<span class="sc">$</span>beta))</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>lasso_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["lambda"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["CNTYEure"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["CNTYNord"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["CNTYOrne"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["CNTYSeine-Maritime"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["STATUScompany"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["STATUSEntreprise individuelle"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["HECTARE"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["ToFcereals"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["ToFgeneral cropping"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["ToFdairy farm"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["ToFmixed livestock"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["ToFvarious crops and livestock combined"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["ToFsoilless breeding"],"name":[14],"type":["dbl"],"align":["right"]},{"label":["OWNLANDno"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["OWNLANDyes"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["AGE"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["HARVEST1988"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["HARVEST1989"],"name":[19],"type":["dbl"],"align":["right"]},{"label":["HARVEST1990"],"name":[20],"type":["dbl"],"align":["right"]},{"label":["HARVEST1991"],"name":[21],"type":["dbl"],"align":["right"]},{"label":["HARVEST1992"],"name":[22],"type":["dbl"],"align":["right"]},{"label":["HARVEST1993"],"name":[23],"type":["dbl"],"align":["right"]},{"label":["HARVEST1994"],"name":[24],"type":["dbl"],"align":["right"]},{"label":["r1"],"name":[25],"type":["dbl"],"align":["right"]},{"label":["r2"],"name":[26],"type":["dbl"],"align":["right"]},{"label":["r3"],"name":[27],"type":["dbl"],"align":["right"]},{"label":["r4"],"name":[28],"type":["dbl"],"align":["right"]},{"label":["r5"],"name":[29],"type":["dbl"],"align":["right"]},{"label":["r6"],"name":[30],"type":["dbl"],"align":["right"]},{"label":["r7"],"name":[31],"type":["dbl"],"align":["right"]},{"label":["r8"],"name":[32],"type":["dbl"],"align":["right"]},{"label":["r11"],"name":[33],"type":["dbl"],"align":["right"]},{"label":["r12"],"name":[34],"type":["dbl"],"align":["right"]},{"label":["r14"],"name":[35],"type":["dbl"],"align":["right"]},{"label":["r17"],"name":[36],"type":["dbl"],"align":["right"]},{"label":["r18"],"name":[37],"type":["dbl"],"align":["right"]},{"label":["r19"],"name":[38],"type":["dbl"],"align":["right"]},{"label":["r21"],"name":[39],"type":["dbl"],"align":["right"]},{"label":["r22"],"name":[40],"type":["dbl"],"align":["right"]},{"label":["r24"],"name":[41],"type":["dbl"],"align":["right"]},{"label":["r28"],"name":[42],"type":["dbl"],"align":["right"]},{"label":["r30"],"name":[43],"type":["dbl"],"align":["right"]},{"label":["r32"],"name":[44],"type":["dbl"],"align":["right"]},{"label":["r36"],"name":[45],"type":["dbl"],"align":["right"]},{"label":["r37"],"name":[46],"type":["dbl"],"align":["right"]}],"data":[{"1":"3.236502e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"0.0000000","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.00000000","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"0.00000000","45":"0.00000000","46":"0.00000000"},{"1":"2.948980e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"0.3384439","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.00864236","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"0.00000000","45":"0.00000000","46":"0.00000000"},{"1":"2.687001e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"0.5435439","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.10365964","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"0.00000000","45":"0.00000000","46":"0.00000000"},{"1":"2.448295e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"0.7491246","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.19180505","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"0.00000000","45":"0.00000000","46":"0.00000000"},{"1":"2.230795e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"0.9327815","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.26581907","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-0.16484138","45":"0.00000000","46":"0.00000000"},{"1":"2.032617e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.0871064","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.32590159","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-0.52321756","45":"0.00000000","46":"0.00000000"},{"1":"1.852045e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.2400694","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.38518138","36":"0.0000000","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-0.86035021","45":"0.00000000","46":"0.00000000"},{"1":"1.687515e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.3759961","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.44271394","36":"0.0000000","37":"0.1980249","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-1.15047916","45":"0.00000000","46":"0.00000000"},{"1":"1.537601e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.4942556","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.49901592","36":"0.0000000","37":"0.5911896","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-1.39898243","45":"0.00000000","46":"0.00000000"},{"1":"1.401004e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.6090534","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.55573233","36":"0.0000000","37":"0.9943931","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-1.63638316","45":"0.00000000","46":"0.00000000"},{"1":"1.276543e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.7203937","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.61294348","36":"0.0000000","37":"1.4085286","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-1.86404637","45":"0.00000000","46":"0.00000000"},{"1":"1.163138e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.8282791","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.67067862","36":"0.0000000","37":"1.8340478","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-2.08299867","45":"0.00000000","46":"0.00000000"},{"1":"1.059808e-01","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"1.9327482","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.72893008","36":"0.0000000","37":"2.2708359","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-2.29403400","45":"0.00000000","46":"0.00000000"},{"1":"9.656580e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.0338113","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.78766233","36":"0.0000000","37":"2.7186664","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-2.49775616","45":"0.00000000","46":"0.00000000"},{"1":"8.798716e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.1315407","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.84681052","36":"0.0000000","37":"3.1767502","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-2.69465376","45":"0.00000000","46":"0.00000000"},{"1":"8.017062e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"0.0000000000","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.2260044","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.90628653","36":"0.0000000","37":"3.6441510","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-2.88510869","45":"0.00000000","46":"0.00000000"},{"1":"7.304848e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0007519289","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.3070920","26":"0.000000e+00","27":"0.0000000","28":"0.00000000","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"0.96604018","36":"0.0000000","37":"4.1888273","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.02145401","45":"0.00000000","46":"0.00000000"},{"1":"6.655906e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0016529654","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.3771651","26":"0.000000e+00","27":"0.0000000","28":"0.02530474","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.02132293","36":"0.0000000","37":"4.7752162","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.14043415","45":"0.00000000","46":"0.00000000"},{"1":"6.064614e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0025506707","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.4247744","26":"0.000000e+00","27":"0.0000000","28":"0.12871294","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.06148105","36":"0.0000000","37":"5.4291170","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.24607491","45":"0.00000000","46":"0.00000000"},{"1":"5.525850e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0034236996","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.4703846","26":"0.000000e+00","27":"0.0000000","28":"0.23164593","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.10165789","36":"0.0000000","37":"6.0910154","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.34959218","45":"0.00000000","46":"0.00000000"},{"1":"5.034949e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0042739396","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.5138271","26":"0.000000e+00","27":"0.0000000","28":"0.33494173","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.14156298","36":"0.0000000","37":"6.7595831","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.45091197","45":"0.00000000","46":"0.00000000"},{"1":"4.587658e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0051019991","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.5554583","26":"0.000000e+00","27":"0.0000000","28":"0.43755913","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.18126451","36":"0.0000000","37":"7.4315049","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.55022397","45":"0.00000000","46":"0.00000000"},{"1":"4.180103e-02","2":"0.00000000","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0059082513","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.5954787","26":"0.000000e+00","27":"0.0000000","28":"0.53899574","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.22072112","36":"0.0000000","37":"8.1038195","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.64759567","45":"0.00000000","46":"0.00000000"},{"1":"3.808754e-02","2":"0.07144747","3":"0.00000000","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0069139499","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.6273000","26":"0.000000e+00","27":"0.0000000","28":"0.68134904","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.25943889","36":"0.0000000","37":"8.6260431","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.75693318","45":"0.00000000","46":"0.00000000"},{"1":"3.470395e-02","2":"0.14264533","3":"-0.01638696","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0079243527","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.6683850","26":"0.000000e+00","27":"0.0000000","28":"0.83125192","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.29331186","36":"0.0000000","37":"9.0921882","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.87106280","45":"0.00000000","46":"0.00000000"},{"1":"3.162095e-02","2":"0.19875594","3":"-0.06309381","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0089248636","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.7374460","26":"0.000000e+00","27":"0.0000000","28":"0.98752108","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.31743369","36":"0.1854041","37":"9.3940306","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-3.99412400","45":"0.00000000","46":"0.00000000"},{"1":"2.881183e-02","2":"0.25179533","3":"-0.10792967","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0099010166","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.8105389","26":"0.000000e+00","27":"0.0000000","28":"1.14050115","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.34143447","36":"0.4954780","37":"9.6329641","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.11693015","45":"0.00000000","46":"0.00000000"},{"1":"2.625226e-02","2":"0.30229970","3":"-0.15205495","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0108519492","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.000000000","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.8834011","26":"0.000000e+00","27":"0.0000000","28":"1.29175255","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.36512611","36":"0.7951635","37":"9.8720049","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.23757852","45":"0.00000000","46":"0.00000000"},{"1":"2.392009e-02","2":"0.34969459","3":"-0.19474031","4":"0.00000000","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0117754112","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.003771007","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"2.9565039","26":"0.000000e+00","27":"0.0000000","28":"1.43854688","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.38887893","36":"1.0846842","37":"10.1087219","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.35637575","45":"0.00000000","46":"0.00000000"},{"1":"2.179509e-02","2":"0.37684463","3":"-0.24630289","4":"-0.02728142","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0126427280","9":"0.00000000","10":"0.00000000","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.027768156","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"3.0333189","26":"0.000000e+00","27":"0.0000000","28":"1.56473783","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.41211244","36":"1.3045958","37":"10.4162077","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.46644706","45":"0.00000000","46":"0.00000000"},{"1":"1.985888e-02","2":"0.36631331","3":"-0.32209983","4":"-0.10465734","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0134283154","9":"0.00000000","10":"-0.03834344","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.041527966","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"3.1107984","26":"0.000000e+00","27":"0.0000000","28":"1.65148982","29":"0.0000000","30":"0.0000000000","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.43974187","36":"1.3666235","37":"10.8430175","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.56631005","45":"0.00000000","46":"0.00000000"},{"1":"1.809467e-02","2":"0.35099604","3":"-0.39956039","4":"-0.18229786","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0141952505","9":"0.00000000","10":"-0.08096777","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.054013849","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"0.000000000","23":"0.000000000","24":"0.0000000000","25":"3.1646154","26":"0.000000e+00","27":"0.0000000","28":"1.75127238","29":"0.0000000","30":"0.0404742567","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.46475491","36":"1.9151904","37":"10.7847836","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.65895196","45":"0.00000000","46":"0.00000000"},{"1":"1.648719e-02","2":"0.33329210","3":"-0.47383909","4":"-0.25527417","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0149493419","9":"0.00000000","10":"-0.12309587","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.065380918","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"-0.009424194","23":"0.000000000","24":"0.0000000000","25":"3.2019052","26":"0.000000e+00","27":"0.0000000","28":"1.86103260","29":"0.0000000","30":"0.1161111943","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.48743331","36":"2.9543338","37":"10.2677365","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.74677305","45":"0.00000000","46":"0.00000000"},{"1":"1.502251e-02","2":"0.31597902","3":"-0.54237261","4":"-0.32260800","5":"0.000000e+00","6":"0.00000000","7":"0.000000e+00","8":"-0.0156851208","9":"0.00000000","10":"-0.16421945","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.076157252","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"-0.029045639","23":"0.000000000","24":"0.0000000000","25":"3.2389892","26":"0.000000e+00","27":"0.0000000","28":"1.96705176","29":"0.0000000","30":"0.1917341217","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.50973389","36":"3.9858547","37":"9.7445043","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.83542396","45":"0.00000000","46":"0.00000000"},{"1":"1.368795e-02","2":"0.29805930","3":"-0.61119901","4":"-0.38672987","5":"0.000000e+00","6":"0.06058214","7":"-8.127745e-15","8":"-0.0166191302","9":"0.00000000","10":"-0.20440750","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.085261525","19":"0.00000000","20":"0.000000e+00","21":"0.00000000","22":"-0.048301481","23":"0.000000000","24":"0.0000000000","25":"3.3318620","26":"0.000000e+00","27":"0.0000000","28":"2.07009800","29":"0.0000000","30":"0.2433831822","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.52513113","36":"5.1846478","37":"9.1840460","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-4.93467997","45":"0.00000000","46":"-0.08305822"},{"1":"1.247195e-02","2":"0.28037975","3":"-0.67034103","4":"-0.44116372","5":"0.000000e+00","6":"0.13152726","7":"-1.422309e-14","8":"-0.0176251121","9":"0.00000000","10":"-0.24490211","11":"0","12":"0.00000000","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0000000000","18":"0.099873318","19":"0.01219596","20":"0.000000e+00","21":"0.00000000","22":"-0.066930930","23":"0.000000000","24":"0.0000000000","25":"3.5095961","26":"0.000000e+00","27":"0.0000000","28":"2.19686820","29":"0.0000000","30":"0.2520587943","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.53567746","36":"6.4928297","37":"8.5000425","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.04860059","45":"0.00000000","46":"-0.27243516"},{"1":"1.136398e-02","2":"0.26598623","3":"-0.72860379","4":"-0.48881636","5":"0.000000e+00","6":"0.20322675","7":"-2.081997e-14","8":"-0.0186054211","9":"0.00000000","10":"-0.28441686","11":"0","12":"-0.02261273","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0009272123","18":"0.115357002","19":"0.02731310","20":"0.000000e+00","21":"0.00000000","22":"-0.085880984","23":"0.000000000","24":"0.0000000000","25":"3.7141200","26":"0.000000e+00","27":"0.0000000","28":"2.31379198","29":"0.0000000","30":"0.2575019933","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.53990181","36":"7.6898932","37":"7.8255986","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.15878670","45":"0.00000000","46":"-0.45919110"},{"1":"1.035443e-02","2":"0.25342798","3":"-0.79060351","4":"-0.53002425","5":"0.000000e+00","6":"0.28350678","7":"-3.404900e-14","8":"-0.0195446175","9":"0.00000000","10":"-0.32733218","11":"0","12":"-0.09618390","13":"0.000000000","14":"0.0000000000","15":"0.000000000","16":"0.000000e+00","17":"0.0032457156","18":"0.128816164","19":"0.04048724","20":"0.000000e+00","21":"0.00000000","22":"-0.104159327","23":"0.000000000","24":"0.0000000000","25":"4.0500595","26":"0.000000e+00","27":"0.0000000","28":"2.51962107","29":"0.0000000","30":"0.2168714827","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.49720506","36":"8.8669315","37":"7.0376954","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.26275773","45":"0.06028554","46":"-0.61561280"},{"1":"9.434575e-03","2":"0.24235688","3":"-0.84981698","4":"-0.57098441","5":"0.000000e+00","6":"0.35883266","7":"-4.431831e-14","8":"-0.0204491348","9":"0.00000000","10":"-0.36874164","11":"0","12":"-0.16618316","13":"0.000000000","14":"0.0000000000","15":"0.004192836","16":"-1.846722e-15","17":"0.0054720127","18":"0.141145309","19":"0.05293948","20":"0.000000e+00","21":"0.00000000","22":"-0.122879754","23":"-0.003858045","24":"0.0000000000","25":"4.3954330","26":"0.000000e+00","27":"0.0000000","28":"2.74565988","29":"0.0000000","30":"0.1646443355","31":"0.0000000","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.44780991","36":"9.9427353","37":"6.3333767","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.36697434","45":"0.12817054","46":"-0.76670036"},{"1":"8.596433e-03","2":"0.23486950","3":"-0.89656542","4":"-0.62634704","5":"0.000000e+00","6":"0.42000011","7":"-6.066261e-14","8":"-0.0212314775","9":"0.00000000","10":"-0.40728871","11":"0","12":"-0.23010239","13":"0.000000000","14":"0.0000000000","15":"0.046051432","16":"-7.930803e-15","17":"0.0074451910","18":"0.151723074","19":"0.06618315","20":"0.000000e+00","21":"0.00000000","22":"-0.151182537","23":"-0.039706651","24":"0.0000000000","25":"4.8575965","26":"0.000000e+00","27":"0.3018614","28":"2.79179644","29":"0.0000000","30":"0.0012951672","31":"0.1934853","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.38447744","36":"11.8117688","37":"5.0102370","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.45720704","45":"0.21516849","46":"-0.93824494"},{"1":"7.832750e-03","2":"0.22761514","3":"-0.94654959","4":"-0.67657396","5":"0.000000e+00","6":"0.48239146","7":"-7.238175e-14","8":"-0.0220201169","9":"0.00000000","10":"-0.44247292","11":"0","12":"-0.29967531","13":"0.000000000","14":"0.0000000000","15":"0.081491088","16":"-1.112276e-14","17":"0.0093981494","18":"0.161343912","19":"0.07835737","20":"0.000000e+00","21":"0.00000000","22":"-0.182582531","23":"-0.073047814","24":"0.0000000000","25":"5.1560656","26":"0.000000e+00","27":"0.5830130","28":"2.73340674","29":"0.0000000","30":"0.0000000000","31":"0.3368049","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.34366577","36":"14.2952146","37":"3.1484144","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.53125790","45":"0.26110505","46":"-1.03376067"},{"1":"7.136910e-03","2":"0.22019799","3":"-0.99541340","4":"-0.72505917","5":"0.000000e+00","6":"0.54253237","7":"-8.192968e-14","8":"-0.0227904805","9":"0.00000000","10":"-0.47690538","11":"0","12":"-0.36741712","13":"0.000000000","14":"0.0000000000","15":"0.115241945","16":"-1.554263e-14","17":"0.0113200592","18":"0.170411502","19":"0.08991412","20":"0.000000e+00","21":"0.00000000","22":"-0.213181027","23":"-0.105150719","24":"0.0000000000","25":"5.4833828","26":"0.000000e+00","27":"0.8835513","28":"2.63017669","29":"0.0000000","30":"0.0000000000","31":"0.4746604","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.30277924","36":"16.8328427","37":"1.2207134","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.60591518","45":"0.30896601","46":"-1.13051750"},{"1":"6.502886e-03","2":"0.21308272","3":"-1.04311408","4":"-0.77423464","5":"0.000000e+00","6":"0.59941797","7":"-9.408387e-14","8":"-0.0235339048","9":"0.00000000","10":"-0.51014967","11":"0","12":"-0.43249107","13":"0.000000000","14":"0.0000000000","15":"0.147674755","16":"-1.716636e-14","17":"0.0131354164","18":"0.178512233","19":"0.10050724","20":"0.000000e+00","21":"0.00000000","22":"-0.242865993","23":"-0.135729493","24":"0.0000000000","25":"5.7823956","26":"0.000000e+00","27":"1.1337476","28":"2.53437083","29":"0.0000000","30":"0.0000000000","31":"0.5672219","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.26280392","36":"18.6452420","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.67341513","45":"0.35333807","46":"-1.21320046"},{"1":"5.925188e-03","2":"0.20672492","3":"-1.08927464","4":"-0.82517089","5":"0.000000e+00","6":"0.65206817","7":"-1.005964e-13","8":"-0.0242393240","9":"0.00000000","10":"-0.54184452","11":"0","12":"-0.49461363","13":"0.000000000","14":"0.0000000000","15":"0.179220740","16":"-1.980134e-14","17":"0.0147913112","18":"0.185100578","19":"0.10966949","20":"0.000000e+00","21":"0.00000000","22":"-0.271666333","23":"-0.164626676","24":"0.0000000000","25":"6.0297649","26":"0.000000e+00","27":"1.2801042","28":"2.47333007","29":"0.0000000","30":"0.0000000000","31":"0.5758149","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.22333077","36":"19.2020082","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.73060637","45":"0.39229973","46":"-1.27620724"},{"1":"5.398810e-03","2":"0.20066789","3":"-1.13385898","4":"-0.87425472","5":"0.000000e+00","6":"0.70214350","7":"-1.060162e-13","8":"-0.0249208859","9":"0.00000000","10":"-0.57223644","11":"0","12":"-0.55431417","13":"0.000000000","14":"0.0000000000","15":"0.209416389","16":"-2.434309e-14","17":"0.0163882131","18":"0.191215663","19":"0.11835300","20":"0.000000e+00","21":"0.00000000","22":"-0.299243521","23":"-0.192172060","24":"0.0000000000","25":"6.2635484","26":"0.000000e+00","27":"1.4134421","28":"2.42796982","29":"0.0000000","30":"0.0000000000","31":"0.5845716","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.18586156","36":"19.7361062","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.78725266","45":"0.42976992","46":"-1.33585179"},{"1":"4.919195e-03","2":"0.19493003","3":"-1.17670308","4":"-0.92152741","5":"0.000000e+00","6":"0.74965308","7":"-1.114807e-13","8":"-0.0255772226","9":"0.00000000","10":"-0.60126547","11":"0","12":"-0.61152530","13":"0.000000000","14":"0.0000000000","15":"0.238224154","16":"-2.640526e-14","17":"0.0179192554","18":"0.196939302","19":"0.12660569","20":"0.000000e+00","21":"0.00000000","22":"-0.325558674","23":"-0.218364568","24":"0.0000000000","25":"6.4805860","26":"0.000000e+00","27":"1.5359423","28":"2.39502589","29":"0.0000000","30":"0.0000000000","31":"0.5956750","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.15133812","36":"20.2489756","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.84274446","45":"0.46482073","46":"-1.39162570"},{"1":"4.482187e-03","2":"0.19066564","3":"-1.22085266","4":"-0.96465413","5":"0.000000e+00","6":"0.79424817","7":"-1.168317e-13","8":"-0.0262211089","9":"0.01115570","10":"-0.62419546","11":"0","12":"-0.66240901","13":"0.000000000","14":"0.0000000000","15":"0.265831660","16":"-2.751963e-14","17":"0.0193701325","18":"0.202554665","19":"0.13459006","20":"0.000000e+00","21":"0.00000000","22":"-0.350288340","23":"-0.242966315","24":"0.0000000000","25":"6.6837819","26":"0.000000e+00","27":"1.6508775","28":"2.36208377","29":"0.0000000","30":"0.0000000000","31":"0.6055106","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.12245007","36":"20.7303960","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.90196062","45":"0.49952887","46":"-1.44203399"},{"1":"4.084002e-03","2":"0.18673998","3":"-1.26212632","4":"-1.00025058","5":"0.000000e+00","6":"0.83641102","7":"-1.228318e-13","8":"-0.0268388801","9":"0.02312854","10":"-0.64547432","11":"0","12":"-0.71056757","13":"0.000000000","14":"0.0000000000","15":"0.292165800","16":"-3.018370e-14","17":"0.0207496588","18":"0.207803785","19":"0.14216913","20":"0.000000e+00","21":"-0.01384315","22":"-0.376488475","23":"-0.267649707","24":"0.0000000000","25":"6.8738073","26":"0.000000e+00","27":"1.7568765","28":"2.33660125","29":"0.0000000","30":"0.0000000000","31":"0.6158923","32":"0.000000000","33":"0.0000000","34":"0.0000000000","35":"1.09596975","36":"21.1883522","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"0.0000000","43":"0.0000000","44":"-5.96056971","45":"0.53252125","46":"-1.48929114"},{"1":"3.721191e-03","2":"0.18318193","3":"-1.30060453","4":"-1.03022830","5":"0.000000e+00","6":"0.87622412","7":"-1.253747e-13","8":"-0.0274285760","9":"0.03468923","10":"-0.66567604","11":"0","12":"-0.75638686","13":"0.000000000","14":"0.0000000000","15":"0.317112480","16":"-3.354277e-14","17":"0.0220607646","18":"0.212694897","19":"0.14941902","20":"0.000000e+00","21":"-0.03613824","22":"-0.403076099","23":"-0.292048048","24":"0.0000000000","25":"7.0566622","26":"0.000000e+00","27":"1.8604630","28":"2.31757639","29":"0.0000000","30":"0.0000000000","31":"0.6325225","32":"0.000000000","33":"0.0000000","34":"0.0001693181","35":"1.07169766","36":"21.7385480","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"-0.1270672","43":"0.0000000","44":"-5.89676461","45":"0.56433749","46":"-1.53673856"},{"1":"3.390610e-03","2":"0.18596470","3":"-1.34659743","4":"-1.05621088","5":"0.000000e+00","6":"0.90937019","7":"-1.331262e-13","8":"-0.0279504591","9":"0.03990857","10":"-0.67471427","11":"0","12":"-0.80744045","13":"0.000000000","14":"0.0000000000","15":"0.342485894","16":"-3.834200e-14","17":"0.0234166436","18":"0.213781263","19":"0.15518718","20":"0.000000e+00","21":"-0.05432528","22":"-0.430709255","23":"-0.315625523","24":"0.0000000000","25":"7.4872862","26":"0.000000e+00","27":"2.0317947","28":"2.10075758","29":"0.0000000","30":"0.0000000000","31":"0.6082598","32":"0.000000000","33":"0.0000000","34":"0.1035163639","35":"1.13601627","36":"23.4600421","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.00000000","41":"0.0000000","42":"-1.5540403","43":"0.0000000","44":"-4.64960961","45":"0.64299499","46":"-1.56122340"},{"1":"3.089398e-03","2":"0.18941303","3":"-1.39355038","4":"-1.08177113","5":"0.000000e+00","6":"0.94230806","7":"-1.457236e-13","8":"-0.0284825883","9":"0.04591846","10":"-0.68395830","11":"0","12":"-0.85550925","13":"0.000000000","14":"0.0000000000","15":"0.365680534","16":"-4.445168e-14","17":"0.0247635726","18":"0.214991351","19":"0.16029134","20":"0.000000e+00","21":"-0.07316807","22":"-0.456444908","23":"-0.338653399","24":"0.0000000000","25":"7.8534176","26":"0.000000e+00","27":"2.2014435","28":"1.93300532","29":"0.0000000","30":"0.0000000000","31":"0.6282764","32":"0.000000000","33":"0.0000000","34":"0.1958460415","35":"1.20270204","36":"25.3816348","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.01352014","41":"0.0000000","42":"-3.2375320","43":"0.0000000","44":"-3.11347837","45":"0.70620310","46":"-1.58995686"},{"1":"2.814944e-03","2":"0.19186023","3":"-1.44101607","4":"-1.10549341","5":"0.000000e+00","6":"0.97399907","7":"-1.612692e-13","8":"-0.0289824095","9":"0.05114994","10":"-0.69360578","11":"0","12":"-0.89991353","13":"0.000000000","14":"0.0000000000","15":"0.386381646","16":"-5.072293e-14","17":"0.0260653917","18":"0.215945124","19":"0.16464274","20":"0.000000e+00","21":"-0.09305554","22":"-0.480273053","23":"-0.361064105","24":"0.0000000000","25":"8.1974429","26":"0.000000e+00","27":"2.3547112","28":"1.78882876","29":"0.0000000","30":"0.0000000000","31":"0.6435355","32":"0.000000000","33":"0.0000000","34":"0.2797220955","35":"1.26188874","36":"27.1404498","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.04525297","41":"0.0000000","42":"-4.8504266","43":"0.0000000","44":"-1.59559342","45":"0.76529486","46":"-1.61677039"},{"1":"2.564872e-03","2":"0.19445303","3":"-1.48620877","4":"-1.12826124","5":"0.000000e+00","6":"1.00399818","7":"-1.737180e-13","8":"-0.0294652133","9":"0.05594820","10":"-0.70294713","11":"0","12":"-0.94199469","13":"0.000000000","14":"0.0000000000","15":"0.405914834","16":"-5.194187e-14","17":"0.0273091503","18":"0.216788072","19":"0.16861856","20":"0.000000e+00","21":"-0.11185641","22":"-0.502663436","23":"-0.381981377","24":"0.0000000000","25":"8.5187888","26":"0.000000e+00","27":"2.4965437","28":"1.66026890","29":"0.0000000","30":"0.0000000000","31":"0.6599801","32":"0.000000000","33":"0.0000000","34":"0.3563158548","35":"1.31688647","36":"28.7970644","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.07579598","41":"0.0000000","42":"-6.3624474","43":"0.0000000","44":"-0.17021152","45":"0.81931720","46":"-1.64465030"},{"1":"2.337016e-03","2":"0.19660788","3":"-1.52231876","4":"-1.15181766","5":"0.000000e+00","6":"1.03070311","7":"-1.755743e-13","8":"-0.0299114720","9":"0.05973617","10":"-0.71175716","11":"0","12":"-0.98177995","13":"0.000000000","14":"0.0004861994","15":"0.425773472","16":"-5.387637e-14","17":"0.0283639865","18":"0.219656276","19":"0.17358400","20":"0.000000e+00","21":"-0.12825111","22":"-0.524841721","23":"-0.400783286","24":"0.0000000000","25":"8.7130962","26":"0.000000e+00","27":"2.5569376","28":"1.59693068","29":"0.0000000","30":"0.0000000000","31":"0.6490395","32":"0.000000000","33":"0.0000000","34":"0.4177571662","35":"1.36296738","36":"29.3394755","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.08492886","41":"0.0000000","42":"-6.6389290","43":"0.0000000","44":"0.00000000","45":"0.85373520","46":"-1.64722217"},{"1":"2.129402e-03","2":"0.19803296","3":"-1.55783413","4":"-1.17626077","5":"0.000000e+00","6":"1.05559347","7":"-1.767096e-13","8":"-0.0303272381","9":"0.06204583","10":"-0.72006040","11":"0","12":"-1.02072890","13":"0.000000000","14":"0.0129597687","15":"0.444976927","16":"-5.235821e-14","17":"0.0294240832","18":"0.221626045","19":"0.17751023","20":"0.000000e+00","21":"-0.14247258","22":"-0.546333531","23":"-0.418319415","24":"0.0000000000","25":"8.9453177","26":"0.000000e+00","27":"2.5969359","28":"1.50523982","29":"0.0000000","30":"0.0000000000","31":"0.5999414","32":"0.000000000","33":"0.0000000","34":"0.4817258446","35":"1.40843850","36":"29.6671574","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.09326755","41":"0.0000000","42":"-6.7352636","43":"0.0000000","44":"0.00000000","45":"0.89364252","46":"-1.65218771"},{"1":"1.940232e-03","2":"0.19975029","3":"-1.59081689","4":"-1.19894982","5":"0.000000e+00","6":"1.07892657","7":"-1.792020e-13","8":"-0.0307219276","9":"0.06420290","10":"-0.72780118","11":"0","12":"-1.05729571","13":"0.000000000","14":"0.0253490926","15":"0.463017160","16":"-5.095606e-14","17":"0.0304278259","18":"0.223572515","19":"0.18123220","20":"0.000000e+00","21":"-0.15591899","22":"-0.566592645","23":"-0.434933514","24":"0.0000000000","25":"9.1588462","26":"0.000000e+00","27":"2.6289702","28":"1.43017839","29":"0.0000000","30":"0.0000000000","31":"0.5546658","32":"0.000000000","33":"0.0000000","34":"0.5403206023","35":"1.45028681","36":"29.9729569","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.10121208","41":"0.0000000","42":"-6.8250224","43":"0.0000000","44":"0.00000000","45":"0.93031250","46":"-1.65806085"},{"1":"1.767867e-03","2":"0.20133803","3":"-1.62131692","4":"-1.22040080","5":"0.000000e+00","6":"1.10083971","7":"-1.797005e-13","8":"-0.0310916148","9":"0.06636952","10":"-0.73517611","11":"0","12":"-1.09140917","13":"0.000000000","14":"0.0371325870","15":"0.479975496","16":"-5.141754e-14","17":"0.0313713593","18":"0.225485118","19":"0.18473291","20":"0.000000e+00","21":"-0.16853352","22":"-0.585464034","23":"-0.450543419","24":"0.0000000000","25":"9.3555235","26":"0.000000e+00","27":"2.6587527","28":"1.36440613","29":"0.0000000","30":"0.0000000000","31":"0.5141641","32":"-0.006416945","33":"0.0000000","34":"0.5934575872","35":"1.49064684","36":"30.2530493","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.10936311","41":"0.0000000","42":"-6.9074892","43":"0.0000000","44":"0.00000000","45":"0.96398979","46":"-1.66565954"},{"1":"1.610815e-03","2":"0.20354443","3":"-1.64624658","4":"-1.25820759","5":"0.000000e+00","6":"1.11248992","7":"-1.796998e-13","8":"-0.0313590289","9":"0.06334157","10":"-0.74186123","11":"0","12":"-1.11237463","13":"0.000000000","14":"0.0605332311","15":"0.503827056","16":"-5.126383e-14","17":"0.0323824546","18":"0.227646336","19":"0.18856486","20":"0.000000e+00","21":"-0.16886692","22":"-0.590468169","23":"-0.465461962","24":"0.0000000000","25":"9.5958035","26":"0.000000e+00","27":"2.7463437","28":"1.71086436","29":"0.0000000","30":"0.0000000000","31":"0.4695893","32":"-0.333425764","33":"0.0000000","34":"0.6506505453","35":"1.54260220","36":"30.3438607","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.13432770","41":"0.0000000","42":"-6.9580528","43":"0.0000000","44":"0.00000000","45":"1.01787846","46":"-1.78543224"},{"1":"1.467714e-03","2":"0.20513017","3":"-1.67127541","4":"-1.29380878","5":"0.000000e+00","6":"1.12492319","7":"-1.825253e-13","8":"-0.0316323677","9":"0.06220774","10":"-0.74956178","11":"0","12":"-1.13090622","13":"0.000000000","14":"0.0791566605","15":"0.525781944","16":"-5.155994e-14","17":"0.0333233951","18":"0.230379229","19":"0.19243773","20":"0.000000e+00","21":"-0.17004803","22":"-0.594653950","23":"-0.479194148","24":"0.0000000000","25":"9.7342945","26":"0.000000e+00","27":"2.8133132","28":"2.09564770","29":"0.0000000","30":"0.0000000000","31":"0.4660862","32":"-0.616887931","33":"0.0000000","34":"0.6900713240","35":"1.57996454","36":"30.4207800","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.15945291","41":"0.0000000","42":"-6.9869637","43":"0.0000000","44":"0.00000000","45":"1.05744198","46":"-1.88301740"},{"1":"1.337327e-03","2":"0.20659778","3":"-1.69499525","4":"-1.32711383","5":"0.000000e+00","6":"1.13680525","7":"-1.848437e-13","8":"-0.0318933725","9":"0.06163869","10":"-0.75692999","11":"0","12":"-1.14822648","13":"0.000000000","14":"0.0979766980","15":"0.546230920","16":"-5.090719e-14","17":"0.0341996007","18":"0.233169239","19":"0.19610108","20":"0.000000e+00","21":"-0.17099735","22":"-0.598698217","23":"-0.491910407","24":"0.0000000000","25":"9.8470982","26":"0.000000e+00","27":"2.8756705","28":"2.44973739","29":"0.0000000","30":"0.0000000000","31":"0.4719043","32":"-0.871265827","33":"0.0000000","34":"0.7247574136","35":"1.61484108","36":"30.4956261","37":"0.0000000","38":"0.00000000","39":"0.00000000","40":"0.18325062","41":"0.0000000","42":"-7.0122054","43":"0.0000000","44":"0.00000000","45":"1.09135013","46":"-1.96832272"},{"1":"1.218522e-03","2":"0.20795660","3":"-1.71785094","4":"-1.35932211","5":"0.000000e+00","6":"1.14813489","7":"-1.864479e-13","8":"-0.0321402609","9":"0.06131972","10":"-0.76395656","11":"0","12":"-1.16457495","13":"0.002916146","14":"0.1170363169","15":"0.565381866","16":"-5.164738e-14","17":"0.0350393002","18":"0.235920405","19":"0.19957436","20":"0.000000e+00","21":"-0.17170202","22":"-0.602852199","23":"-0.503995949","24":"0.0000000000","25":"9.9441090","26":"0.000000e+00","27":"2.9344291","28":"2.77817666","29":"0.0000000","30":"0.0000000000","31":"0.4825372","32":"-1.101038379","33":"0.0000000","34":"0.7554725398","35":"1.64543403","36":"30.5632189","37":"0.0000000","38":"-0.00200041","39":"0.00000000","40":"0.20673810","41":"0.0000000","42":"-7.0324019","43":"0.0000000","44":"0.00000000","45":"1.12182684","46":"-2.04345764"},{"1":"1.110272e-03","2":"0.20903938","3":"-1.73306728","4":"-1.39219494","5":"0.000000e+00","6":"1.15622387","7":"-1.890852e-13","8":"-0.0323559475","9":"0.06146110","10":"-0.76806538","11":"0","12":"-1.18415410","13":"0.011866884","14":"0.1596760259","15":"0.583068371","16":"-5.162583e-14","17":"0.0358861139","18":"0.237351835","19":"0.20250900","20":"0.000000e+00","21":"-0.17057167","22":"-0.604638875","23":"-0.517075995","24":"0.0000000000","25":"10.0407064","26":"0.000000e+00","27":"2.9984713","28":"3.09904937","29":"0.0000000","30":"0.0000000000","31":"0.5138410","32":"-1.308955568","33":"0.0000000","34":"0.7851111706","35":"1.67542879","36":"30.9981370","37":"0.0000000","38":"-0.39952022","39":"0.00000000","40":"0.28126897","41":"0.0000000","42":"-6.9227784","43":"0.0000000","44":"0.00000000","45":"1.14941512","46":"-2.12255547"},{"1":"1.011639e-03","2":"0.21004468","3":"-1.75224713","4":"-1.41759788","5":"0.000000e+00","6":"1.16694747","7":"-1.909871e-13","8":"-0.0325863205","9":"0.06381321","10":"-0.77274624","11":"0","12":"-1.20094320","13":"0.013460318","14":"0.2141405946","15":"0.597915910","16":"-5.073073e-14","17":"0.0368709638","18":"0.240056750","19":"0.20563235","20":"0.000000e+00","21":"-0.17120320","22":"-0.605997052","23":"-0.529269402","24":"0.0000000000","25":"10.1423095","26":"0.000000e+00","27":"3.0925217","28":"3.38416516","29":"0.0000000","30":"0.0000000000","31":"0.5980133","32":"-1.473922212","33":"0.0000000","34":"0.8106485106","35":"1.70490573","36":"32.1848922","37":"-0.9632080","38":"-0.71638587","39":"0.00000000","40":"0.36043247","41":"0.0000000","42":"-6.7969812","43":"0.0000000","44":"0.00000000","45":"1.17536049","46":"-2.19958561"},{"1":"9.217673e-04","2":"0.21153161","3":"-1.77169297","4":"-1.43891702","5":"1.265879e-03","6":"1.17856082","7":"-1.928283e-13","8":"-0.0328158748","9":"0.06668774","10":"-0.77774376","11":"0","12":"-1.21641432","13":"0.012717681","14":"0.2687692508","15":"0.611116612","16":"-5.095419e-14","17":"0.0378652529","18":"0.242945107","19":"0.20858257","20":"0.000000e+00","21":"-0.17243794","22":"-0.607279426","23":"-0.540335819","24":"0.0000000000","25":"10.2426398","26":"0.000000e+00","27":"3.1971996","28":"3.63493163","29":"0.0000000","30":"0.0000000000","31":"0.6976305","32":"-1.614065741","33":"0.0000000","34":"0.8333658509","35":"1.73243124","36":"33.5717706","37":"-2.1838822","38":"-1.00524635","39":"0.00000000","40":"0.44028019","41":"0.0000000","42":"-6.6669799","43":"0.0000000","44":"0.00000000","45":"1.19932882","46":"-2.27115093"},{"1":"8.398801e-04","2":"0.21287066","3":"-1.79066972","4":"-1.45848004","5":"3.123778e-03","6":"1.19008526","7":"-1.939304e-13","8":"-0.0330375307","9":"0.06949431","10":"-0.78269911","11":"0","12":"-1.23088624","13":"0.011773265","14":"0.3186717062","15":"0.623333519","16":"-5.059377e-14","17":"0.0388116923","18":"0.245648370","19":"0.21125096","20":"0.000000e+00","21":"-0.17391994","22":"-0.608524451","23":"-0.550462487","24":"0.0000000000","25":"10.3361087","26":"0.000000e+00","27":"3.3011713","28":"3.86705814","29":"0.0000000","30":"0.0000000000","31":"0.7964751","32":"-1.741652421","33":"0.0000000","34":"0.8539311010","35":"1.75696607","36":"34.9167699","37":"-3.3686009","38":"-1.28846455","39":"0.00000000","40":"0.52005970","41":"0.0000000","42":"-6.5352195","43":"0.0000000","44":"0.00000000","45":"1.22178271","46":"-2.33672400"},{"1":"7.652674e-04","2":"0.21472305","3":"-1.80783735","4":"-1.47603070","5":"5.450627e-03","6":"1.20106484","7":"-1.953847e-13","8":"-0.0332478406","9":"0.07203860","10":"-0.78724982","11":"0","12":"-1.24460005","13":"0.010943159","14":"0.3638077706","15":"0.634803674","16":"-5.179709e-14","17":"0.0396961551","18":"0.248197222","19":"0.21374567","20":"0.000000e+00","21":"-0.17542177","22":"-0.610038217","23":"-0.559856094","24":"0.0000000000","25":"10.4254596","26":"0.000000e+00","27":"3.3975648","28":"4.07435035","29":"0.0000000","30":"-0.0006549552","31":"0.8867792","32":"-1.856827769","33":"0.0000000","34":"0.8734082770","35":"1.78034318","36":"36.1473506","37":"-4.4461808","38":"-1.55734514","39":"0.00494296","40":"0.59470005","41":"0.0000000","42":"-6.4103546","43":"0.0000000","44":"0.00000000","45":"1.24252084","46":"-2.39700135"},{"1":"6.972832e-04","2":"0.20697715","3":"-1.83763968","4":"-1.51269642","5":"0.000000e+00","6":"1.20973672","7":"-1.990494e-13","8":"-0.0334820668","9":"0.07793714","10":"-0.79317344","11":"0","12":"-1.24260560","13":"0.008447448","14":"0.4048559803","15":"0.650555098","16":"-5.540730e-14","17":"0.0404490114","18":"0.252165663","19":"0.21668241","20":"0.000000e+00","21":"-0.17209219","22":"-0.606173266","23":"-0.565285938","24":"0.0000000000","25":"10.5845789","26":"0.000000e+00","27":"3.5512521","28":"4.32735586","29":"0.0000000","30":"-0.5080501573","31":"1.4589365","32":"-1.535050150","33":"0.0000000","34":"0.8794817094","35":"1.76740824","36":"37.2114134","37":"-5.9115268","38":"-1.61326509","39":"0.20872712","40":"0.59955549","41":"0.0000000","42":"-6.2335564","43":"0.0000000","44":"0.00000000","45":"1.28950795","46":"-2.47686874"},{"1":"6.353385e-04","2":"0.20749239","3":"-1.85707012","4":"-1.53876378","5":"0.000000e+00","6":"1.21833018","7":"-2.024530e-13","8":"-0.0337011380","9":"0.08226730","10":"-0.79674467","11":"0","12":"-1.24504461","13":"0.007734952","14":"0.4341742862","15":"0.665675784","16":"-5.721195e-14","17":"0.0411454810","18":"0.255751277","19":"0.21964347","20":"0.000000e+00","21":"-0.16792028","22":"-0.605664791","23":"-0.571744279","24":"0.0000000000","25":"10.7227193","26":"0.000000e+00","27":"3.6553485","28":"4.53208619","29":"0.0000000","30":"-0.8687565058","31":"1.8505572","32":"-1.325303174","33":"0.0000000","34":"0.8914000724","35":"1.76418590","36":"37.8689333","37":"-6.8607577","38":"-1.65537462","39":"0.37260275","40":"0.60244905","41":"0.0000000","42":"-6.1061306","43":"0.0000000","44":"0.00000000","45":"1.33002477","46":"-2.53804269"},{"1":"5.788967e-04","2":"0.20789920","3":"-1.87566906","4":"-1.56189795","5":"0.000000e+00","6":"1.22668810","7":"-2.102464e-13","8":"-0.0339045958","9":"0.08596335","10":"-0.79985318","11":"0","12":"-1.24871109","13":"0.006577020","14":"0.4583695335","15":"0.679610107","16":"-6.183343e-14","17":"0.0418230658","18":"0.258732691","19":"0.22213649","20":"0.000000e+00","21":"-0.16370707","22":"-0.605450833","23":"-0.577772128","24":"0.0000000000","25":"10.8422831","26":"0.000000e+00","27":"3.7442371","28":"4.73180854","29":"0.0000000","30":"-1.1390021410","31":"2.1517998","32":"-1.187609780","33":"0.0000000","34":"0.9022707958","35":"1.76049994","36":"38.4877051","37":"-7.7732179","38":"-1.68343462","39":"0.52910068","40":"0.60379226","41":"0.0000000","42":"-5.9886197","43":"0.0000000","44":"0.00000000","45":"1.36620601","46":"-2.59218111"},{"1":"5.274692e-04","2":"0.20821045","3":"-1.89331391","4":"-1.58273589","5":"0.000000e+00","6":"1.23468768","7":"-2.068662e-13","8":"-0.0340939710","9":"0.08915466","10":"-0.80260428","11":"0","12":"-1.25301053","13":"0.005117941","14":"0.4782814633","15":"0.692536209","16":"-5.922231e-14","17":"0.0424735807","18":"0.261257110","19":"0.22428556","20":"0.000000e+00","21":"-0.15959475","22":"-0.605439353","23":"-0.583432254","24":"0.0000000000","25":"10.9486476","26":"0.000000e+00","27":"3.8214776","28":"4.92394448","29":"0.0000000","30":"-1.3486338500","31":"2.3907044","32":"-1.096984902","33":"0.0000000","34":"0.9123582930","35":"1.75666803","36":"39.0616932","37":"-8.6476682","38":"-1.69928161","39":"0.68092135","40":"0.60338479","41":"0.0000000","42":"-5.8791133","43":"0.0000000","44":"0.00000000","45":"1.39901466","46":"-2.64119301"},{"1":"4.806102e-04","2":"0.20845290","3":"-1.90990652","4":"-1.60160632","5":"0.000000e+00","6":"1.24224276","7":"-2.069075e-13","8":"-0.0342697932","9":"0.09192840","10":"-0.80505365","11":"0","12":"-1.25758599","13":"0.003447054","14":"0.4949711258","15":"0.704511665","16":"-5.659499e-14","17":"0.0430915961","18":"0.263420686","19":"0.22615747","20":"0.000000e+00","21":"-0.15566206","22":"-0.605555569","23":"-0.588750298","24":"0.0000000000","25":"11.0445589","26":"0.000000e+00","27":"3.8893952","28":"5.10643904","29":"0.0000000","30":"-1.5147868580","31":"2.5840965","32":"-1.038736337","33":"0.0000000","34":"0.9218663289","35":"1.75314013","36":"39.5940756","37":"-9.4779882","38":"-1.70855776","39":"0.82622787","40":"0.60234166","41":"0.0000000","42":"-5.7767246","43":"0.0000000","44":"0.00000000","45":"1.42885334","46":"-2.68611592"},{"1":"4.379142e-04","2":"0.20863103","3":"-1.93033359","4":"-1.62034970","5":"0.000000e+00","6":"1.24926684","7":"-2.056710e-13","8":"-0.0344330287","9":"0.09446077","10":"-0.80728523","11":"0","12":"-1.26196106","13":"0.001191864","14":"0.5088752400","15":"0.715696064","16":"-5.473248e-14","17":"0.0436755887","18":"0.265330983","19":"0.22784376","20":"0.000000e+00","21":"-0.15021547","22":"-0.601844684","23":"-0.588792321","24":"0.0057410145","25":"11.1319744","26":"0.000000e+00","27":"3.9499519","28":"5.27770579","29":"0.0000000","30":"-1.6523589397","31":"2.7472476","32":"-0.998933072","33":"0.0000000","34":"0.9308515642","35":"1.74987473","36":"40.0934999","37":"-10.2729256","38":"-1.71115505","39":"0.96692444","40":"0.59962759","41":"0.0000000","42":"-5.6821148","43":"0.0000000","44":"0.00000000","45":"1.45628828","46":"-2.72734798"},{"1":"3.990111e-04","2":"0.20952252","3":"-1.95185176","4":"-1.63797440","5":"0.000000e+00","6":"1.25571967","7":"-2.088416e-13","8":"-0.0345844484","9":"0.09678867","10":"-0.80904017","11":"0","12":"-1.26611124","13":"0.000000000","14":"0.5206925106","15":"0.726090795","16":"-5.476034e-14","17":"0.0442245721","18":"0.267232402","19":"0.22958336","20":"0.000000e+00","21":"-0.14414520","22":"-0.595992013","23":"-0.585586913","24":"0.0155417987","25":"11.2121876","26":"0.000000e+00","27":"4.0048303","28":"5.43697414","29":"0.0000000","30":"-1.7690954322","31":"2.8875727","32":"-0.971170282","33":"0.0000000","34":"0.9392366986","35":"1.74660080","36":"40.5600035","37":"-11.0270776","38":"-1.70864589","39":"1.10273327","40":"0.59538305","41":"0.0000000","42":"-5.5952034","43":"0.0000000","44":"0.00000000","45":"1.48154026","46":"-2.76537674"},{"1":"3.635640e-04","2":"0.21017083","3":"-1.96883757","4":"-1.65404821","5":"0.000000e+00","6":"1.26177786","7":"-2.080506e-13","8":"-0.0347293867","9":"0.09887125","10":"-0.81094345","11":"0","12":"-1.26824981","13":"0.000000000","14":"0.5286480762","15":"0.735158769","16":"-5.321584e-14","17":"0.0446784965","18":"0.268525105","19":"0.23103586","20":"0.000000e+00","21":"-0.13945335","22":"-0.592185798","23":"-0.584609026","24":"0.0220294734","25":"11.4923421","26":"0.000000e+00","27":"4.0381267","28":"5.40545320","29":"-0.2544609","30":"-1.8694515414","31":"3.0245998","32":"-0.957990501","33":"0.0000000","34":"0.9420565696","35":"1.73999285","36":"40.9957956","37":"-11.7608898","38":"-1.69117174","39":"1.23360912","40":"0.58815542","41":"0.0000000","42":"-5.5119522","43":"0.0000000","44":"0.00000000","45":"1.50110221","46":"-2.80061503"},{"1":"3.312660e-04","2":"0.21336794","3":"-1.96622143","4":"-1.66930957","5":"0.000000e+00","6":"1.26812161","7":"-2.147781e-13","8":"-0.0349262988","9":"0.10043849","10":"-0.81290282","11":"0","12":"-1.26945194","13":"0.000000000","14":"0.5213919562","15":"0.745267531","16":"-6.063922e-14","17":"0.0450508139","18":"0.269235699","19":"0.23275056","20":"0.000000e+00","21":"-0.13809169","22":"-0.600493230","23":"-0.598991141","24":"0.0117851493","25":"12.3403365","26":"0.000000e+00","27":"4.0475221","28":"4.83092970","29":"-1.1352762","30":"-2.0608870641","31":"3.2607730","32":"-0.874664186","33":"-0.1258327","34":"1.0268038028","35":"1.73855086","36":"41.2766527","37":"-12.6472418","38":"-1.41301669","39":"1.46537503","40":"0.50462666","41":"0.0000000","42":"-5.5670634","43":"0.0000000","44":"0.00000000","45":"1.52120167","46":"-2.82894566"},{"1":"3.018372e-04","2":"0.21776821","3":"-1.95885363","4":"-1.67965826","5":"0.000000e+00","6":"1.27492754","7":"-2.105307e-13","8":"-0.0351254600","9":"0.10042496","10":"-0.81523901","11":"0","12":"-1.27409165","13":"0.000000000","14":"0.5149470311","15":"0.752962626","16":"-5.520613e-14","17":"0.0454329109","18":"0.268663566","19":"0.23396404","20":"0.000000e+00","21":"-0.13913218","22":"-0.609665517","23":"-0.615901592","24":"0.0005927967","25":"13.3079210","26":"0.000000e+00","27":"4.0451117","28":"4.13415276","29":"-2.1319035","30":"-2.1747940654","31":"3.4160146","32":"-0.854382716","33":"-0.3423943","34":"1.1724509577","35":"1.73833806","36":"41.6452865","37":"-13.3630824","38":"-1.28113247","39":"1.60586572","40":"0.46461859","41":"0.0000000","42":"-5.6642787","43":"0.0000000","44":"0.00000000","45":"1.54080647","46":"-2.86023604"},{"1":"2.750229e-04","2":"0.22210450","3":"-1.95952188","4":"-1.69134725","5":"0.000000e+00","6":"1.28123121","7":"-2.015000e-13","8":"-0.0353105719","9":"0.10036510","10":"-0.81730150","11":"0","12":"-1.27858145","13":"0.000000000","14":"0.5098061817","15":"0.759943116","16":"-5.192399e-14","17":"0.0458087326","18":"0.268184779","19":"0.23518191","20":"0.000000e+00","21":"-0.13792369","22":"-0.612153968","23":"-0.624157208","24":"0.0000000000","25":"14.1994140","26":"0.000000e+00","27":"4.0385842","28":"3.49273480","29":"-3.0582351","30":"-2.2568522828","31":"3.5414980","32":"-0.856717327","33":"-0.5369195","34":"1.3041531964","35":"1.74106325","36":"42.0227832","37":"-14.0006742","38":"-1.19844178","39":"1.71852647","40":"0.43793187","41":"0.0000000","42":"-5.7470284","43":"0.0000000","44":"0.00000000","45":"1.55681769","46":"-2.88925918"},{"1":"2.505906e-04","2":"0.22604315","3":"-1.96123830","4":"-1.70263438","5":"0.000000e+00","6":"1.28710182","7":"-2.112184e-13","8":"-0.0354831694","9":"0.10028997","10":"-0.81924655","11":"0","12":"-1.28260732","13":"0.000000000","14":"0.5053249303","15":"0.766393329","16":"-6.088524e-14","17":"0.0461630012","18":"0.267694636","19":"0.23628248","20":"0.000000e+00","21":"-0.13660334","22":"-0.613887338","23":"-0.631121256","24":"0.0000000000","25":"15.0359594","26":"0.000000e+00","27":"4.0312303","28":"2.89024774","29":"-3.9272046","30":"-2.3295006360","31":"3.6545512","32":"-0.862098093","33":"-0.7134830","34":"1.4239054508","35":"1.74394833","36":"42.3721410","37":"-14.5942344","38":"-1.12375121","39":"1.82337293","40":"0.41393654","41":"0.0000000","42":"-5.8205330","43":"0.0000000","44":"0.00000000","45":"1.57150686","46":"-2.91606282"},{"1":"2.283288e-04","2":"0.22968506","3":"-1.96302239","4":"-1.71298846","5":"0.000000e+00","6":"1.29257717","7":"-2.214458e-13","8":"-0.0356427977","9":"0.10023480","10":"-0.82105742","11":"0","12":"-1.28629208","13":"0.000000000","14":"0.5014957078","15":"0.772336490","16":"-6.742320e-14","17":"0.0464931076","18":"0.267236176","19":"0.23730441","20":"0.000000e+00","21":"-0.13551290","22":"-0.615520014","23":"-0.637555288","24":"0.0000000000","25":"15.8108335","26":"0.000000e+00","27":"4.0246357","28":"2.33177196","29":"-4.7294538","30":"-2.3942791631","31":"3.7557095","32":"-0.868630594","33":"-0.8728065","34":"1.5319929033","35":"1.74637712","36":"42.6940038","37":"-15.1455565","38":"-1.05588675","39":"1.92124983","40":"0.39221222","41":"0.0000000","42":"-5.8851796","43":"0.0000000","44":"0.00000000","45":"1.58524565","46":"-2.94083845"},{"1":"2.080447e-04","2":"0.23337611","3":"-1.96456577","4":"-1.72317030","5":"0.000000e+00","6":"1.29712692","7":"-2.190272e-13","8":"-0.0357901035","9":"0.09987794","10":"-0.82290379","11":"0","12":"-1.28881455","13":"0.000000000","14":"0.4970117072","15":"0.778032491","16":"-5.858137e-14","17":"0.0467850378","18":"0.266539651","19":"0.23823065","20":"0.000000e+00","21":"-0.13409707","22":"-0.617014757","23":"-0.643186726","24":"0.0000000000","25":"16.5435143","26":"0.000000e+00","27":"4.0131685","28":"1.80519147","29":"-5.4964398","30":"-2.4510286495","31":"3.8472273","32":"-0.878057334","33":"-1.0279997","34":"1.6372992416","35":"1.74781420","36":"42.9730769","37":"-15.5860769","38":"-0.98912022","39":"1.99580152","40":"0.37197645","41":"0.1187556","42":"-6.0308323","43":"0.0000000","44":"0.00000000","45":"1.59963114","46":"-2.99350437"},{"1":"1.895626e-04","2":"0.23727218","3":"-1.96591682","4":"-1.73289625","5":"0.000000e+00","6":"1.30083058","7":"-2.205824e-13","8":"-0.0359225548","9":"0.09905774","10":"-0.82466861","11":"0","12":"-1.29008439","13":"0.000000000","14":"0.4923665025","15":"0.783164995","16":"-5.636368e-14","17":"0.0470342642","18":"0.265194282","19":"0.23894496","20":"0.000000e+00","21":"-0.13241266","22":"-0.618362390","23":"-0.648152259","24":"0.0000000000","25":"17.2303660","26":"0.000000e+00","27":"3.9975106","28":"1.31396683","29":"-6.2209159","30":"-2.4981598846","31":"3.9262309","32":"-0.890570997","33":"-1.1796724","34":"1.7399413528","35":"1.74779851","36":"43.2175748","37":"-15.8834978","38":"-0.83120590","39":"2.03267388","40":"0.36055492","41":"0.3255215","42":"-6.3542255","43":"0.1154325","44":"0.00000000","45":"1.61334158","46":"-3.06932845"},{"1":"1.727224e-04","2":"0.24099941","3":"-1.96734715","4":"-1.74188672","5":"0.000000e+00","6":"1.30427111","7":"-2.289067e-13","8":"-0.0360432732","9":"0.09822968","10":"-0.82623210","11":"0","12":"-1.29102571","13":"0.000000000","14":"0.4882241228","15":"0.787840320","16":"-6.016913e-14","17":"0.0472630604","18":"0.263668214","19":"0.23954143","20":"0.000000e+00","21":"-0.13098594","22":"-0.619559007","23":"-0.652751826","24":"0.0000000000","25":"17.8716232","26":"0.000000e+00","27":"3.9822170","28":"0.85537848","29":"-6.8956738","30":"-2.5397823149","31":"3.9965824","32":"-0.903406288","33":"-1.3192542","34":"1.8345981261","35":"1.74775304","36":"43.4462838","37":"-16.1397917","38":"-0.62533370","39":"2.05929002","40":"0.35354137","41":"0.5172169","42":"-6.7234676","43":"0.2927179","44":"0.00000000","45":"1.62611963","46":"-3.13999061"},{"1":"1.573782e-04","2":"0.24443593","3":"-1.96889767","4":"-1.75019839","5":"0.000000e+00","6":"1.30743457","7":"-2.332833e-13","8":"-0.0361532288","9":"0.09750534","10":"-0.82766487","11":"0","12":"-1.29173568","13":"0.000000000","14":"0.4844640154","15":"0.792148888","16":"-6.653064e-14","17":"0.0474744963","18":"0.262184683","19":"0.24008011","20":"0.000000e+00","21":"-0.12981225","22":"-0.620629415","23":"-0.656958284","24":"0.0000000000","25":"18.4624411","26":"0.000000e+00","27":"3.9680497","28":"0.43323282","29":"-7.5160939","30":"-2.5770188384","31":"4.0598790","32":"-0.916118179","33":"-1.4449655","34":"1.9199324657","35":"1.74772834","36":"43.6575739","37":"-16.3814273","38":"-0.40867042","39":"2.08457728","40":"0.34715512","41":"0.6930886","42":"-7.0875462","43":"0.4817973","44":"0.00000000","45":"1.63787055","46":"-3.20510578"},{"1":"1.433971e-04","2":"0.24759813","3":"-1.97027759","4":"-1.75790763","5":"0.000000e+00","6":"1.31035551","7":"-2.276515e-13","8":"-0.0362551892","9":"0.09686829","10":"-0.82917737","11":"0","12":"-1.29211235","13":"0.000000000","14":"0.4815644765","15":"0.796094783","16":"-5.993587e-14","17":"0.0476658538","18":"0.260864492","19":"0.24068751","20":"0.000000e+00","21":"-0.12889360","22":"-0.621798409","23":"-0.660878672","24":"0.0000000000","25":"19.0271789","26":"0.000000e+00","27":"3.9536025","28":"0.02275975","29":"-8.1080564","30":"-2.6133119571","31":"4.1196611","32":"-0.924814609","33":"-1.5623250","34":"1.9993754833","35":"1.74753543","36":"43.8448804","37":"-16.6513375","38":"-0.18976202","39":"2.10555017","40":"0.34111232","41":"0.8720293","42":"-7.3942560","43":"0.6738884","44":"-0.06244678","45":"1.64877719","46":"-3.26952924"},{"1":"1.306581e-04","2":"0.25008828","3":"-1.97459460","4":"-1.76382661","5":"9.015757e-04","6":"1.31319883","7":"-2.249145e-13","8":"-0.0363462640","9":"0.09610439","10":"-0.83124185","11":"0","12":"-1.29285521","13":"-0.005624951","14":"0.4889415066","15":"0.800607290","16":"-5.579911e-14","17":"0.0479342288","18":"0.260427380","19":"0.24112935","20":"0.000000e+00","21":"-0.12673377","22":"-0.620726220","23":"-0.663644592","24":"0.0000000000","25":"19.2486994","26":"0.000000e+00","27":"3.9274975","28":"0.00000000","29":"-8.3458862","30":"-2.6321032720","31":"4.1540361","32":"-0.962643415","33":"-1.6227291","34":"2.0407830431","35":"1.74286971","36":"43.9683265","37":"-16.8835450","38":"-0.12984398","39":"2.09788370","40":"0.35834218","41":"1.0148113","42":"-7.4462085","43":"0.7868759","44":"-0.22022699","45":"1.65989560","46":"-3.33222288"},{"1":"1.190508e-04","2":"0.25216533","3":"-1.97759308","4":"-1.76835938","5":"1.729486e-03","6":"1.31545327","7":"-2.255893e-13","8":"-0.0364246559","9":"0.09571584","10":"-0.83315211","11":"0","12":"-1.29273119","13":"-0.012754077","14":"0.4916277651","15":"0.804599420","16":"-5.668503e-14","17":"0.0481417386","18":"0.260371538","19":"0.24171878","20":"0.000000e+00","21":"-0.12516128","22":"-0.619111491","23":"-0.665829021","24":"0.0000000000","25":"19.4066916","26":"0.000000e+00","27":"3.9107738","28":"0.00000000","29":"-8.5337910","30":"-2.6506609502","31":"4.1961659","32":"-0.995097634","33":"-1.6871127","34":"2.0840907599","35":"1.74117534","36":"44.0963715","37":"-17.1599668","38":"-0.05393601","39":"2.08809806","40":"0.37472599","41":"1.1575431","42":"-7.4646366","43":"0.9145646","44":"-0.42730667","45":"1.66745624","46":"-3.38927477"},{"1":"1.084747e-04","2":"0.25461973","3":"-1.98027653","4":"-1.77320899","5":"2.350469e-03","6":"1.31743090","7":"-2.276902e-13","8":"-0.0365097400","9":"0.09511081","10":"-0.83435688","11":"0","12":"-1.29276487","13":"-0.020743765","14":"0.4932546020","15":"0.808941906","16":"-5.700217e-14","17":"0.0483649180","18":"0.260588753","19":"0.24254010","20":"0.000000e+00","21":"-0.12321846","22":"-0.617382902","23":"-0.668331567","24":"0.0000000000","25":"19.5638233","26":"0.000000e+00","27":"3.8924955","28":"0.00000000","29":"-8.7314271","30":"-2.6776376349","31":"4.2523699","32":"-1.021217268","33":"-1.7681282","34":"2.1419123736","35":"1.74454601","36":"44.2289493","37":"-17.4652536","38":"0.00000000","39":"2.07210545","40":"0.39661587","41":"1.3271666","42":"-7.4341224","43":"1.0527515","44":"-0.71126135","45":"1.67521070","46":"-3.44807129"},{"1":"9.883809e-05","2":"0.25665232","3":"-1.98334237","4":"-1.77831644","5":"2.785649e-03","6":"1.31986135","7":"-2.249138e-13","8":"-0.0366027704","9":"0.09436713","10":"-0.83632981","11":"0","12":"-1.29268562","13":"-0.027918295","14":"0.4978208000","15":"0.813075466","16":"-5.732599e-14","17":"0.0486003794","18":"0.260770892","19":"0.24330367","20":"2.682942e-05","21":"-0.12105257","22":"-0.615585900","23":"-0.671092182","24":"-0.0001276613","25":"19.7342553","26":"0.000000e+00","27":"3.8705071","28":"0.00000000","29":"-8.9341203","30":"-2.7194723944","31":"4.3170229","32":"-1.028802926","33":"-1.8758270","34":"2.2140661260","35":"1.73991637","36":"44.3301266","37":"-17.7452949","38":"0.00000000","39":"2.02695091","40":"0.42624168","41":"1.5113467","42":"-7.3153894","43":"1.1536842","44":"-1.07330052","45":"1.68553029","46":"-3.51303702"},{"1":"9.005759e-05","2":"0.25705459","3":"-1.98459160","4":"-1.78452607","5":"1.305041e-03","6":"1.32198641","7":"-2.269123e-13","8":"-0.0366961757","9":"0.09361470","10":"-0.83799319","11":"0","12":"-1.29222429","13":"-0.034983988","14":"0.5023293216","15":"0.817243680","16":"-5.961027e-14","17":"0.0488152562","18":"0.261616965","19":"0.24457989","20":"4.480006e-04","21":"-0.11934145","22":"-0.615264667","23":"-0.676276355","24":"-0.0034448412","25":"19.8937264","26":"0.000000e+00","27":"3.8444365","28":"0.00000000","29":"-9.1415793","30":"-2.7761898753","31":"4.3999543","32":"-1.021897223","33":"-2.0012258","34":"2.2987822467","35":"1.73827946","36":"44.3743524","37":"-18.0125886","38":"0.00000000","39":"1.95922770","40":"0.46173763","41":"1.6947133","42":"-7.1080574","43":"1.2770001","44":"-1.55712806","45":"1.69448948","46":"-3.57172062"},{"1":"8.205712e-05","2":"0.25710054","3":"-1.98554288","4":"-1.78937883","5":"1.002919e-04","6":"1.32422647","7":"-2.291248e-13","8":"-0.0367754009","9":"0.09308621","10":"-0.83960452","11":"0","12":"-1.29213866","13":"-0.040186637","14":"0.5085055136","15":"0.820585302","16":"-6.160639e-14","17":"0.0490026093","18":"0.262064393","19":"0.24539549","20":"4.102786e-04","21":"-0.11862797","22":"-0.616086206","23":"-0.681399367","24":"-0.0068540564","25":"20.0182174","26":"0.000000e+00","27":"3.8286200","28":"0.00000000","29":"-9.2918743","30":"-2.8271260393","31":"4.4691466","32":"-1.006490129","33":"-2.1065688","34":"2.3694847782","35":"1.73470160","36":"44.4320689","37":"-18.2820797","38":"0.00000000","39":"1.89163383","40":"0.49722715","41":"1.8510623","42":"-6.8891229","43":"1.3993166","44":"-2.02515986","45":"1.70350579","46":"-3.62189034"},{"1":"7.476739e-05","2":"0.25815248","3":"-1.98558172","4":"-1.79242934","5":"9.089430e-05","6":"1.32626803","7":"-2.269676e-13","8":"-0.0368431532","9":"0.09273530","10":"-0.84094955","11":"0","12":"-1.29211572","13":"-0.044614100","14":"0.5141708238","15":"0.823415735","16":"-6.357516e-14","17":"0.0491640474","18":"0.262294599","19":"0.24591807","20":"1.810269e-04","21":"-0.11825169","22":"-0.616940337","23":"-0.685791521","24":"-0.0097412130","25":"20.1202263","26":"0.000000e+00","27":"3.8174219","28":"0.00000000","29":"-9.4135834","30":"-2.8699260353","31":"4.5278725","32":"-0.992745702","33":"-2.1934425","34":"2.4279239154","35":"1.73202528","36":"44.4936992","37":"-18.5293093","38":"0.00000000","39":"1.83193274","40":"0.52970437","41":"1.9822439","42":"-6.6906003","43":"1.5114994","44":"-2.43857125","45":"1.71112587","46":"-3.66413941"},{"1":"6.812526e-05","2":"0.25923358","3":"-1.98364526","4":"-1.79400188","5":"2.704724e-05","6":"1.32830777","7":"-2.298207e-13","8":"-0.0369018660","9":"0.09275447","10":"-0.84191256","11":"0","12":"-1.29210122","13":"-0.047750772","14":"0.5177494859","15":"0.825414190","16":"-6.765097e-14","17":"0.0492738341","18":"0.262846787","19":"0.24669806","20":"8.218323e-05","21":"-0.11854360","22":"-0.618725520","23":"-0.690389012","24":"-0.0130127863","25":"20.2430386","26":"0.000000e+00","27":"3.8147066","28":"-0.06827670","29":"-9.5557269","30":"-2.9155693341","31":"4.5901937","32":"-0.962373172","33":"-2.2788573","34":"2.4849076758","35":"1.73140770","36":"44.5617941","37":"-18.7640458","38":"0.00000000","39":"1.76659336","40":"0.56166539","41":"2.0911423","42":"-6.4776884","43":"1.6232153","44":"-2.85634111","45":"1.71647328","46":"-3.69441834"},{"1":"6.207320e-05","2":"0.26035951","3":"-1.98085946","4":"-1.79457203","5":"3.624046e-05","6":"1.33027643","7":"-2.287660e-13","8":"-0.0369501011","9":"0.09289810","10":"-0.84261267","11":"0","12":"-1.29226630","13":"-0.049571790","14":"0.5203115433","15":"0.826609723","16":"-6.295796e-14","17":"0.0493450387","18":"0.263504736","19":"0.24765394","20":"2.549534e-04","21":"-0.11903435","22":"-0.620935281","23":"-0.694314213","24":"-0.0158927053","25":"20.4064407","26":"0.000000e+00","27":"3.8178922","28":"-0.21003713","29":"-9.7330946","30":"-2.9522639445","31":"4.6419920","32":"-0.930607692","33":"-2.3504611","34":"2.5327432344","35":"1.73254840","36":"44.6434683","37":"-18.9726990","38":"0.00000000","39":"1.70302242","40":"0.59052822","41":"2.1889275","42":"-6.2917262","43":"1.7248702","44":"-3.22884354","45":"1.72006712","46":"-3.71940431"},{"1":"5.655879e-05","2":"0.26163579","3":"-1.97671545","4":"-1.79489839","5":"1.650408e-05","6":"1.33233605","7":"-2.283297e-13","8":"-0.0369991393","9":"0.09285724","10":"-0.84332307","11":"0","12":"-1.29212900","13":"-0.050854941","14":"0.5233903344","15":"0.827582283","16":"-6.251447e-14","17":"0.0494094682","18":"0.265010570","19":"0.24957375","20":"1.357212e-03","21":"-0.11910920","22":"-0.623321646","23":"-0.698497973","24":"-0.0191375188","25":"20.6360671","26":"0.000000e+00","27":"3.8162699","28":"-0.41642237","29":"-9.9825698","30":"-2.9918259838","31":"4.6969553","32":"-0.895367889","33":"-2.4231933","34":"2.5812199404","35":"1.73410409","36":"44.7074887","37":"-19.1862076","38":"0.02895674","39":"1.63146122","40":"0.62097925","41":"2.2867592","42":"-6.1009347","43":"1.8568473","44":"-3.63992279","45":"1.72312359","46":"-3.74337373"},{"1":"5.153426e-05","2":"0.26335493","3":"-1.96961753","4":"-1.79514757","5":"1.140561e-05","6":"1.33486940","7":"-2.278875e-13","8":"-0.0370532042","9":"0.09237056","10":"-0.84448958","11":"0","12":"-1.29014992","13":"-0.051977628","14":"0.5294262855","15":"0.828259501","16":"-6.734231e-14","17":"0.0494647455","18":"0.267323652","19":"0.25293943","20":"3.669813e-03","21":"-0.11957748","22":"-0.627113991","23":"-0.704563539","24":"-0.0244040339","25":"21.0482429","26":"0.000000e+00","27":"3.8031817","28":"-0.79484452","29":"-10.4271584","30":"-3.0541002680","31":"4.7764154","32":"-0.837735162","33":"-2.5109515","34":"2.6396745077","35":"1.73665718","36":"44.7404068","37":"-19.6044175","38":"0.33148596","39":"1.53949980","40":"0.65445718","41":"2.3980639","42":"-5.9351506","43":"2.2566376","44":"-4.31937914","45":"1.72617982","46":"-3.76891427"},{"1":"4.695610e-05","2":"0.26468202","3":"-1.96417558","4":"-1.79567749","5":"3.102003e-05","6":"1.33712503","7":"-2.266196e-13","8":"-0.0370949708","9":"0.09200752","10":"-0.84556923","11":"0","12":"-1.28766036","13":"-0.053364103","14":"0.5351959230","15":"0.828864801","16":"-6.247488e-14","17":"0.0495165563","18":"0.269320760","19":"0.25606666","20":"5.920421e-03","21":"-0.12021841","22":"-0.630192351","23":"-0.709509660","24":"-0.0287323819","25":"21.4345467","26":"0.000000e+00","27":"3.7913389","28":"-1.14591247","29":"-10.8388462","30":"-3.1075928968","31":"4.8447167","32":"-0.790905414","33":"-2.5691782","34":"2.6788857111","35":"1.73997819","36":"44.7854539","37":"-20.0932549","38":"0.73971836","39":"1.48210132","40":"0.67744313","41":"2.4715563","42":"-5.8606324","43":"2.7230003","44":"-4.93293463","45":"1.72842737","46":"-3.78708429"},{"1":"4.278465e-05","2":"0.26576583","3":"-1.95980406","4":"-1.79639755","5":"4.734389e-05","6":"1.33918843","7":"-2.339837e-13","8":"-0.0371301189","9":"0.09173010","10":"-0.84659900","11":"0","12":"-1.28503176","13":"-0.054869979","14":"0.5407224949","15":"0.829461670","16":"-6.716684e-14","17":"0.0495676503","18":"0.271178934","19":"0.25905612","20":"8.133729e-03","21":"-0.12083783","22":"-0.632689620","23":"-0.713664646","24":"-0.0323527871","25":"21.7959352","26":"-6.190934e-05","27":"3.7805124","28":"-1.47148657","29":"-11.2210154","30":"-3.1561737313","31":"4.9063844","32":"-0.749889545","33":"-2.6136617","34":"2.7090958497","35":"1.74334280","36":"44.8346838","37":"-20.6032395","38":"1.18073172","39":"1.44305746","40":"0.69458940","41":"2.5263792","42":"-5.8258031","43":"3.2013022","44":"-5.49897919","45":"1.73044215","46":"-3.80160572"},{"1":"3.898378e-05","2":"0.26750413","3":"-1.95681937","4":"-1.79623595","5":"0.000000e+00","6":"1.34083393","7":"-2.319807e-13","8":"-0.0371758419","9":"0.09198242","10":"-0.84753700","11":"0","12":"-1.28288610","13":"-0.056618664","14":"0.5418363773","15":"0.830102209","16":"-6.089713e-14","17":"0.0496662992","18":"0.272836978","19":"0.26157309","20":"9.855557e-03","21":"-0.12198374","22":"-0.635135695","23":"-0.718097914","24":"-0.0369360588","25":"21.9778208","26":"-9.394425e-02","27":"3.7866366","28":"-1.67691396","29":"-11.5237611","30":"-3.1925707484","31":"4.9569082","32":"-0.725698585","33":"-2.6510064","34":"2.7346403614","35":"1.74723025","36":"44.8916528","37":"-21.0929230","38":"1.56634963","39":"1.41941479","40":"0.70898528","41":"2.5664255","42":"-5.8016171","43":"3.6151201","44":"-5.97270689","45":"1.73233518","46":"-3.81309546"},{"1":"3.552057e-05","2":"0.26888958","3":"-1.95386407","4":"-1.79632609","5":"0.000000e+00","6":"1.34242536","7":"-2.350101e-13","8":"-0.0372096423","9":"0.09219971","10":"-0.84835591","11":"0","12":"-1.28019831","13":"-0.058574231","14":"0.5444769626","15":"0.830707778","16":"-6.429684e-14","17":"0.0497238903","18":"0.274342072","19":"0.26406777","20":"1.157227e-02","21":"-0.12291467","22":"-0.636896612","23":"-0.721529523","24":"-0.0402020712","25":"22.2107983","26":"-1.381336e-01","27":"3.7857369","28":"-1.90553806","29":"-11.8243603","30":"-3.2338828602","31":"5.0123205","32":"-0.693769668","33":"-2.6860910","34":"2.7582693039","35":"1.75037590","36":"44.9522559","37":"-21.5900447","38":"2.00456187","39":"1.39547861","40":"0.72153445","41":"2.6015784","42":"-5.8097101","43":"4.0753817","44":"-6.45960504","45":"1.73390678","46":"-3.82257717"},{"1":"3.236502e-05","2":"0.26986110","3":"-1.95166175","4":"-1.79678390","5":"0.000000e+00","6":"1.34389107","7":"-2.404450e-13","8":"-0.0372369820","9":"0.09231701","10":"-0.84913432","11":"0","12":"-1.27792875","13":"-0.060243296","14":"0.5476567695","15":"0.831298441","16":"-6.550062e-14","17":"0.0497754798","18":"0.275677406","19":"0.26628273","20":"1.314192e-02","21":"-0.12356862","22":"-0.638259788","23":"-0.724246106","24":"-0.0426643574","25":"22.4263638","26":"-1.637354e-01","27":"3.7834217","28":"-2.10854871","29":"-12.0816758","30":"-3.2705974114","31":"5.0599825","32":"-0.664832369","33":"-2.7152859","34":"2.7781274973","35":"1.75297265","36":"45.0027401","37":"-22.0273466","38":"2.38885800","39":"1.37529760","40":"0.73242073","41":"2.6327488","42":"-5.8126108","43":"4.4783210","44":"-6.88914587","45":"1.73558090","46":"-3.83133400"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p><code>glmnet</code> also provides an automatic and efficient procedure to select <span class="math inline">\(lambda\)</span> implementing K-fold Cross-Validation (see next paragraph):</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-66_b741e89f031936d9db6f5e5f19719867">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>desbois_lasso_cv <span class="ot">&lt;-</span> glmnetUtils<span class="sc">::</span><span class="fu">cv.glmnet</span>(Y <span class="sc">~</span> ., <span class="at">data=</span>don_desbois, <span class="at">family=</span><span class="st">"binomial"</span>, <span class="at">alpha=</span><span class="dv">1</span>, <span class="at">type.measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>lasso_coeffs <span class="ot">&lt;-</span> <span class="fu">coef</span>(desbois_lasso_cv, <span class="at">s =</span> <span class="st">"lambda.1se"</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">name =</span> lasso_coeffs<span class="sc">@</span>Dimnames[[<span class="dv">1</span>]][lasso_coeffs<span class="sc">@</span>i <span class="sc">+</span> <span class="dv">1</span>], <span class="at">coefficient =</span> lasso_coeffs<span class="sc">@</span>x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["name"],"name":[1],"type":["chr"],"align":["left"]},{"label":["coefficient"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"-2.127806e+00"},{"1":"CNTYEure","2":"2.348695e-01"},{"1":"CNTYNord","2":"-8.965654e-01"},{"1":"CNTYOrne","2":"-6.263470e-01"},{"1":"STATUScompany","2":"4.200001e-01"},{"1":"STATUSEntreprise individuelle","2":"-6.066261e-14"},{"1":"HECTARE","2":"-2.123148e-02"},{"1":"ToFgeneral cropping","2":"-4.072887e-01"},{"1":"ToFmixed livestock","2":"-2.301024e-01"},{"1":"OWNLANDno","2":"4.605143e-02"},{"1":"OWNLANDyes","2":"-7.930803e-15"},{"1":"AGE","2":"7.445191e-03"},{"1":"HARVEST1988","2":"1.517231e-01"},{"1":"HARVEST1989","2":"6.618315e-02"},{"1":"HARVEST1992","2":"-1.511825e-01"},{"1":"HARVEST1993","2":"-3.970665e-02"},{"1":"r1","2":"4.857597e+00"},{"1":"r3","2":"3.018614e-01"},{"1":"r4","2":"2.791796e+00"},{"1":"r6","2":"1.295167e-03"},{"1":"r7","2":"1.934853e-01"},{"1":"r14","2":"1.384477e+00"},{"1":"r17","2":"1.181177e+01"},{"1":"r18","2":"5.010237e+00"},{"1":"r32","2":"-5.457207e+00"},{"1":"r36","2":"2.151685e-01"},{"1":"r37","2":"-9.382449e-01"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="model-assessment" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="model-assessment"><span class="header-section-number">4.4</span> Model assessment</h2>
<p>We have seen in the first lesson that in the context of statistical learning the approach was to estimate a classifier or Score with the best possible Risk or any other metric such as the AUC of a ROC curve. The final goal being to predict unobserved outputs given unobserved inputs having trained a classifier using the data at hands.</p>
<p>To assess how well the classifier or Score will “generalize” to new data, a practical approach is to split the data set into a training set and a test set or validation set. The training set being used to learn the classifier or Score, the validation set to estimate the generalization error of the classifier.</p>
<p>Two principal approaches are used: the Hold-out approach and the K-fold Cross-validation approach.</p>
<section id="hold-out-approach" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="hold-out-approach"><span class="header-section-number">4.4.1</span> Hold-out approach</h3>
<p>It consists in splitting the data set into:</p>
<ul>
<li>a learning or training set used to train the classifier or the Score ;</li>
<li>a validation or test set used to estimate the empirical risk of the classifier or any other metric (ROC curve, AUC).</li>
</ul>
<hr>
<p><strong>Algorithm</strong>: Hold-out approach</p>
<hr>
<ol type="1">
<li>Using a partition training/validation <span class="math inline">\(\{\mathcal T, \mathcal V\}\)</span> of the data set <span class="math inline">\(\mathcal D\)</span>:
<ol type="a">
<li>Fit the classifiers <span class="math inline">\(f_1\cdots,f_m\)</span> on <span class="math inline">\(\mathcal T\)</span></li>
<li>Compute the empirical risk <span class="math inline">\(\hat{\mathrm R}(f) = \frac{1}{n_{\mathcal V}} \sum_i \ell(y_i,f_m(x_i))\)</span> or any other metric on the validation set <span class="math inline">\(\mathcal V\)</span></li>
</ol></li>
<li>Select a single best model <span class="math inline">\(f_{m^*}\)</span> with respect to the empirical risk or metric ******</li>
</ol>
<p>The main drawback using a single split of data is the possible variability of empirical risk, which is more pregnant when the data set size reduces. Against this issue an alternative approach is to repeat this process on multiple splits of the data.</p>
</section>
<section id="k-fold-cross-validation-approach" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="k-fold-cross-validation-approach"><span class="header-section-number">4.4.2</span> K-fold Cross-Validation approach</h3>
<p>It consists in splitting randomly the data set into <span class="math inline">\(K\)</span> blocks of folds then repeating <span class="math inline">\(K\)</span> times the Hold-out approach, each time using a different block as validation set.</p>
<hr>
<p><strong>Algorithm</strong>: K-fold Cross-Validation approach</p>
<hr>
<ol type="1">
<li>Using a random partition in <span class="math inline">\(K\)</span> blocks <span class="math inline">\(\{\mathcal D_1, \cdots,\mathcal D_K\}\)</span> of the data set <span class="math inline">\(\mathcal D\)</span></li>
<li>For <span class="math inline">\(k=1,\cdots,K\)</span>
<ol type="a">
<li><span class="math inline">\(\{\mathcal T_k, \mathcal V_k\}\)</span> with <span class="math inline">\(\mathcal V_k=\mathcal D_k\)</span> and <span class="math inline">\(\mathcal T_k=\mathcal D\setminus\mathcal D_k\)</span></li>
<li>Fit the classifiers <span class="math inline">\(f_1\cdots,f_m\)</span> on <span class="math inline">\(\mathcal T_k\)</span></li>
<li>Compute the empirical risk <span class="math inline">\(\hat{\mathrm R}(f) = \frac{1}{n_{\mathcal V_k}} \sum_i \ell(y_i,f_m(x_i))\)</span> or any other metric on the validation set <span class="math inline">\(\mathcal V_k\)</span></li>
</ol></li>
<li>Select a single best model <span class="math inline">\(f_{m^*}\)</span> using the average empirical risk or metric ******</li>
</ol>
<p>A variant is to first split the data set into a training and validation set. Perform K-fold Cross-Validation on the training set, for example to select some classifier hyper parameter (number of variables or model specification in logistic regression, penalty, etc), then assess the best “optimized” models on the validation set.</p>
<p>Another variant is to repeat the K-fold CV 5 or 10 times to improve the accuracy of the estimated performance and provide and estimate on its variability.</p>
<p>This <a href="https://bradleyboehmke.github.io/HOML/process.html">book chapter</a> gives a practical overview on these methods (how to implement it in R) and also gives references discussing the validity and limitations of the methods.</p>
</section>
</section>
<section id="exercise" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="exercise"><span class="header-section-number">4.5</span> Exercise</h2>
<p>Using the Agriculture Farm Lending data set or R package <code>rsample</code> and inspiring from this <a href="https://bradleyboehmke.github.io/HOML/process.html">book chapter</a>:</p>
<ul>
<li>briefly explore the data set (the full case study is presented in the <code>root,+Directeur+de+la+revue,+351-1336-1-CE.pdf</code>)</li>
</ul>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-67_7b851fe862c03d86935d1c2a013b15eb">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># package used to import spss file</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>don_desbois <span class="ot">&lt;-</span> <span class="fu">read.spss</span>(<span class="st">"../data/Agriculture Farm Lending/desbois.sav"</span>,</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">to.data.frame =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>don_desbois <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">as.factor</span>(<span class="fu">if_else</span>(DIFF<span class="sc">==</span><span class="st">'healthy'</span>, <span class="dv">0</span>, <span class="dv">1</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>DIFF)</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(don_desbois)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,260
Columns: 30
$ CNTY    &lt;fct&gt; Eure, Eure, Eure, Eure, Eure, Eure, Eure, Eure, Eure, Eure, Eu…
$ STATUS  &lt;fct&gt; Entreprise individuelle, Entreprise individuelle, Entreprise i…
$ HECTARE &lt;dbl&gt; 166, 101, 138, 166, 137, 107, 100, 69, 176, 177, 108, 123, 87,…
$ ToF     &lt;fct&gt; cereals, cereals, dairy farm, cereals, mixed livestock, cereal…
$ OWNLAND &lt;fct&gt; yes, no, yes, yes, yes, yes, no, yes, yes, yes, yes, yes, yes,…
$ AGE     &lt;dbl&gt; 35, 35, 42, 50, 33, 45, 34, 30, 44, 39, 40, 40, 40, 52, 49, 44…
$ HARVEST &lt;fct&gt; 1988, 1988, 1988, 1988, 1988, 1988, 1988, 1988, 1988, 1988, 19…
$ r1      &lt;dbl&gt; 0.449, 0.450, 0.332, 0.363, 0.440, 0.306, 0.717, 0.566, 0.145,…
$ r2      &lt;dbl&gt; 0.622, 0.617, 0.819, 0.733, 0.650, 0.755, 0.320, 0.465, 0.881,…
$ r3      &lt;dbl&gt; 0.25500, 0.24110, 0.55680, 0.35960, 0.31420, 0.26350, 0.16280,…
$ r4      &lt;dbl&gt; 0.11450, 0.10840, 0.18510, 0.13050, 0.13820, 0.08055, 0.11680,…
$ r5      &lt;dbl&gt; 0.334, 0.341, 0.147, 0.232, 0.302, 0.225, 0.601, 0.499, 0.115,…
$ r6      &lt;dbl&gt; 0.785, 0.518, 0.700, 0.773, 0.846, 0.709, 0.894, 0.863, 0.439,…
$ r7      &lt;dbl&gt; 0.585, 0.393, 0.310, 0.495, 0.580, 0.523, 0.748, 0.761, 0.348,…
$ r8      &lt;dbl&gt; 0.20020, 0.12500, 0.38950, 0.27790, 0.26580, 0.18700, 0.14550,…
$ r11     &lt;dbl&gt; 0.6628, 0.7098, 0.4142, 0.4661, 0.7715, 0.8178, 0.6598, 0.6619…
$ r12     &lt;dbl&gt; 1.3698, 1.2534, 0.6370, 1.0698, 1.4752, 1.4682, 1.1018, 1.2360…
$ r14     &lt;dbl&gt; 0.23200, 0.14970, 0.48470, 0.37350, 0.25630, 0.18610, 0.18070,…
$ r17     &lt;dbl&gt; 0.0884, 0.0671, 0.0445, 0.0621, 0.0489, 0.0243, 0.0352, 0.0879…
$ r18     &lt;dbl&gt; 0.0694, 0.0348, 0.0311, 0.0480, 0.0414, 0.0173, 0.0315, 0.0758…
$ r19     &lt;dbl&gt; 0.1660, 0.1360, 0.1030, 0.1080, 0.1270, 0.0652, 0.1290, 0.2400…
$ r21     &lt;dbl&gt; 0.1340, 0.0802, 0.0890, 0.0851, 0.0838, 0.0390, 0.0784, 0.1630…
$ r22     &lt;dbl&gt; 0.3219, 0.3133, 0.2945, 0.1909, 0.2567, 0.1472, 0.3211, 0.5170…
$ r24     &lt;dbl&gt; 0.295, 0.365, 0.166, 0.265, 0.257, 0.191, 0.322, 0.305, 0.180,…
$ r28     &lt;dbl&gt; 0.475, 0.434, 0.350, 0.475, 0.475, 0.443, 0.401, 0.464, 0.475,…
$ r30     &lt;dbl&gt; 0.35000, 0.29780, 0.24680, 0.37590, 0.36690, 0.37590, 0.27240,…
$ r32     &lt;dbl&gt; 0.4313, 0.3989, 0.3187, 0.4313, 0.4313, 0.4257, 0.3697, 0.3886…
$ r36     &lt;dbl&gt; 0.886, 0.351, 1.300, 1.385, 0.886, 1.316, 0.441, 0.761, 2.147,…
$ r37     &lt;dbl&gt; 0.572, 0.867, 0.475, 0.470, 0.520, 0.431, 0.803, 0.656, 0.359,…
$ Y       &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</code></pre>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-68_576fd881d36e3e9c8a7936c2777e2308">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>vars_quanti <span class="ot">&lt;-</span> <span class="fu">names</span>(don_desbois <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric))</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var <span class="cf">in</span> vars_quanti){</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">as.name</span>(var)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">ggplot</span>(don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># filter(r17 &lt;0.14) %&gt;% </span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">as.numeric</span>(Y)<span class="sc">-</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x=</span><span class="sc">!!</span> var,<span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.1</span>, <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"binomial"</span>), </span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col =</span> <span class="st">"dodgerblue"</span>))</span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-15.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-17.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-18.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-19.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-20.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-21.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-22.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-23.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-68-24.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>At first sight there seem to be outliers in the financial ratios values (we can deal with that )</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-69_dc6c22178e5da33b7fb356332974e78e">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>don_desbois_winsorized <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(r1<span class="sc">:</span>r37, <span class="sc">~</span> DescTools<span class="sc">::</span><span class="fu">Winsorize</span>(.x , <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.975</span>))))</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>vars_quanti <span class="ot">&lt;-</span> <span class="fu">names</span>(don_desbois_winsorized <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.numeric))</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var <span class="cf">in</span> vars_quanti){</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">as.name</span>(var)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">ggplot</span>(don_desbois_winsorized <span class="sc">%&gt;%</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># filter(r17 &lt;0.14) %&gt;% </span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">as.numeric</span>(Y)<span class="sc">-</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x=</span><span class="sc">!!</span> var,<span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_jitter</span>(<span class="at">height =</span> <span class="fl">0.1</span>, <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>, </span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"binomial"</span>), </span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">col =</span> <span class="st">"dodgerblue"</span>))</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-13.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-14.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-15.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-16.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-17.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-18.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-19.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-20.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-21.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-22.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-23.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-69-24.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-70_b69698106e5adc7c402677c688d8076a">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>vars_quali <span class="ot">&lt;-</span> <span class="fu">names</span>(don_desbois <span class="sc">%&gt;%</span> <span class="fu">select_if</span>(is.factor) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Y))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var <span class="cf">in</span> vars_quali){</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    var <span class="ot">&lt;-</span> <span class="fu">as.name</span>(var)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">ggplot</span>(don_desbois <span class="sc">%&gt;%</span> </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">group_by</span>(<span class="sc">!!</span>var, Y) <span class="sc">%&gt;%</span> </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">summarize</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>                     <span class="fu">ungroup</span>()) <span class="sc">+</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> Y, <span class="at">y =</span> count, <span class="at">fill =</span> <span class="sc">!!</span>var), <span class="at">position=</span><span class="st">"dodge"</span>,<span class="at">stat=</span><span class="st">"identity"</span>))</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-70-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-70-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-70-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-70-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-71_f2664fd55a64f1d66b0388e826a834c4">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>class_width <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>(don_desbois_binned <span class="ot">&lt;-</span> don_desbois <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">r17_bins =</span> <span class="fu">cut</span>(r17, <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.2</span>, class_width),</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">right =</span> <span class="cn">FALSE</span>, <span class="at">dig.lab =</span> <span class="dv">4</span>, <span class="at">include.lowest =</span> <span class="cn">TRUE</span>),</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">min =</span> <span class="fu">floor</span>(r17 <span class="sc">/</span> class_width) <span class="sc">*</span> class_width,</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">max =</span> <span class="fu">if_else</span>(r17 <span class="sc">==</span> <span class="dv">0</span> , <span class="dv">1</span>, </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># customers with 0$ balance should belong to [0, width) class</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>                         <span class="co"># or be excluded</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">ceiling</span>(r17 <span class="sc">/</span> class_width))  <span class="sc">*</span> class_width) <span class="sc">%&gt;%</span> </span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(r17_bins, min, max, Y) <span class="sc">%&gt;%</span> </span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Y, <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="st">`</span><span class="at">0</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Mean(Y)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">round</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="sc">/</span> (<span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="sc">+</span> <span class="st">`</span><span class="at">0</span><span class="st">`</span>), <span class="dv">4</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["r17_bins"],"name":[1],"type":["fct"],"align":["left"]},{"label":["min"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["0"],"name":[4],"type":["int"],"align":["right"]},{"label":["1"],"name":[5],"type":["int"],"align":["right"]},{"label":["Mean(Y)"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"[0,0.01)","2":"0.00","3":"0.01","4":"2","5":"0","6":"0.0000"},{"1":"[0.01,0.02)","2":"0.01","3":"0.02","4":"4","5":"2","6":"0.3333"},{"1":"[0.02,0.03)","2":"0.02","3":"0.03","4":"65","5":"14","6":"0.1772"},{"1":"[0.03,0.04)","2":"0.03","3":"0.03","4":"13","5":"5","6":"0.2778"},{"1":"[0.03,0.04)","2":"0.03","3":"0.04","4":"93","5":"33","6":"0.2619"},{"1":"[0.04,0.05)","2":"0.04","3":"0.04","4":"1","5":"0","6":"0.0000"},{"1":"[0.04,0.05)","2":"0.04","3":"0.05","4":"111","5":"64","6":"0.3657"},{"1":"[0.05,0.06)","2":"0.05","3":"0.05","4":"0","5":"2","6":"1.0000"},{"1":"[0.05,0.06)","2":"0.05","3":"0.06","4":"104","5":"75","6":"0.4190"},{"1":"[0.06,0.07)","2":"0.06","3":"0.06","4":"2","5":"2","6":"0.5000"},{"1":"[0.06,0.07)","2":"0.06","3":"0.07","4":"86","5":"91","6":"0.5141"},{"1":"[0.07,0.08)","2":"0.07","3":"0.08","4":"63","5":"83","6":"0.5685"},{"1":"[0.08,0.09)","2":"0.08","3":"0.08","4":"2","5":"2","6":"0.5000"},{"1":"[0.08,0.09)","2":"0.08","3":"0.09","4":"47","5":"64","6":"0.5766"},{"1":"[0.09,0.1)","2":"0.09","3":"0.10","4":"27","5":"71","6":"0.7245"},{"1":"[0.1,0.11)","2":"0.10","3":"0.10","4":"1","5":"5","6":"0.8333"},{"1":"[0.1,0.11)","2":"0.10","3":"0.11","4":"13","5":"37","6":"0.7400"},{"1":"[0.11,0.12)","2":"0.11","3":"0.11","4":"2","5":"6","6":"0.7500"},{"1":"[0.11,0.12)","2":"0.11","3":"0.12","4":"10","5":"36","6":"0.7826"},{"1":"[0.12,0.13)","2":"0.12","3":"0.13","4":"7","5":"14","6":"0.6667"},{"1":"[0.19,0.2]","2":"0.19","3":"0.20","4":"0","5":"1","6":"1.0000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-72_97da6d9560875a9dbea7062d93132569">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>(default_occurrence <span class="ot">&lt;-</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(don_desbois <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Y =</span> <span class="fu">if_else</span>(Y <span class="sc">==</span> <span class="st">"1"</span>, <span class="dv">1</span>, <span class="dv">0</span>)), <span class="fu">aes</span>(<span class="at">x=</span>r17, <span class="at">y=</span>Y)) <span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_jitter</span>(<span class="at">alpha=</span><span class="fl">0.2</span>, <span class="at">height=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_segment</span>(<span class="at">data =</span> don_desbois_binned,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> min, <span class="at">xend =</span> max, <span class="at">y =</span> <span class="st">`</span><span class="at">Mean(Y)</span><span class="st">`</span>, <span class="at">yend =</span> <span class="st">`</span><span class="at">Mean(Y)</span><span class="st">`</span>),</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">color =</span> <span class="st">'coral'</span>,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">linewidth=</span><span class="fl">1.25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>perform train/test split and evaluate ROC / AUC for some <code>glm()</code> models of your choice (ie choose manually a subset of variables)</li>
</ul>
<p>Simple random sampling (70/30)</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-73_aa282d8520dc788ddd25ef4807aa2da2">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using base R</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1987</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>index_1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(don_desbois), <span class="fu">round</span>(<span class="fu">nrow</span>(don_desbois) <span class="sc">*</span> <span class="fl">0.7</span>))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>train_1 <span class="ot">&lt;-</span> don_desbois[index_1, ]</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>test_1  <span class="ot">&lt;-</span> don_desbois[<span class="sc">-</span>index_1, ]</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co"># table(don_desbois$Y) %&gt;% prop.table()</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co">#        0        1 </span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.518254 0.481746</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a><span class="co"># table(train_1$Y) %&gt;% prop.table()</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co">#         0         1 </span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5136054 0.4863946 </span></span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co"># table(test_1$Y) %&gt;% prop.table()</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a><span class="co">#         0         1 </span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5291005 0.4708995 </span></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Using rsample package</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1987</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>split_1  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(don_desbois, <span class="at">prop =</span> <span class="fl">0.7</span>)</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>train_2  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(split_1)</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>test_2   <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(split_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Here the data set is balanced and train/test using a simple random sampling have a similar distribution.</p>
<p>But in case of imbalance or if we want to control the split we may want to use Stratified sampling:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-74_8015cb20faecaec047b1307e10d039fa">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>split_strat  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">initial_split</span>(don_desbois, <span class="at">prop =</span> <span class="fl">0.7</span>, </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">strata =</span> <span class="st">"Y"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>train_strat  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">training</span>(split_strat)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>test_strat   <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">testing</span>(split_strat)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a><span class="co"># table(don_desbois$Y) %&gt;% prop.table()</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co">#        0        1 </span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.518254 0.481746</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="co"># table(train_strat$Y) %&gt;% prop.table()</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="co">#         0         1 </span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5187287 0.4812713  </span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a><span class="co"># table(test_1$Y) %&gt;% prop.table()</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a><span class="co">#         0         1 </span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.5171504 0.4828496 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-75_e876c10e902a83ffbe297e5bb3e94581">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We use to illustrate the model proposed in the article</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co">#fit logistic regression model</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>model_desbois <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> STATUS <span class="sc">+</span> HECTARE <span class="sc">+</span> r1 <span class="sc">+</span> r3 <span class="sc">+</span> r17 <span class="sc">+</span> r24 <span class="sc">+</span> r28 <span class="sc">+</span> r36,</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> train_strat,</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot ROC / compute AUC for the training set</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>pred_train <span class="ot">&lt;-</span> <span class="fu">prediction</span>(model_desbois<span class="sc">$</span>fitted.values, train_strat<span class="sc">$</span>Y)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>perf_train <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_train, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf_train, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"darkorange"</span>)</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>) <span class="co">#add a 45 degree line</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>auc_train <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_train, <span class="at">measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>auc_train <span class="ot">&lt;-</span> auc_train<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a><span class="co"># auc_train</span></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.9635595</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a><span class="co"># use fitted model to predict value on testing set</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>test_predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_desbois, <span class="at">newdata=</span>test_strat, <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="co"># plot ROC / compute AUC for the training set</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>pred_test <span class="ot">&lt;-</span> <span class="fu">prediction</span>(test_predict, test_strat<span class="sc">$</span>Y)</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>perf_test <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_test, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(perf_test, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">main=</span><span class="st">"ROC curve Admissions"</span>, <span class="at">xlab=</span><span class="st">"Specificity"</span>,</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Sensitivity"</span>, <span class="at">col =</span> <span class="st">"dodgerblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>auc_test <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_test, <span class="at">measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>auc_test <span class="ot">&lt;-</span> auc_test<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>perform k-fold cross validation and for each fold evaluate ROC / AUC for the same models as before</li>
</ul>
<p>Leveraging <code>rsample</code>, the <code>tidyverse</code> and stackoverflow:</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-76_16e16538775be9f99da8248f91b21fca">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1987</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>folds_10  <span class="ot">&lt;-</span> rsample<span class="sc">::</span><span class="fu">vfold_cv</span>(train_strat, <span class="at">v =</span> <span class="dv">10</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>cvfun <span class="ot">&lt;-</span> <span class="cf">function</span>(split, ...){</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> STATUS <span class="sc">+</span> HECTARE <span class="sc">+</span> r1 <span class="sc">+</span> r3 <span class="sc">+</span> r17 <span class="sc">+</span> r24 <span class="sc">+</span> r28 <span class="sc">+</span> r36,</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">data=</span>rsample<span class="sc">::</span><span class="fu">analysis</span>(split),</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">family=</span>binomial)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod, <span class="at">newdata=</span>rsample<span class="sc">::</span><span class="fu">assessment</span>(split), <span class="at">type=</span><span class="st">"response"</span>)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">fit =</span> fit, <span class="at">y =</span> <span class="fu">model.response</span>(<span class="fu">model.frame</span>(<span class="fu">formula</span>(mod), <span class="at">data=</span>rsample<span class="sc">::</span><span class="fu">assessment</span>(split))))</span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>cv_out <span class="ot">&lt;-</span> folds_10 <span class="sc">%&gt;%</span> </span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">fit =</span> purrr<span class="sc">::</span><span class="fu">map</span>(splits, cvfun)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest</span>(fit) <span class="sc">%&gt;%</span> </span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">auc =</span> pROC<span class="sc">::</span><span class="fu">roc</span>(y, fit, <span class="at">plot=</span><span class="cn">FALSE</span>)<span class="sc">$</span>auc[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-77_b2ccbca1cd4340bddc235b0ca69214f6">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># https://stackoverflow.com/questions/66000977/roc-with-cross-validation-for-linear-regression-in-r</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>cv_out_plot <span class="ot">&lt;-</span> folds_10 <span class="sc">%&gt;%</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fit =</span> <span class="fu">map</span>(splits, cvfun)) <span class="sc">%&gt;%</span> </span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(fit) <span class="sc">%&gt;%</span> </span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> </span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sens =</span> pROC<span class="sc">::</span><span class="fu">roc</span>(y, fit, <span class="at">plot=</span><span class="cn">FALSE</span>)<span class="sc">$</span>sensitivities, </span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">spec =</span> pROC<span class="sc">::</span><span class="fu">roc</span>(y, fit, <span class="at">plot=</span><span class="cn">FALSE</span>)<span class="sc">$</span>specificities, </span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">obs =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sens))</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>ave <span class="ot">&lt;-</span> cv_out_plot <span class="sc">%&gt;%</span> </span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  ungroup <span class="sc">%&gt;%</span> </span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(obs) <span class="sc">%&gt;%</span> </span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sens =</span> <span class="fu">mean</span>(sens), </span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">spec =</span> <span class="fu">mean</span>(spec), </span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">id =</span> <span class="st">"Average"</span>)</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>cv_out_plot <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(cv_out_plot, ave) <span class="sc">%&gt;%</span> </span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">col =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(id <span class="sc">==</span> <span class="st">"Average"</span>, <span class="st">"Average"</span>, <span class="st">"Individual"</span>), </span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Individual"</span>, <span class="st">"Average"</span>)))</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cv_out_plot , <span class="fu">aes</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">-</span>sens, <span class="at">y=</span>spec, <span class="at">group=</span>id, <span class="at">colour=</span>col)) <span class="sc">+</span> </span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">size=</span>col, <span class="at">alpha=</span>col)) <span class="sc">+</span> </span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>)) <span class="sc">+</span> </span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values=</span><span class="fu">c</span>(.<span class="dv">5</span>,<span class="fl">1.25</span>)) <span class="sc">+</span> </span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values=</span><span class="fu">c</span>(.<span class="dv">3</span>, <span class="dv">1</span>)) <span class="sc">+</span> </span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> </span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="fu">c</span>(.<span class="dv">75</span>, .<span class="dv">15</span>)) <span class="sc">+</span> </span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"1-Sensitivity"</span>, <span class="at">y=</span><span class="st">"Specificity"</span>, <span class="at">colour=</span><span class="st">""</span>, <span class="at">alpha=</span><span class="st">""</span>, <span class="at">size=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Logistic_Regression_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>k-fold cross validation manually</p>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-78_2e6233026a55ae22cfd45e912986f847">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(1987)</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># res_list &lt;- list()</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># nb_iter &lt;- 2 # Usually 5 x 10 fold validation</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for (j in 1:5) {</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     nb_blocks &lt;- 10 # number of folds/blocks</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     blocks &lt;- sample(rep(1:nb_blocks,nrow(don_desbois))[1:nrow(don_desbois)])</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     result &lt;- data.frame(matrix(nrow=dim(don_desbois),ncol=10))</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     for (i in 1:nb_blocks) {</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co">#           print(i)</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a><span class="co">#           XX_train &lt;- don_desbois[blocks!=i,]</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="co">#           XX_test &lt;- don_desbois[blocks==i,]</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a><span class="co">#           # glm full</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a><span class="co">#           class1 &lt;- glm(Y ~ .,</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="co">#                         data=XX_train,</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a><span class="co">#                         family=binomial)</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a><span class="co">#           # glm desbois</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a><span class="co">#           class2 &lt;- glm(Y ~ r1 + r32 + r14 + r17 + r36 + r12,</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="co">#                         data=XX_train,</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a><span class="co">#                         family=binomial)</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a><span class="co">#           # stepwise methods</span></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a><span class="co">#           intercept_only &lt;- glm(Y ~ 1, data=XX_train, family="binomial")</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="co">#           # forward aic</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a><span class="co">#           class3 &lt;- step(intercept_only, direction='forward', test = 'LRT', scope=formula(class1),</span></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                          k=2, trace = FALSE)</span></span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a><span class="co">#           # forward bic</span></span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a><span class="co">#           class4 &lt;- step(intercept_only, direction='forward', test = 'LRT', scope=formula(class1),</span></span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                          k=log(nrow(don_desbois)), trace = FALSE)</span></span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a><span class="co">#           # backward aic</span></span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a><span class="co">#           class5 &lt;- step(class1, direction='backward', test = 'LRT', scope=formula(class1),</span></span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a><span class="co">#                          k=2, trace = FALSE)</span></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a><span class="co">#           # backward bic</span></span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a><span class="co">#           class6 &lt;- step(class1, direction='backward', test = 'LRT', scope=formula(class1),</span></span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a><span class="co">#                          k=log(nrow(don_desbois)), trace = FALSE)</span></span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a><span class="co">#           # penalized regression</span></span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a><span class="co">#           # ridge</span></span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a><span class="co">#           # class7 &lt;- cv.glmnet(as.matrix(XX_train[,-which(names(XX_train)=="maxO3")]),XX_train$maxO3,alpha=0)</span></span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a><span class="co">#           class7  &lt;- glmnetUtils::cv.glmnet(Y ~ ., data=XX_train, family="binomial", alpha=0, type.measure = "auc")</span></span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a><span class="co">#           # lasso</span></span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a><span class="co">#           # class8 &lt;- cv.glmnet(as.matrix(XX_train[,-which(names(XX_train)=="maxO3")]),XX_train$maxO3,alpha=1)</span></span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a><span class="co">#           class8  &lt;- glmnetUtils::cv.glmnet(Y ~ ., data=XX_train, family="binomial", alpha=1, type.measure = "auc")</span></span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a><span class="co">#           # elastic-net</span></span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a><span class="co">#           # class9 &lt;- cv.glmnet(as.matrix(XX_train[,-which(names(XX_train)=="maxO3")]),XX_train$maxO3,alpha=0.5)</span></span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a><span class="co">#           class9  &lt;- glmnetUtils::cv.glmnet(Y ~ ., data=XX_train, family="binomial", alpha=0.5, type.measure = "auc")</span></span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a><span class="co">#           # cart</span></span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a><span class="co">#           class10 &lt;- rpart::rpart(Y~., data = XX_train, method = "class")</span></span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a><span class="co">#           # saving predictions on test set</span></span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a><span class="co">#           result[blocks==i,1] = predict(class1, newdata=XX_test, type = "response")</span></span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a><span class="co">#           result[blocks==i,2] = predict(class2, newdata=XX_test, type = "response")</span></span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a><span class="co">#           result[blocks==i,3] = predict(class3, newdata=XX_test, type = "response")</span></span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a><span class="co">#           result[blocks==i,4] = predict(class4, newdata=XX_test, type = "response")</span></span>
<span id="cb105-62"><a href="#cb105-62" aria-hidden="true" tabindex="-1"></a><span class="co">#           result[blocks==i,5] = predict(class5, newdata=XX_test, type = "response")</span></span>
<span id="cb105-63"><a href="#cb105-63" aria-hidden="true" tabindex="-1"></a><span class="co">#           result[blocks==i,6] = predict(class6, newdata=XX_test, type = "response")</span></span>
<span id="cb105-64"><a href="#cb105-64" aria-hidden="true" tabindex="-1"></a><span class="co">#           # penalized - glmnet</span></span>
<span id="cb105-65"><a href="#cb105-65" aria-hidden="true" tabindex="-1"></a><span class="co">#           result[blocks==i,7] = as.vector(predict(class7, newdata=XX_test, type = "response"))</span></span>
<span id="cb105-66"><a href="#cb105-66" aria-hidden="true" tabindex="-1"></a><span class="co">#           result[blocks==i,8] = as.vector(predict(class8, newdata=XX_test, type = "response"))</span></span>
<span id="cb105-67"><a href="#cb105-67" aria-hidden="true" tabindex="-1"></a><span class="co">#           result[blocks==i,9] = as.vector(predict(class9, newdata=XX_test, type = "response"))</span></span>
<span id="cb105-68"><a href="#cb105-68" aria-hidden="true" tabindex="-1"></a><span class="co">#           # cart</span></span>
<span id="cb105-69"><a href="#cb105-69" aria-hidden="true" tabindex="-1"></a><span class="co">#           result[blocks==i,10] = predict(class10, newdata=XX_test, type = "prob")[, 2]</span></span>
<span id="cb105-70"><a href="#cb105-70" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-71"><a href="#cb105-71" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb105-72"><a href="#cb105-72" aria-hidden="true" tabindex="-1"></a><span class="co">#     names(result) &lt;- c("glm full",</span></span>
<span id="cb105-73"><a href="#cb105-73" aria-hidden="true" tabindex="-1"></a><span class="co">#                        "glm desbois",</span></span>
<span id="cb105-74"><a href="#cb105-74" aria-hidden="true" tabindex="-1"></a><span class="co">#                        "forward aic",</span></span>
<span id="cb105-75"><a href="#cb105-75" aria-hidden="true" tabindex="-1"></a><span class="co">#                        "forward bic",</span></span>
<span id="cb105-76"><a href="#cb105-76" aria-hidden="true" tabindex="-1"></a><span class="co">#                        "backward aic",</span></span>
<span id="cb105-77"><a href="#cb105-77" aria-hidden="true" tabindex="-1"></a><span class="co">#                        "backward bic",</span></span>
<span id="cb105-78"><a href="#cb105-78" aria-hidden="true" tabindex="-1"></a><span class="co">#                        "ridge",</span></span>
<span id="cb105-79"><a href="#cb105-79" aria-hidden="true" tabindex="-1"></a><span class="co">#                        "lasso",</span></span>
<span id="cb105-80"><a href="#cb105-80" aria-hidden="true" tabindex="-1"></a><span class="co">#                        "elastic-net",</span></span>
<span id="cb105-81"><a href="#cb105-81" aria-hidden="true" tabindex="-1"></a><span class="co">#                        "cart")</span></span>
<span id="cb105-82"><a href="#cb105-82" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-83"><a href="#cb105-83" aria-hidden="true" tabindex="-1"></a><span class="co">#     # gbm / svm lineaire / svm radial</span></span>
<span id="cb105-84"><a href="#cb105-84" aria-hidden="true" tabindex="-1"></a><span class="co">#     erreur &lt;- function(X,Y) { mean((X-Y)^2)}</span></span>
<span id="cb105-85"><a href="#cb105-85" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-86"><a href="#cb105-86" aria-hidden="true" tabindex="-1"></a><span class="co">#     auc &lt;- function(X,Y){</span></span>
<span id="cb105-87"><a href="#cb105-87" aria-hidden="true" tabindex="-1"></a><span class="co">#            pred &lt;- ROCR::prediction(X, Y)</span></span>
<span id="cb105-88"><a href="#cb105-88" aria-hidden="true" tabindex="-1"></a><span class="co">#            auc &lt;- ROCR::performance(pred, measure = "auc")</span></span>
<span id="cb105-89"><a href="#cb105-89" aria-hidden="true" tabindex="-1"></a><span class="co">#            auc &lt;- auc@y.values[[1]]</span></span>
<span id="cb105-90"><a href="#cb105-90" aria-hidden="true" tabindex="-1"></a><span class="co">#     }</span></span>
<span id="cb105-91"><a href="#cb105-91" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-92"><a href="#cb105-92" aria-hidden="true" tabindex="-1"></a><span class="co">#     res_list[[j]] = list(auc = apply(result, 2, auc, Y=don_desbois$Y), result = result)</span></span>
<span id="cb105-93"><a href="#cb105-93" aria-hidden="true" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb105-94"><a href="#cb105-94" aria-hidden="true" tabindex="-1"></a><span class="co"># saveRDS(res_list, "res_list.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="Logistic_Regression_cache/html/unnamed-chunk-79_d1e703045f6b61578b27eac671a59308">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>res_list <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"res_list.rds"</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>res_list[[<span class="dv">1</span>]]<span class="sc">$</span>auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    glm full  glm desbois  forward aic  forward bic backward aic backward bic 
   0.9660621    0.9528649    0.9680022    0.9656887    0.9677953    0.9636553 
       ridge        lasso  elastic-net         cart 
   0.9604689    0.9653506    0.9653380    0.9074932 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>res_list[[<span class="dv">2</span>]]<span class="sc">$</span>auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    glm full  glm desbois  forward aic  forward bic backward aic backward bic 
   0.9673235    0.9530516    0.9672100    0.9634988    0.9680375    0.9640539 
       ridge        lasso  elastic-net         cart 
   0.9598861    0.9655701    0.9655500    0.9016944 </code></pre>
</div>
</div>
</section>
</section>
<section id="references" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-albert1984a" class="csl-entry" role="listitem">
A., Albert, and Aanderson J. A. 1984. <span>“On the Existence of Maximum Likelihood Estimates in Logistic Regression Models.”</span> <em>Biometrika</em> 71 (1): 1–10. <a href="https://doi.org/10.1093/biomet/71.1.1">https://doi.org/10.1093/biomet/71.1.1</a>.
</div>
<div id="ref-cornillon2019" class="csl-entry" role="listitem">
Cornillon, Pierre-André, and Eric Matzner-Løber. 2019. <em>Régression Avec r, 2e Édition</em>. Springer Paris. <a href="https://doi.org/10.1007/978-2-8178-0184-1">https://doi.org/10.1007/978-2-8178-0184-1</a>.
</div>
<div id="ref-fahrmeir1986" class="csl-entry" role="listitem">
Fahrmeir, &amp; Kaufmann, L. 1986. <span>“Asymptotic Inference in Discrete Response Models.”</span> <em>Statistische Hefte</em> 27 (1): 179–205. <a href="https://doi.org/10.1007/bf02932567">https://doi.org/10.1007/bf02932567</a>.
</div>
<div id="ref-gourieroux1981" class="csl-entry" role="listitem">
Gourieroux, &amp; Monfort, C. 1981. <span>“Asymptotic Properties of the Maximum Likelihood Estimator in Dichotomous Logit Models.”</span> <em>Journal of Econometrics</em> 17 (1): 83–97. <a href="https://doi.org/10.1016/0304-4076(81)90060-9">https://doi.org/10.1016/0304-4076(81)90060-9</a>.
</div>
<div id="ref-hastie2009" class="csl-entry" role="listitem">
Hastie, T., R. Tibshirani, and J. Friedman. 2009. <em>The Elements of Statistical Learning</em>. Springer New York. <a href="https://doi.org/10.1007/978-0-387-84858-7">https://doi.org/10.1007/978-0-387-84858-7</a>.
</div>
<div id="ref-hosmer2013" class="csl-entry" role="listitem">
Hosmer, David W., Stanley Lemeshow, and Rodney X. Sturdivant. 2013. <span>“Applied Logistic Regression.”</span> <em>Wiley Series in Probability and Statistics</em>, March. <a href="https://doi.org/10.1002/9781118548387">https://doi.org/10.1002/9781118548387</a>.
</div>
<div id="ref-islr2021" class="csl-entry" role="listitem">
James, G., D. Witten, T. Hastie, and R. Tibshirani. 2021. <em>An Introduction to Statistical Learning: With Applications in r</em>. Springer Texts in Statistics. Springer US. <a href="https://doi.org/10.1007/978-1-0716-1418">https://doi.org/10.1007/978-1-0716-1418</a>.
</div>
<div id="ref-nelder1972" class="csl-entry" role="listitem">
Nelder, J. A., and R. W. M. Wedderburn. 1972. <span>“Generalized Linear Models.”</span> <em>Journal of the Royal Statistical Society. Series A (General)</em> 135 (3): 370. <a href="https://doi.org/10.2307/2344614">https://doi.org/10.2307/2344614</a>.
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>